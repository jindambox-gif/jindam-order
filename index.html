<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§„ë‹´ë„ì‹œë½ - ì˜¨ë¼ì¸ ì£¼ë¬¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #fafafa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 420px;
            margin: 0 auto;
            background-color: #fff;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.08);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .header {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
            color: white;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 12px rgba(255, 107, 53, 0.2);
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header-icons {
            display: flex;
            gap: 12px;
        }

        .icon {
            cursor: pointer;
            font-size: 20px;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon:hover {
            background-color: rgba(255,255,255,0.15);
            transform: scale(1.05);
        }

        .notice-page {
            padding: 24px 20px;
        }

        .notice-title {
            font-size: 28px;
            font-weight: 700;
            color: #ff6b35;
            text-align: center;
            margin-bottom: 32px;
            letter-spacing: -1px;
        }

        .notice-content {
            background: linear-gradient(145deg, #fff 0%, #fafafa 100%);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        }

        .notice-section {
            margin-bottom: 24px;
            padding: 20px;
            background-color: #fff;
            border-radius: 12px;
            border-left: 4px solid #ff6b35;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        .notice-subtitle {
            font-weight: 600;
            color: #ff6b35;
            margin-bottom: 12px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notice-text {
            color: #666;
            font-size: 14px;
            line-height: 1.7;
            margin-bottom: 8px;
        }

        .contact-number {
            background: #fff3f0;
            color: #ff6b35;
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: 600;
            display: inline-block;
            margin-top: 8px;
        }

        .agreement-text {
            font-size: 14px;
            color: #777;
            margin-bottom: 24px;
            text-align: center;
            padding: 16px;
            background: #f9f9f9;
            border-radius: 12px;
        }

        .agree-btn {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
            color: white;
            border: none;
            padding: 18px 32px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(255, 107, 53, 0.3);
            letter-spacing: -0.3px;
        }

        .agree-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(255, 107, 53, 0.4);
        }

        .content {
            padding: 20px;
        }

        .section {
            background-color: #fff;
            margin-bottom: 16px;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            border: 1px solid #f0f0f0;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .calendar-header {
            text-align: center;
            font-weight: 600;
            margin-bottom: 16px;
            color: #333;
            font-size: 16px;
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-bottom: 8px;
        }

        .weekday {
            text-align: center;
            font-weight: 500;
            padding: 8px 0;
            font-size: 12px;
            color: #999;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #f0f0f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .calendar-day:hover:not(.disabled) {
            background-color: #fff3f0;
            border-color: #ff6b35;
        }

        .calendar-day.selected {
            background-color: #ff6b35;
            color: white;
            border-color: #ff6b35;
            font-weight: 600;
        }

        .calendar-day.disabled {
            color: #ddd;
            cursor: not-allowed;
            background-color: #f9f9f9;
        }

        .calendar-day.today {
            border-color: #ff6b35;
            color: #ff6b35;
            font-weight: 600;
        }

        .selected-date {
            text-align: center;
            background: linear-gradient(145deg, #fff3f0 0%, #ffe8e0 100%);
            padding: 16px;
            border-radius: 12px;
            margin-top: 16px;
            color: #ff6b35;
            font-weight: 500;
        }

        .vat-notice {
            font-size: 12px;
            color: #ff6b35;
            margin-bottom: 20px;
            text-align: center;
            background: #fff3f0;
            padding: 12px;
            border-radius: 8px;
            font-weight: 500;
        }

        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border: 1px solid #f0f0f0;
            border-radius: 12px;
            margin-bottom: 12px;
            transition: all 0.2s ease;
            background: linear-gradient(145deg, #fff 0%, #fafafa 100%);
        }

        .menu-item:hover {
            border-color: #ff6b35;
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        }

        .menu-info h4 {
            font-size: 16px;
            color: #333;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .menu-price {
            font-size: 18px;
            font-weight: 700;
            color: #ff6b35;
        }

        .vat-text {
            font-size: 11px;
            color: #999;
            margin-left: 6px;
            font-weight: 400;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #e0e0e0;
            background-color: #fff;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            color: #666;
        }

        .qty-btn:hover {
            background-color: #ff6b35;
            color: white;
            border-color: #ff6b35;
        }

        .qty-btn:active {
            transform: scale(0.95);
            background-color: #e55a2b;
            border-color: #e55a2b;
        }

        .quantity {
            font-size: 16px;
            font-weight: 600;
            min-width: 24px;
            text-align: center;
            color: #333;
        }

        .total-section {
            background: linear-gradient(145deg, #fff3f0 0%, #ffe8e0 100%);
            border: 1px solid #ff6b35;
        }

        .total-amount {
            font-size: 24px;
            font-weight: 700;
            color: #ff6b35;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 14px;
        }

        .required {
            color: #ff6b35;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            background-color: #fafafa;
        }

        .form-input:focus {
            outline: none;
            border-color: #ff6b35;
            background-color: #fff;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .form-textarea {
            height: 80px;
            resize: vertical;
        }

        .btn {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
            color: white;
            border: none;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(255, 107, 53, 0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(255, 107, 53, 0.3);
        }

        .btn:disabled {
            background: #ddd;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-full {
            width: 100%;
            padding: 18px 24px;
            font-size: 18px;
            margin-top: 24px;
        }

        .sidebar {
            position: fixed;
            top: 0;
            right: -320px;
            width: 320px;
            height: 100vh;
            background-color: #fff;
            box-shadow: -4px 0 20px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            padding: 24px;
        }

        .sidebar.open {
            right: 0;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 1px solid #f0f0f0;
        }

        .sidebar-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            padding: 4px;
            border-radius: 4px;
            transition: color 0.2s ease;
        }

        .close-btn:hover {
            color: #ff6b35;
        }

        .menu-list {
            list-style: none;
        }

        .menu-list li {
            padding: 16px 0;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            color: #333;
            font-weight: 500;
            transition: color 0.2s ease;
            font-size: 16px;
        }

        .menu-list li:hover {
            color: #ff6b35;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0,0,0,0.3);
            z-index: 999;
            display: none;
            backdrop-filter: blur(2px);
        }

        .overlay.show {
            display: block;
        }

                .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal.show {
            display: flex !important;
        }
        
        .modal.active {
            display: flex !important;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 32px 28px;
            border-radius: 16px;
            text-align: center;
            max-width: 340px;
            margin: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
        }

        .modal-text {
            color: #666;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .confirm-btn {
            background-color: #ff6b35;
            color: white;
        }

        .confirm-btn:hover {
            background-color: #e55a2b;
        }

        .cancel-btn {
            background-color: #f5f5f5;
            color: #666;
        }

        .cancel-btn:hover {
            background-color: #e0e0e0;
        }

        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }
            
            .sidebar {
                width: 100%;
                right: -100%;
            }
        }
        
        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            to {
                transform: translateX(-50%) translateY(-100%);
                opacity: 0;
            }
        }
    </style>
    <meta property="og:title" content="ì§„ë‹´ë„ì‹œë½ - ì˜¨ë¼ì¸ ì£¼ë¬¸">
    <meta property="og:description" content="ê±´ê°•í•˜ê³  ë§›ìˆëŠ” í•œì‹ ë„ì‹œë½ì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì£¼ë¬¸í•˜ì„¸ìš”!">
    <meta property="og:type" content="website">
</head>
<body>
    <div class="container">
        <!-- ê³ ê° ì„ íƒ í˜ì´ì§€ (ì²« í™”ë©´) -->
        <div id="customerTypePage" class="page active">
            <div class="notice-page" style="padding: 16px 20px;">
                <div class="notice-title" style="margin-bottom: 12px;">ğŸ± ì§„ë‹´ë„ì‹œë½ ğŸ±</div>
                <div style="text-align: center; margin-bottom: 16px;">
                    <p style="font-size: 14px; color: #666; line-height: 1.5; margin: 0;">
                        ê±´ê°•í•˜ê³  ë§›ìˆëŠ” í•œì‹ ë„ì‹œë½<br>
                        ì •ì„± ê°€ë“ ë‹´ì•„ ë°°ë‹¬í•´ ë“œë¦½ë‹ˆë‹¤
                    </p>
                </div>
                
                <div style="background: linear-gradient(145deg, #fff3f0 0%, #ffe8e0 100%); padding: 16px; border-radius: 14px; margin-bottom: 20px; border-left: 4px solid #ff6b35;">
                    <div style="font-size: 14px; color: #ff6b35; font-weight: 700; margin-bottom: 10px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 6px;">
                        ğŸ’³ ì›” ê²°ì œ í›„ë¶ˆ ì‹œìŠ¤í…œ
                    </div>
                    <div style="background: white; padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                        <div style="font-size: 13px; color: #333; font-weight: 600; line-height: 1.5; text-align: center;">
                            ì •ê¸° ë°°ì†¡ & ì›”ë§ ì¼ê´„ ê²°ì œ
                        </div>
                        <div style="font-size: 11px; color: #666; line-height: 1.4; text-align: center; margin-top: 4px;">
                            ë§¤ì¼ ë°°ì†¡ â†’ ì›”ë§ ê²°ì œ â†’ í¸ë¦¬í•˜ê²Œ!
                        </div>
                    </div>
                    <div style="display: flex; gap: 6px; font-size: 11px; color: #666;">
                        <div style="flex: 1; background: rgba(255,255,255,0.7); padding: 8px; border-radius: 8px; text-align: center;">
                            <div style="font-weight: 600; color: #ff6b35; margin-bottom: 2px;">âœ… ê¸°ì¡´ ê³ ê°</div>
                            <div style="font-size: 10px;">ë°”ë¡œ ì£¼ë¬¸</div>
                        </div>
                        <div style="flex: 1; background: rgba(255,255,255,0.7); padding: 8px; border-radius: 8px; text-align: center;">
                            <div style="font-weight: 600; color: #ff6b35; margin-bottom: 2px;">âœ¨ ì‹ ê·œ ê³ ê°</div>
                            <div style="font-size: 10px;">ìƒë‹´ í›„ ì£¼ë¬¸</div>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; flex-direction: column; gap: 12px; max-width: 340px; margin: 0 auto;">
                    <button onclick="showPhoneVerifyPage()" style="background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%); color: #ffffff; border: none; padding: 18px 24px; font-size: 16px; font-weight: 600; border-radius: 12px; cursor: pointer; box-shadow: 0 4px 16px rgba(255, 107, 53, 0.3); transition: all 0.3s ease;">
                        <div style="font-size: 18px; margin-bottom: 5px;">ğŸ‘¥ ê¸°ì¡´ ê³ ê°</div>
                        <div style="font-size: 12px; font-weight: 400; opacity: 0.9;">ì´ë¯¸ ì´ìš© ì¤‘ì´ì‹  ê³ ê°ë‹˜</div>
                        <div style="font-size: 10px; margin-top: 5px; opacity: 0.85; background: rgba(255,255,255,0.2); padding: 4px 8px; border-radius: 6px;">â€» ìµœì´ˆ 1íšŒ ì—…ì²´ ëŒ€í‘œë²ˆí˜¸ ë“±ë¡ í•„ìš”</div>
                    </button>
                    
                    <button onclick="showNewCustomerPage()" style="background: white; color: #ff6b35; border: 2px solid #ff6b35; padding: 18px 24px; font-size: 16px; font-weight: 600; border-radius: 12px; cursor: pointer; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1); transition: all 0.3s ease;">
                        <div style="font-size: 18px; margin-bottom: 5px;">âœ¨ ì‹ ê·œ ê³ ê°</div>
                        <div style="font-size: 12px; font-weight: 400; opacity: 0.8;">ì²˜ìŒ ì´ìš©í•˜ì‹œëŠ” ê³ ê°ë‹˜</div>
                        <div style="font-size: 10px; margin-top: 5px; opacity: 0.7;">ìƒë‹´ â†’ ì •ë³´ ì…ë ¥ â†’ ìŠ¹ì¸ â†’ ì£¼ë¬¸</div>
                    </button>
                </div>
                
                <div style="text-align: center; margin-top: 24px; padding-top: 16px; border-top: 1px solid #f0f0f0;">
                    <div style="font-size: 13px; color: #999; margin-bottom: 6px;">ë¬¸ì˜í•˜ê¸°</div>
                    <div class="contact-number" style="cursor: pointer;" onclick="window.location.href='tel:1544-4679'">
                        â˜ 1544-4679
                    </div>
                    <div style="margin-top: 12px;">
                        <button onclick="showAdminPage()" style="background: none; border: none; color: #ccc; font-size: 12px; cursor: pointer; padding: 8px; text-decoration: underline;">
                            ê´€ë¦¬ì
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì „í™”ë²ˆí˜¸ ì¸ì¦ í˜ì´ì§€ (ê¸°ì¡´ê³ ê°ìš©) -->
        <!-- ì „í™”ë²ˆí˜¸ ì¸ì¦ í˜ì´ì§€ (ê¸°ì¡´ê³ ê°ìš©) -->
        <div id="phoneVerifyPage" class="page">
            <div class="notice-page">
                <div style="text-align: right; margin-bottom: 16px;">
                    <button onclick="showCustomerTypePage()" style="background: none; border: none; color: #999; font-size: 24px; cursor: pointer; padding: 8px;">Ã—</button>
                </div>
                
                <div class="notice-title">ğŸ“ ì „í™”ë²ˆí˜¸ ì¸ì¦</div>
                
                <div class="notice-content">
                    <div class="notice-section">
                        <div class="notice-subtitle">ğŸ” ê¸°ì¡´ ê³ ê° í™•ì¸</div>
                        <div class="notice-text" style="line-height: 1.8; margin-top: 16px;">
                            ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 24px;">
                        <label class="form-label">ì „í™”ë²ˆí˜¸ <span class="required">*</span></label>
                        <input 
                            type="tel" 
                            class="form-input" 
                            id="verifyPhone" 
                            placeholder="ì˜ˆ: 15444679 ë˜ëŠ” 0511234567"
                            maxlength="11"
                            style="font-size: 18px; text-align: center; letter-spacing: 1px;"
                        >
                        <div style="font-size: 12px; color: #999; margin-top: 8px; text-align: center;">
                            - ì—†ì´ ìˆ«ìë§Œ ì…ë ¥ (íœ´ëŒ€í°: 010 ì œì™¸, ì§€ì—­ë²ˆí˜¸: í¬í•¨)
                        </div>
                    </div>
                    
                    <div id="verifyResult" style="margin-top: 16px; padding: 12px; border-radius: 8px; display: none;"></div>
                    
                    <button 
                        onclick="verifyPhoneNumber()" 
                        class="btn btn-full"
                        style="margin-top: 24px;"
                    >
                        í™•ì¸
                    </button>
                    
                    <div style="background: #f9f9f9; padding: 16px; border-radius: 12px; margin-top: 24px;">
                        <div style="font-size: 13px; color: #666; line-height: 1.6; text-align: center;">
                            <strong>ë“±ë¡ë˜ì§€ ì•Šì€ ë²ˆí˜¸ì¸ê°€ìš”?</strong>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 12px;">
                            <button 
                                onclick="showExistingCustomerRegister()" 
                                style="width: 100%; background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%); color: #ffffff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600;"
                            >
                                ê¸°ì¡´ ê³ ê° ë“±ë¡í•˜ê¸° (1íšŒë§Œ)
                            </button>
                            <button 
                                onclick="showNewCustomerPage()" 
                                style="width: 100%; background: white; color: #ff6b35; border: 1px solid #ff6b35; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600;"
                            >
                                ì‹ ê·œ ê³ ê° ìƒë‹´ ì‹ ì²­
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê¸°ì¡´ ê³ ê° ë“±ë¡ í˜ì´ì§€ -->
        <div id="existingCustomerRegisterPage" class="page">
            <div class="notice-page">
                <div style="text-align: right; margin-bottom: 16px;">
                    <button onclick="showPhoneVerifyPage()" style="background: none; border: none; color: #999; font-size: 24px; cursor: pointer; padding: 8px;">Ã—</button>
                </div>
                
                <div class="notice-title">ğŸ‘¥ ê¸°ì¡´ ê³ ê° ë“±ë¡</div>
                
                <div class="notice-content">
                    <div class="notice-section">
                        <div class="notice-subtitle">ğŸ‰ ê¸°ì¡´ ê³ ê°ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!</div>
                        <div class="notice-text" style="line-height: 1.8; margin-top: 16px; margin-bottom: 16px;">
                            ì˜¨ë¼ì¸ ì£¼ë¬¸ ì‹œìŠ¤í…œ ì´ìš©ì„ ìœ„í•´<br>
                            <strong style="color: #ff6b35;">ìµœì´ˆ 1íšŒë§Œ ì—…ì²´ ì •ë³´ë¥¼ ë“±ë¡</strong>í•´ì£¼ì„¸ìš”.
                        </div>
                        <div class="notice-text" style="padding: 12px; background: #fff3f0; border-radius: 8px; font-size: 13px; line-height: 1.7;">
                            âœ“ ë“±ë¡ í›„ ê´€ë¦¬ì ìŠ¹ì¸ (ë¹ ë¥´ê²Œ ì²˜ë¦¬)<br>
                            âœ“ ìŠ¹ì¸ ì™„ë£Œ ì‹œ ëŒ€í‘œë²ˆí˜¸ë¡œ ê³„ì† ì´ìš©<br>
                            âœ“ ì£¼ë¬¸í•  ë•Œë§ˆë‹¤ ì£¼ë¬¸ì ì •ë³´ëŠ” ì§ì ‘ ì…ë ¥
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ì—…ì²´ëª… <span class="required">*</span></label>
                        <input type="text" class="form-input" id="existingCompanyName" placeholder="ì˜ˆ: í–‰ë³µë³‘ì›">
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ì—…ì²´ì˜ ì „ì²´ ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ëŒ€í‘œ ì „í™”ë²ˆí˜¸ <span class="required">*</span></label>
                        <input type="tel" class="form-input" id="existingCompanyPhone" placeholder="ì˜ˆ: 15444679 ë˜ëŠ” 0511234567" maxlength="11">
                        <div style="font-size: 12px; color: #ff6b35; margin-top: 4px; font-weight: 500;">
                            âš ï¸ ì´ ë²ˆí˜¸ë¡œ ê³„ì† ë¡œê·¸ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤
                        </div>
                        <div style="font-size: 11px; color: #999; margin-top: 2px;">
                            (- ì—†ì´ ìˆ«ìë§Œ ì…ë ¥ / íœ´ëŒ€í°: 010 ì œì™¸ / ì§€ì—­ë²ˆí˜¸: í¬í•¨)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ë‹´ë‹¹ì ì—°ë½ì²˜ <span class="required">*</span></label>
                        <input type="tel" class="form-input" id="existingManagerPhone" placeholder="ì˜ˆ: 01012345678">
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ê¸´ê¸‰ ìƒí™© ì‹œ ì—°ë½ë“œë¦´ íœ´ëŒ€í° ë²ˆí˜¸
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ê¸°ë³¸ ë°°ì†¡ ì£¼ì†Œ <span class="required">*</span></label>
                        <input type="text" class="form-input" id="existingAddress" placeholder="ì˜ˆ: ë¶€ì‚°ì‹œ ë™ë˜êµ¬ ì˜¨ì²œë™ 123-45">
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ì£¼ë¬¸ ì‹œ ê¸°ë³¸ ì£¼ì†Œë¡œ ìë™ ì…ë ¥ë©ë‹ˆë‹¤ (ì£¼ë¬¸í•  ë•Œë§ˆë‹¤ ë³€ê²½ ê°€ëŠ¥)
                        </div>
                    </div>
                    
                    <button onclick="submitExistingCustomerRegister()" class="btn btn-full">
                        ë“±ë¡ ì‹ ì²­í•˜ê¸°
                    </button>
                    
                    <div style="background: #f9f9f9; padding: 16px; border-radius: 12px; margin-top: 24px; text-align: center;">
                        <div style="font-size: 13px; color: #666; line-height: 1.6;">
                            ìŠ¹ì¸ì€ ë¹ ë¥´ê²Œ ì²˜ë¦¬í•´ë“œë¦½ë‹ˆë‹¤!<br>
                            ë¬¸ì˜: <strong style="color: #ff6b35;">1544-4679</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì‹ ê·œ ê³ ê° ì•ˆë‚´ í˜ì´ì§€ -->
        <div id="newCustomerPage" class="page">
            <div class="notice-page">
                <div style="text-align: right; margin-bottom: 16px;">
                    <button onclick="showCustomerTypePage()" style="background: none; border: none; color: #999; font-size: 24px; cursor: pointer; padding: 8px;">Ã—</button>
                </div>
                
                <div class="notice-title">âœ¨ ì‹ ê·œ ê³ ê° ìƒë‹´ ì‹ ì²­</div>
                
                <div class="notice-content">
                    <div class="notice-section">
                        <div class="notice-subtitle">ğŸ‰ ì§„ë‹´ë„ì‹œë½ì— ê´€ì‹¬ ê°€ì ¸ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!</div>
                        <div class="notice-text" style="line-height: 1.8; margin-top: 16px; margin-bottom: 16px;">
                            ì‹ ê·œ ê³ ê°ë‹˜ì€ ë‹¤ìŒ ì ˆì°¨ë¡œ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
                        </div>
                        <div class="notice-text" style="padding-left: 16px; line-height: 2;">
                            <strong style="color: #ff6b35;">1ë‹¨ê³„:</strong> ì „í™” ë˜ëŠ” ì¹´í†¡ìœ¼ë¡œ ìƒë‹´<br>
                            <strong style="color: #ff6b35;">2ë‹¨ê³„:</strong> ì•„ë˜ ì •ë³´ ì…ë ¥ í›„ ì œì¶œ<br>
                            <strong style="color: #ff6b35;">3ë‹¨ê³„:</strong> ê´€ë¦¬ì ìŠ¹ì¸ (ìƒë‹´ ë‚´ìš© í™•ì¸)<br>
                            <strong style="color: #ff6b35;">4ë‹¨ê³„:</strong> ìŠ¹ì¸ ì™„ë£Œ ì‹œ ë°”ë¡œ ì£¼ë¬¸ ê°€ëŠ¥!
                        </div>
                    </div>
                    
                    <div style="background: #f9f9f9; padding: 16px; border-radius: 12px; margin-bottom: 24px;">
                        <div style="font-size: 14px; color: #333; font-weight: 600; margin-bottom: 12px; text-align: center;">
                            ğŸ’¬ ë¨¼ì € ìƒë‹´ë¶€í„° ì§„í–‰í•´ì£¼ì„¸ìš”!
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button onclick="window.location.href='tel:1544-4679'" style="flex: 1; background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%); color: #ffffff; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600;">
                                ğŸ“ ì „í™” ìƒë‹´
                            </button>
                            <button onclick="window.open('http://pf.kakao.com/_xexnVMG/chat', '_blank')" style="flex: 1; background: #FEE500; color: #3C1E1E; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600;">
                                ğŸ’¬ ì¹´í†¡ ìƒë‹´
                            </button>
                        </div>
                    </div>
                    
                    <div style="border-top: 2px dashed #e0e0e0; padding-top: 24px; margin-top: 8px;">
                        <div style="font-size: 15px; color: #333; font-weight: 600; margin-bottom: 16px; text-align: center;">
                            ğŸ“ ìƒë‹´ ì™„ë£Œ í›„ ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ì—…ì²´ëª… <span class="required">*</span></label>
                        <input type="text" class="form-input" id="newCustomerCompany" placeholder="ì˜ˆ: í–‰ë³µë³‘ì›">
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ì—…ì²´ì˜ ì „ì²´ ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ëŒ€í‘œ ì „í™”ë²ˆí˜¸ <span class="required">*</span></label>
                        <input type="tel" class="form-input" id="newCustomerPhone" placeholder="ì˜ˆ: 15444679 ë˜ëŠ” 0511234567" maxlength="11">
                        <div style="font-size: 12px; color: #ff6b35; margin-top: 4px; font-weight: 500;">
                            âš ï¸ ìŠ¹ì¸ í›„ ì´ ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•  ì¸ì¦ë²ˆí˜¸ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤
                        </div>
                        <div style="font-size: 11px; color: #999; margin-top: 2px;">
                            (- ì—†ì´ ìˆ«ìë§Œ ì…ë ¥ / íœ´ëŒ€í°: 010 ì œì™¸ / ì§€ì—­ë²ˆí˜¸: í¬í•¨)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ë‹´ë‹¹ì ì—°ë½ì²˜ <span class="required">*</span></label>
                        <input type="tel" class="form-input" id="newCustomerManager" placeholder="ì˜ˆ: 01012345678 (ë¹„ìƒ ì—°ë½ìš©)">
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ê¸´ê¸‰ ìƒí™© ì‹œ ì—°ë½ë“œë¦´ íœ´ëŒ€í° ë²ˆí˜¸
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ê¸°ë³¸ ë°°ì†¡ ì£¼ì†Œ <span class="required">*</span></label>
                        <input type="text" class="form-input" id="newCustomerAddress" placeholder="ì˜ˆ: ë¶€ì‚°ì‹œ ë™ë˜êµ¬ ì˜¨ì²œë™ 123-45">
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ì£¼ë¬¸ ì‹œ ê¸°ë³¸ ì£¼ì†Œë¡œ ìë™ ì…ë ¥ë©ë‹ˆë‹¤ (ì£¼ë¬¸í•  ë•Œë§ˆë‹¤ ë³€ê²½ ê°€ëŠ¥)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ì˜ˆìƒ ì£¼ë¬¸ëŸ‰</label>
                        <input type="text" class="form-input" id="newCustomerVolume" placeholder="ì˜ˆ: ì¼ 10ê°œ, ì£¼ 50ê°œ">
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ì‹¤ì œ ì£¼ë¬¸ ì‹œ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤ (ì°¸ê³ ìš©)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ê²°ì œ ë°©ë²• <span class="required">*</span></label>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <label style="display: flex; align-items: center; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                <input type="radio" name="paymentMethod" value="bank" style="width: 18px; height: 18px; margin-right: 12px; cursor: pointer;" checked onchange="togglePaymentFields()">
                                <div>
                                    <div style="font-weight: 600; color: #333;">ğŸ’° ì…ê¸ˆ (ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰)</div>
                                    <div style="font-size: 12px; color: #999; margin-top: 2px;">ì›”ë§ ì²­êµ¬ â†’ ìµì›” ì…ê¸ˆ (ì‚¬ì—…ìë“±ë¡ì¦ í•„ìš”)</div>
                                </div>
                            </label>
                            <label style="display: flex; align-items: center; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                <input type="radio" name="paymentMethod" value="cash_receipt" style="width: 18px; height: 18px; margin-right: 12px; cursor: pointer;" onchange="togglePaymentFields()">
                                <div>
                                    <div style="font-weight: 600; color: #333;">ğŸ§¾ í˜„ê¸ˆì˜ìˆ˜ì¦</div>
                                    <div style="font-size: 12px; color: #999; margin-top: 2px;">ì›”ë§ ì²­êµ¬ â†’ ìµì›” ì…ê¸ˆ (í˜„ê¸ˆì˜ìˆ˜ì¦ ë°œí–‰)</div>
                                </div>
                            </label>
                            <label style="display: flex; align-items: center; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                <input type="radio" name="paymentMethod" value="visit_card" style="width: 18px; height: 18px; margin-right: 12px; cursor: pointer;" onchange="togglePaymentFields()">
                                <div>
                                    <div style="font-weight: 600; color: #333;">ğŸ’³ ë°©ë¬¸ ì¹´ë“œ ê²°ì œ</div>
                                    <div style="font-size: 12px; color: #999; margin-top: 2px;">ì›”ë§ ë°©ë¬¸í•˜ì—¬ ì¹´ë“œ ê²°ì œ</div>
                                </div>
                            </label>
                            <label style="display: flex; align-items: center; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                <input type="radio" name="paymentMethod" value="online_card" style="width: 18px; height: 18px; margin-right: 12px; cursor: pointer;" onchange="togglePaymentFields()">
                                <div>
                                    <div style="font-weight: 600; color: #333;">ğŸŒ ì˜¨ë¼ì¸ ì¹´ë“œ ê²°ì œ</div>
                                    <div style="font-size: 12px; color: #999; margin-top: 2px;">ì›”ë§ ê²°ì œ ë§í¬ ë°œì†¡ â†’ ì˜¨ë¼ì¸ ê²°ì œ</div>
                                </div>
                            </label>
                        </div>
                        
                        <!-- ì…ê¸ˆ ê²°ì œ í•„ë“œ -->
                        <div id="businessNumberField" style="margin-top: 12px;">
                            <input type="text" class="form-input" id="newCustomerBusinessNumber" placeholder="ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ (ì˜ˆ: 123-45-67890)" maxlength="12" style="margin-bottom: 12px;">
                            
                            <div style="border: 2px dashed #e0e0e0; border-radius: 8px; padding: 20px; text-align: center; background: #fafafa;">
                                <label for="businessLicenseUpload" style="cursor: pointer; display: block;">
                                    <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“„</div>
                                    <div style="font-weight: 600; color: #333; margin-bottom: 4px;">ì‚¬ì—…ìë“±ë¡ì¦ ì—…ë¡œë“œ</div>
                                    <div style="font-size: 12px; color: #999;">í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ (JPG, PNG, PDF)</div>
                                </label>
                                <input type="file" id="businessLicenseUpload" accept="image/*,.pdf" style="display: none;" onchange="handleBusinessLicenseUpload(this)">
                                <div id="uploadedFileName" style="margin-top: 12px; font-size: 13px; color: #22c55e; font-weight: 600; display: none;">
                                    âœ“ <span id="fileName"></span>
                                </div>
                            </div>
                            
                            <div style="font-size: 12px; color: #ff6b35; margin-top: 8px;">
                                â€» ì…ê¸ˆ ê²°ì œ ì„ íƒ ì‹œ ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì„ ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤
                            </div>
                        </div>
                        
                        <!-- í˜„ê¸ˆì˜ìˆ˜ì¦ í•„ë“œ -->
                        <div id="cashReceiptField" style="margin-top: 12px; display: none;">
                            <label class="form-label" style="font-size: 14px; color: #333; margin-bottom: 8px; display: block;">í˜„ê¸ˆì˜ìˆ˜ì¦ ë°œí–‰ ì •ë³´</label>
                            <div style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="radio" name="cashReceiptType" value="personal" style="width: 16px; height: 16px; margin-right: 8px;" checked>
                                    <span style="font-size: 14px; color: #666;">ê°œì¸ (íœ´ëŒ€í°ë²ˆí˜¸)</span>
                                </label>
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="radio" name="cashReceiptType" value="business" style="width: 16px; height: 16px; margin-right: 8px;">
                                    <span style="font-size: 14px; color: #666;">ì‚¬ì—…ì (ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸)</span>
                                </label>
                            </div>
                            <input type="text" class="form-input" id="cashReceiptNumber" placeholder="íœ´ëŒ€í°ë²ˆí˜¸ ë˜ëŠ” ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸" maxlength="13">
                            <div style="font-size: 12px; color: #999; margin-top: 8px;">
                                ğŸ’¡ í˜„ê¸ˆì˜ìˆ˜ì¦ ë°œí–‰ì„ ìœ„í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
                            </div>
                        </div>
                        
                        <!-- ë°©ë¬¸ ì¹´ë“œ ê²°ì œ í•„ë“œ -->
                        <div id="visitCardField" style="margin-top: 12px; display: none;">
                            <label class="form-label" style="font-size: 14px; color: #333; margin-bottom: 8px; display: block;">ë°©ë¬¸ ìš”ì²­ ì‹œê°„</label>
                            <input type="text" class="form-input" id="visitRequestTime" placeholder="ì˜ˆ: ì˜¤ì „ 10ì‹œ ~ 11ì‹œ, ì˜¤í›„ 2ì‹œ ~ 3ì‹œ">
                            <div style="font-size: 12px; color: #999; margin-top: 8px;">
                                ğŸ’¡ ë°©ë¬¸ ê°€ëŠ¥í•œ ì‹œê°„ëŒ€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
                            </div>
                        </div>
                        
                        <!-- ì˜¨ë¼ì¸ ì¹´ë“œ ê²°ì œ í•„ë“œ -->
                        <div id="onlineCardField" style="margin-top: 12px; display: none;">
                            <label class="form-label" style="font-size: 14px; color: #333; margin-bottom: 8px; display: block;">ë§í¬ ë°œì†¡ ë²ˆí˜¸</label>
                            <input type="tel" class="form-input" id="linkSendNumber" placeholder="ì˜ˆ: 010-1234-5678" maxlength="13">
                            <div style="font-size: 12px; color: #999; margin-top: 8px;">
                                ğŸ’¡ ê²°ì œ ë§í¬ë¥¼ ë°›ìœ¼ì‹¤ íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ë¬¸ì˜ì‚¬í•­</label>
                        <textarea class="form-input form-textarea" id="newCustomerNote" placeholder="ìƒë‹´ ì‹œ ë¬¸ì˜í•˜ì‹  ë‚´ìš©ì´ë‚˜ ì¶”ê°€ ìš”ì²­ì‚¬í•­ì„ ì‘ì„±í•´ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <button onclick="submitConsultRequest()" class="btn btn-full">
                        ìƒë‹´ ì™„ë£Œ í›„ ìŠ¹ì¸ ìš”ì²­í•˜ê¸°
                    </button>
                    
                    <script>

// ============================================
// Google Apps Script ì›¹ì•± ì—°ë™
// ============================================
const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbxhTQCXqI2neAOSV_KPdXaP3noPPqWiymZco_8GNm3l2efXXGrFmMAfJKQXoA1ZWj4b/exec';

console.log('âœ… Apps Script ì—°ë™ ì½”ë“œ ë¡œë“œ ì™„ë£Œ');
console.log('ğŸ”— ì›¹ì•± URL:', WEBAPP_URL);

// ============================================
// ì£¼ë¬¸ ì €ì¥ í•¨ìˆ˜
// ============================================
async function saveOrderToSheet(orderData) {
    try {
        console.log('ğŸ“¤ ì£¼ë¬¸ì„ Google Sheetsì— ì €ì¥ ì¤‘...', orderData);
        
        const payload = {
            action: 'addOrder',
            orderData: {
                id: orderData.id || Date.now(),
                date: orderData.date || '',
                time: orderData.time || new Date().toLocaleTimeString('ko-KR'),
                companyName: orderData.customer?.company || '',
                phone: orderData.customer?.phone || '',
                ordererName: orderData.customer?.company || '',
                ordererPhone: orderData.customer?.contactPhone || '',
                address: orderData.customer?.address || '',
                addressDetail: '',
                warmQty: orderData.items?.find(i => i.type === 'warm')?.quantity || 0,
                saladQty: orderData.items?.find(i => i.type === 'salad')?.quantity || 0,
                ilpoomQty: orderData.items?.find(i => i.type === 'ilpoom')?.quantity || 0,
                heatingQty: orderData.items?.find(i => i.type === 'heating')?.quantity || 0,
                totalQty: orderData.items?.reduce((sum, i) => sum + i.quantity, 0) || 0,
                totalPrice: orderData.total || 0,
                status: 'ì ‘ìˆ˜',
                memo: orderData.customer?.memo || '',
                deliveryStatus: 'ë°°ì†¡ì „'
            }
        };
        
        await fetch(WEBAPP_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        
        console.log('âœ… ì£¼ë¬¸ì´ Google Sheetsì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
        return { success: true };
        
    } catch (error) {
        console.error('âš ï¸  Google Sheets ì €ì¥ ì‹¤íŒ¨:', error);
        return { success: false };
    }
}

// ============================================
// ì—…ì²´ ë“±ë¡ í•¨ìˆ˜
// ============================================
async function saveCompanyToSheet(companyData) {
    try {
        console.log('ğŸ“¤ ì—…ì²´ë¥¼ Google Sheetsì— ë“±ë¡ ì¤‘...');
        
        const payload = {
            action: 'addCompany',
            companyData: {
                id: companyData.id || Date.now(),
                company: companyData.company || '',
                phone: companyData.phone || '',
                managerPhone: companyData.managerPhone || '',
                address: companyData.address || '',
                addressDetail: '',
                paymentMethod: companyData.paymentMethod || '',
                businessNumber: companyData.businessNumber || '',
                registeredDate: companyData.registeredDate || new Date().toISOString(),
                priceWarm: 7500,
                priceSalad: 7500,
                priceIlpoom: 7500,
                priceHeating: 8000
            }
        };
        
        await fetch(WEBAPP_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        
        console.log('âœ… ì—…ì²´ê°€ Google Sheetsì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤');
        return { success: true };
        
    } catch (error) {
        console.error('âš ï¸  Google Sheets ì €ì¥ ì‹¤íŒ¨:', error);
        return { success: false };
    }
}


                        let uploadedBusinessLicense = null;
                        
                        function handleBusinessLicenseUpload(input) {
                            const file = input.files[0];
                            if (file) {
                                // íŒŒì¼ í¬ê¸° ì²´í¬ (5MB ì œí•œ)
                                if (file.size > 5 * 1024 * 1024) {
                                    alert('íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                                    input.value = '';
                                    return;
                                }
                                
                                // íŒŒì¼ì„ Base64ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
                                const reader = new FileReader();
                                reader.onload = function(e) {
                                    uploadedBusinessLicense = {
                                        name: file.name,
                                        type: file.type,
                                        data: e.target.result
                                    };
                                    
                                    // ì—…ë¡œë“œ ì™„ë£Œ í‘œì‹œ
                                    document.getElementById('fileName').textContent = file.name;
                                    document.getElementById('uploadedFileName').style.display = 'block';
                                };
                                reader.readAsDataURL(file);
                            }
                        }
                        
                        // ê²°ì œ ë°©ë²•ì— ë”°ë¼ í•„ë“œ í‘œì‹œ/ìˆ¨ê¹€
                        function togglePaymentFields() {
                            const selectedMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
                            const businessField = document.getElementById('businessNumberField');
                            const cashReceiptField = document.getElementById('cashReceiptField');
                            const visitCardField = document.getElementById('visitCardField');
                            const onlineCardField = document.getElementById('onlineCardField');
                            
                            // ëª¨ë“  í•„ë“œ ìˆ¨ê¸°ê¸°
                            businessField.style.display = 'none';
                            cashReceiptField.style.display = 'none';
                            visitCardField.style.display = 'none';
                            onlineCardField.style.display = 'none';
                            
                            // ì„ íƒëœ ê²°ì œ ë°©ë²•ì— ë”°ë¼ í‘œì‹œ
                            if (selectedMethod === 'bank') {
                                businessField.style.display = 'block';
                            } else if (selectedMethod === 'cash_receipt') {
                                cashReceiptField.style.display = 'block';
                            } else if (selectedMethod === 'visit_card') {
                                visitCardField.style.display = 'block';
                            } else if (selectedMethod === 'online_card') {
                                onlineCardField.style.display = 'block';
                            }
                            
                            // ë¼ë””ì˜¤ ë²„íŠ¼ ì‹œê°ì  ê°•ì¡°
                            document.querySelectorAll('input[name="paymentMethod"]').forEach(r => {
                                r.closest('label').style.borderColor = '#e0e0e0';
                                r.closest('label').style.background = 'transparent';
                            });
                            const selectedRadio = document.querySelector('input[name="paymentMethod"]:checked');
                            if (selectedRadio) {
                                selectedRadio.closest('label').style.borderColor = '#ff6b35';
                                selectedRadio.closest('label').style.background = '#fff8f5';
                            }
                        }
                        
                        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
                        document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
                            radio.addEventListener('change', togglePaymentFields);
                        });
                        
                        // ì´ˆê¸° ìƒíƒœ ì„¤ì •
                        const defaultRadio = document.querySelector('input[name="paymentMethod"]:checked');
                        if (defaultRadio) {
                            defaultRadio.closest('label').style.borderColor = '#ff6b35';
                            defaultRadio.closest('label').style.background = '#fff8f5';
                        }

                        
                        // ì´ˆê¸° ìƒíƒœ ì„¤ì •
                        document.addEventListener('DOMContentLoaded', function() {
        // Google Sheetsì—ì„œ ë°ì´í„° ë¡œë“œ
        async function loadDataFromSheets() {
            // localStorageì— ì´ë¯¸ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ìŠ¤í‚µ
            if (localStorage.getItem('companies')) {
                console.log('âœ… localStorageì— ë°ì´í„° ìˆìŒ');
                return;
            }
            
            // ì´ë¯¸ ë¡œë“œ ì‹œë„í–ˆëŠ”ì§€ ì²´í¬ (ë¬´í•œ ë¦¬ë¡œë“œ ë°©ì§€)
            const loadAttempted = sessionStorage.getItem('dataLoadAttempted');
            if (loadAttempted) {
                console.log('âš ï¸  ì´ë¯¸ ë°ì´í„° ë¡œë“œ ì‹œë„í•¨. Google Sheets í™•ì¸ í•„ìš”.');
                return;
            }
            
            console.log('ğŸ“¥ Google Sheetsì—ì„œ ë°ì´í„° ë¡œë“œ ì¤‘...');
            
            try {
                sessionStorage.setItem('dataLoadAttempted', 'true');
                
                const response = await fetch(WEBAPP_URL + '?action=readCompanies', {
                    method: 'GET'
                });
                
                const result = await response.json();
                
                if (result.success && result.companies) {
                    // ìŠ¹ì¸ëœ ì—…ì²´ë§Œ í•„í„°ë§
                    const approvedCompanies = result.companies.filter(c => c.status === 'ìŠ¹ì¸');
                    
                    // localStorageì— ì €ì¥
                    localStorage.setItem('companies', JSON.stringify(approvedCompanies));
                    
                    console.log('âœ… ë°ì´í„° ë¡œë“œ ì„±ê³µ:', approvedCompanies.length, 'ê°œ ì—…ì²´');
                    
                    // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                    location.reload();
                } else {
                    console.error('âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', result.error);
                }
            } catch (error) {
                console.error('âŒ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
                console.log('ğŸ’¡ Google Sheetsì— ì§ì ‘ ë“±ë¡ëœ ë°ì´í„°ê°€ ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
        loadDataFromSheets();

                            const defaultRadio = document.querySelector('input[name="paymentMethod"]:checked');
                            if (defaultRadio) {
                                defaultRadio.closest('label').style.borderColor = '#ff6b35';
                                defaultRadio.closest('label').style.backgroundColor = '#fff3f0';
                            }
                        });
                    </script>
                </div>
            </div>
        </div>

        <!-- ì‚¬ì „ ì•ˆë‚´ì‚¬í•­ í˜ì´ì§€ (ê¸°ì¡´ê³ ê°ìš©) -->
        <div id="noticePage" class="page">
            <div class="notice-page" style="padding: 16px 20px;">
                <div class="notice-title" style="margin-bottom: 16px; font-size: 20px;">âœ¨ ì§„ë‹´ë„ì‹œë½ ì´ìš© ì•ˆë‚´ âœ¨</div>
                
                <div class="notice-content" style="margin-top: 0;">
                    <div class="notice-section" style="margin-bottom: 16px;">
                        <div class="notice-subtitle" style="font-size: 15px; margin-bottom: 10px;">ğŸ“¦ ì£¼ë¬¸ & ë°°ì†¡</div>
                        <div class="notice-text" style="font-size: 13px; line-height: 1.8;">
                            <strong>â€¢ ìµœì†Œ ì£¼ë¬¸</strong>: ì¼ 2ê°œ, ì£¼ 10ê°œ ì´ìƒ<br>
                            <strong>â€¢ ì£¼ë¬¸ ë§ˆê°</strong>: ìƒëŸ¬ë“œ/ì¼í’ˆ (ì „ë‚  18ì‹œ)<br>
                            <span style="padding-left: 74px;">ë³´ì˜¨/ë°œì—´ (ë‹¹ì¼ 06ì‹œ)</span><br>
                            <strong>â€¢ ì£¼ë¬¸ ìˆ˜ì •</strong>: ì£¼ë¬¸ ë§ˆê° ì‹œê°„ê¹Œì§€ ê°€ëŠ¥<br>
                            <strong style="color: #ff6b35;">âš ï¸ ë§ˆê°ì‹œê°„ ì´í›„ ì·¨ì†Œ</strong>: â˜ 1544-4679<br>
                            <strong>â€¢ ìš©ê¸° ìˆ˜ê±°</strong>: ë‹¤ìŒ ë°°ì†¡ì¼
                        </div>
                    </div>
                    
                    <div class="notice-section" style="margin-bottom: 12px;">
                        <div class="notice-subtitle" style="font-size: 15px; margin-bottom: 8px;">ğŸ’³ ê²°ì œ</div>
                        <div class="notice-text" style="font-size: 13px; line-height: 1.6;"><strong>â€¢ ë°©ì‹</strong>: í›„ë¶ˆ ì›”ë§ ì¼ê´„ ê²°ì œ</div>
                        <div class="notice-text" style="font-size: 13px; line-height: 1.6;"><strong>â€¢ ê°€ê²©</strong>: ë¶€ê°€ì„¸(VAT) ë³„ë„</div>
                    </div>
                    
                    <div class="notice-section" style="margin-bottom: 0;">
                        <div style="text-align: center; line-height: 1.6;">
                            <div style="font-size: 15px; font-weight: 600; color: #333; margin-bottom: 6px;">
                                ë¬¸ì˜ <span style="color: #333; font-weight: 700;">â˜ 1544-4679</span>
                            </div>
                            <div style="font-size: 14px; color: #ff6b35; font-weight: 600;">
                                ğŸ‰ í–‰ì‚¬ë„ì‹œë½ ë‹¨ì²´ì£¼ë¬¸ ë¬¸ì˜ í™˜ì˜
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="agree-btn" onclick="showOrderPage()" style="margin-top: 20px;">
                    âœ… ë™ì˜í•˜ê³  ì£¼ë¬¸í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- ì£¼ë¬¸ í˜ì´ì§€ -->
        <div id="orderPage" class="page">
            <div class="header">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="icon" onclick="showCustomerTypePage()" style="font-size: 24px;">â†</span>
                    <div class="logo">ì§„ë‹´ë„ì‹œë½</div>
                </div>
                <div class="header-icons">
                    <span class="icon" onclick="showAdminPage()">ğŸ‘¤</span>
                    <span class="icon" onclick="toggleSidebar()">â˜°</span>
                </div>
            </div>

            <div class="content">
                <!-- ë°°ì†¡ ë‚ ì§œ ì„ íƒ -->
                <div class="section">
                    <div class="section-title">ğŸ“… ë°°ì†¡ ë‚ ì§œ ì„ íƒ</div>
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                        <button onclick="changeMonth(-1)" style="background: #f5f5f5; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: 600; color: #666;">â€¹</button>
                        <div class="calendar-header" id="calendarHeader" style="flex: 1; text-align: center;"></div>
                        <button onclick="changeMonth(1)" style="background: #f5f5f5; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: 600; color: #666;">â€º</button>
                    </div>
                    <div class="weekdays">
                        <div class="weekday">ì¼</div>
                        <div class="weekday">ì›”</div>
                        <div class="weekday">í™”</div>
                        <div class="weekday">ìˆ˜</div>
                        <div class="weekday">ëª©</div>
                        <div class="weekday">ê¸ˆ</div>
                        <div class="weekday">í† </div>
                    </div>
                    <div class="calendar-days" id="calendarDays"></div>
                    <div class="selected-date">
                        <strong>ì„ íƒëœ ë°°ì†¡ì¼: </strong>
                        <span id="selectedDateText">ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</span>
                    </div>
                </div>

                <!-- ë©”ë‰´ ì„ íƒ -->
                <div class="section">
                    <div class="section-title">ğŸ± ë©”ë‰´ ì„ íƒ</div>
                    <div style="background: #fff3f0; padding: 12px; border-radius: 8px; margin-bottom: 12px; font-size: 13px; line-height: 1.7; color: #666;">
                        <strong style="color: #ff6b35;">â° ì£¼ë¬¸ ë§ˆê° ì‹œê°„</strong><br>
                        â€¢ ìƒëŸ¬ë“œ/ì¼í’ˆ: ë°°ì†¡ ì „ë‚  ì˜¤í›„ 6ì‹œê¹Œì§€<br>
                        â€¢ ë³´ì˜¨/ë°œì—´: ë°°ì†¡ ë‹¹ì¼ ì˜¤ì „ 6ì‹œê¹Œì§€
                    </div>
                    <div class="vat-notice">â€» ëª¨ë“  ê°€ê²©ì€ ë¶€ê°€ì„¸(VAT) ë³„ë„ì…ë‹ˆë‹¤</div>
                    
                    <div class="menu-item">
                        <div class="menu-info">
                            <h4>ğŸ± ë³´ì˜¨ë„ì‹œë½</h4>
                        </div>
                        <div class="quantity-control">
                            <button class="qty-btn" onclick="changeQuantity('warm', -1)">-</button>
                            <span class="quantity" id="warm-qty">0</span>
                            <button class="qty-btn" onclick="changeQuantity('warm', 1)">+</button>
                        </div>
                    </div>

                    <div class="menu-item">
                        <div class="menu-info">
                            <h4>ğŸ¥— ìƒëŸ¬ë“œë„ì‹œë½</h4>
                            <div style="font-size: 11px; color: #ff6b35; margin-top: 2px;">â° ì „ë‚  6ì‹œê¹Œì§€</div>
                        </div>
                        <div class="quantity-control">
                            <button class="qty-btn" onclick="changeQuantity('salad', -1)">-</button>
                            <span class="quantity" id="salad-qty">0</span>
                            <button class="qty-btn" onclick="changeQuantity('salad', 1)">+</button>
                        </div>
                    </div>

                    <div class="menu-item">
                        <div class="menu-info">
                            <h4>ğŸ½ï¸ ì¼í’ˆë„ì‹œë½</h4>
                            <div style="font-size: 11px; color: #ff6b35; margin-top: 2px;">â° ì „ë‚  6ì‹œê¹Œì§€</div>
                        </div>
                        <div class="quantity-control">
                            <button class="qty-btn" onclick="changeQuantity('ilpoom', -1)">-</button>
                            <span class="quantity" id="ilpoom-qty">0</span>
                            <button class="qty-btn" onclick="changeQuantity('ilpoom', 1)">+</button>
                        </div>
                    </div>

                    <div class="menu-item">
                        <div class="menu-info">
                            <h4>ğŸ”¥ ë°œì—´ë„ì‹œë½</h4>
                        </div>
                        <div class="quantity-control">
                            <button class="qty-btn" onclick="changeQuantity('heating', -1)">-</button>
                            <span class="quantity" id="heating-qty">0</span>
                            <button class="qty-btn" onclick="changeQuantity('heating', 1)">+</button>
                        </div>
                    </div>
                </div>

                <!-- ì´ ì£¼ë¬¸ ê¸ˆì•¡ -->
                <div class="section total-section">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div class="section-title">ğŸ’° í•©ê³„</div>
                        <div style="text-align: right;">
                            <div class="total-amount" id="totalAmount">0ì›</div>
                            <div class="vat-text">ë¶€ê°€ì„¸ ë³„ë„</div>
                        </div>
                    </div>
                </div>

                <!-- ë°°ì†¡ì§€ ì •ë³´ -->
                <div class="section">
                    <div class="section-title">ğŸ¢ ì—…ì²´ ì •ë³´</div>
                    
                    <div class="form-group">
                        <label class="form-label">ì—…ì²´ëª…</label>
                        <input type="text" class="form-input" id="customerCompany" readonly style="background-color: #f5f5f5; cursor: not-allowed; font-weight: 600;">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ëŒ€í‘œ ì „í™”ë²ˆí˜¸</label>
                        <input type="tel" class="form-input" id="customerPhone" readonly style="background-color: #f5f5f5; cursor: not-allowed; font-weight: 600;">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ë°°ì†¡ ì£¼ì†Œ <span class="required">*</span></label>
                        <input type="text" class="form-input" id="customerAddress" placeholder="ë°°ì†¡ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" required>
                        <div style="font-size: 12px; color: #999; margin-top: 4px;">
                            ê¸°ë³¸ ì£¼ì†Œê°€ ìë™ ì…ë ¥ë©ë‹ˆë‹¤ (ë³€ê²½ ê°€ëŠ¥)
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ë‹´ë‹¹ì ì—°ë½ì²˜ <span class="required">*</span></label>
                        <div style="display: flex; gap: 8px; align-items: start;">
                            <div style="flex: 1;">
                                <input type="tel" class="form-input" id="customerContactPhone" placeholder="ì˜ˆ: 010-1234-5678" required>
                                <div style="font-size: 12px; color: #999; margin-top: 4px;">
                                    ê¸´ê¸‰ ìƒí™© ì‹œì—ë§Œ ì—°ë½ë“œë¦½ë‹ˆë‹¤
                                </div>
                            </div>
                            <button id="saveContactBtn" onclick="saveContactPhone()" style="background: #3b82f6; color: #ffffff; border: none; padding: 12px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; white-space: nowrap; font-size: 14px;">
                                ğŸ’¾ ì €ì¥
                            </button>
                            <button id="editContactBtn" onclick="editContactPhone()" style="display: none; background: #f59e0b; color: #ffffff; border: none; padding: 12px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; white-space: nowrap; font-size: 14px;">
                                âœï¸ ìˆ˜ì •
                            </button>
                        </div>
                        <div id="savedContactMessage" style="display: none; margin-top: 8px; padding: 8px 12px; background: #f0fdf4; border-radius: 6px; font-size: 13px; color: #22c55e;">
                            âœ… ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì£¼ë¬¸ë¶€í„° ìë™ìœ¼ë¡œ ì…ë ¥ë©ë‹ˆë‹¤.
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ë©”ëª¨ (ì„ íƒì‚¬í•­)</label>
                        <textarea class="form-input form-textarea" id="customerMemo" placeholder="ë°°ì†¡ ì‹œ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" rows="3"></textarea>
                    </div>
                </div>

                <button class="btn btn-full" id="orderBtn" onclick="showOrderModal()" disabled>
                    ë©”ë‰´ 3ê°œ ì´ìƒê³¼ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
                </button>
            </div>
        </div>

        <!-- ì£¼ë¬¸ë‚´ì—­ í˜ì´ì§€ -->
        <div id="orderHistoryPage" class="page">
            <div class="header">
                <div class="logo">ì£¼ë¬¸ë‚´ì—­</div>
                <div class="header-icons">
                    <span class="icon" onclick="showOrderPage()">â†</span>
                </div>
            </div>

            <div class="content">
                <div class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <div class="section-title">ğŸ“‹ ë‚˜ì˜ ì£¼ë¬¸ë‚´ì—­</div>
                        <button onclick="showMonthlyStatement()" style="background: #22c55e; color: #ffffff; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; white-space: nowrap;">
                            ğŸ“„ ì›”ë³„ ê±°ë˜ëª…ì„¸ì„œ
                        </button>
                    </div>
                    <div id="orderHistoryList">
                        <div style="text-align: center; padding: 40px; color: #999;">
                            ì£¼ë¬¸ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì›”ë³„ ê±°ë˜ëª…ì„¸ì„œ í˜ì´ì§€ -->
        <div id="monthlyStatementPage" class="page">
            <div class="header">
                <div class="logo">ê±°ë˜ëª…ì„¸ì„œ</div>
                <div class="header-icons">
                    <span class="icon" onclick="showOrderHistory()">â†</span>
                </div>
            </div>

            <div class="content">
                <div class="section">
                    <div id="statementStatusBanner"></div>
                    <div id="statementContent"></div>
                    
                    <div id="statementActions" style="margin-top: 24px; display: flex; gap: 12px;"></div>
                </div>
            </div>
        </div>
        
        <!-- ê²°ì œ ì •ë³´ í˜ì´ì§€ -->
        <div id="paymentInfoPage" style="display: none;">
            <div class="container">
                <div class="content">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                        <span class="icon" onclick="showOrderPage()">â†</span>
                        <h2 class="page-title">ê²°ì œ ì •ë³´</h2>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">ğŸ’³ í˜„ì¬ ê²°ì œ ë°©ë²•</div>
                        <div id="currentPaymentInfo"></div>
                    </div>
                    
                    <div class="section">
                        <div style="background: #fff8f5; padding: 16px; border-radius: 12px; border-left: 4px solid #ff6b35;">
                            <div style="font-weight: 600; color: #ff6b35; margin-bottom: 8px;">ğŸ“ ê²°ì œ ë°©ë²• ë³€ê²½ ì•ˆë‚´</div>
                            <div style="font-size: 14px; color: #666; line-height: 1.6;">
                                ê²°ì œ ë°©ë²• ë³€ê²½ì„ ì›í•˜ì‹œë©´ ê³ ê°ì„¼í„°ë¡œ ì—°ë½ì£¼ì„¸ìš”.<br>
                                <strong style="color: #ff6b35;">â˜ 1544-4679</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê´€ë¦¬ì í˜ì´ì§€ -->
        <div id="adminPage" class="page">
            <div id="adminLogin" style="text-align: center; padding: 60px 24px;">
                <div style="font-size: 24px; color: #333; margin-bottom: 32px; font-weight: 600;">ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸</div>
                <input type="password" id="adminPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" maxlength="4" style="width: 100%; max-width: 280px; padding: 16px 20px; border: 1px solid #e0e0e0; border-radius: 12px; font-size: 16px; margin-bottom: 24px; text-align: center; font-weight: 500;">
                <br>
                <button class="btn" onclick="adminLogin()">ë¡œê·¸ì¸</button>
            </div>

            <div id="adminDashboard" style="display: none;">
                <!-- ì œëª© + ë©”ë‰´ í†µí•© ë°•ìŠ¤ -->
                <div style="padding: 16px; background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%); color: #ffffff; border-radius: 12px; margin-bottom: 16px;">
                    <h2 style="margin: 0 0 12px 0; font-size: 18px; font-weight: 700; text-align: center;">ğŸ± ì§„ë‹´ë„ì‹œë½ ê´€ë¦¬ì</h2>
                    
                    <!-- ë©”ì¸ ë©”ë‰´ (2x2 ê·¸ë¦¬ë“œ) -->
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                        <button onclick="showCompanyManagement()" style="background: rgba(255,255,255,0.95); color: #8b5cf6; border: none; padding: 10px 8px; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                            ğŸ¢ ì—…ì²´ ê´€ë¦¬
                        </button>
                        <button onclick="showPaymentManagement()" style="background: rgba(255,255,255,0.95); color: #f59e0b; border: none; padding: 10px 8px; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                            ğŸ’³ ê²°ì œ ê´€ë¦¬
                        </button>
                        <button onclick="downloadMonthlyReport()" style="background: rgba(255,255,255,0.95); color: #3b82f6; border: none; padding: 10px 8px; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                            ğŸ“ˆ ì›”ë³„ ì—‘ì…€
                        </button>
                        <button onclick="showStatementManagement()" style="background: rgba(255,255,255,0.95); color: #06b6d4; border: none; padding: 10px 8px; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                            ğŸ“„ ê±°ë˜ëª…ì„¸ì„œ
                        </button>
                    </div>
                </div>

                <!-- ì—…ì²´ ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="companyManagementSection" style="display: none;">
                    <div class="content">
                        <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
                        <div style="margin-bottom: 16px;">
                            <button onclick="showOrderManagement()" style="background: #6b7280; color: #ffffff; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 500;">
                                â† ë‚ ì§œë³„ ì£¼ë¬¸ì¡°íšŒë¡œ ëŒì•„ê°€ê¸°
                            </button>
                        </div>
                        
                        <!-- íƒ­ ë²„íŠ¼ -->
                        <div style="display: flex; gap: 8px; margin-bottom: 20px; background: white; padding: 12px; border-radius: 12px; border: 1px solid #f0f0f0;">
                            <button onclick="showPendingTab()" id="pendingTab" style="flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%); color: #ffffff;">
                                ğŸ“‹ ìŠ¹ì¸ ëŒ€ê¸° (<span id="pendingCount">0</span>)
                            </button>
                            <button onclick="showApprovedTab()" id="approvedTab" style="flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: #f5f5f5; color: #666;">
                                âœ… ìŠ¹ì¸ ì™„ë£Œ (<span id="approvedCount">0</span>)
                            </button>
                            <button onclick="showRejectedTab()" id="rejectedTab" style="flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: #f5f5f5; color: #666;">
                                âŒ ê±°ì ˆ (<span id="rejectedCount">0</span>)
                            </button>
                        </div>

                        <!-- ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ -->
                        <div id="pendingList" class="section"></div>

                        <!-- ìŠ¹ì¸ ì™„ë£Œ ëª©ë¡ -->
                        <div id="approvedList" class="section" style="display: none;"></div>

                        <!-- ê±°ì ˆ ëª©ë¡ -->
                        <div id="rejectedList" class="section" style="display: none;"></div>
                        
                        <button onclick="showOrderManagement()" class="btn btn-full" style="background: #666;">
                            â† ì£¼ë¬¸ ê´€ë¦¬ë¡œ ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>

                <!-- ê±°ë˜ëª…ì„¸ì„œ ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="statementManagementSection" style="display: none;">
                    <div class="content">
                        <div class="section">
                            <div class="section-title">ğŸ“„ ì—…ì²´ë³„ ê±°ë˜ëª…ì„¸ì„œ ê´€ë¦¬</div>
                            
                            <!-- í˜„ì¬ ì¡°íšŒ ì›” í‘œì‹œ -->
                            <div style="padding: 12px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #3b82f6; margin-bottom: 16px;">
                                <div style="font-size: 13px; font-weight: 600; color: #1e40af;">
                                    ğŸ“… ì¡°íšŒ ê¸°ê°„: <span id="adminPeriodText"></span>
                                </div>
                            </div>
                            
                            <!-- ê¸°ê°„ ì„ íƒ íƒ­ -->
                            <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                                <button id="monthlyTabBtn" onclick="switchStatementMode('monthly')" style="flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%); color: white; transition: all 0.2s;">
                                    ğŸ“… ì´ë²ˆ ë‹¬
                                </button>
                                <button id="customTabBtn" onclick="switchStatementMode('custom')" style="flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: #f5f5f5; color: #666; transition: all 0.2s;">
                                    ğŸ“† ê¸°ê°„ ì„ íƒ
                                </button>
                            </div>
                            
                            <!-- ê¸°ê°„ë³„ ê±°ë˜ëª…ì„¸ì„œ ì¡°íšŒ UI -->
                            <div id="customDateRange" style="display: none; margin-bottom: 16px; padding: 16px; background: #f9fafb; border-radius: 12px; border: 1px solid #e5e7eb;">
                                <div style="display: flex; gap: 12px; align-items: end;">
                                    <div style="flex: 1;">
                                        <label style="font-size: 13px; color: #666; margin-bottom: 6px; display: block; font-weight: 600;">ì‹œì‘ì¼</label>
                                        <input type="date" id="statementStartDate" class="form-input" style="margin: 0;">
                                    </div>
                                    <div style="flex: 1;">
                                        <label style="font-size: 13px; color: #666; margin-bottom: 6px; display: block; font-weight: 600;">ì¢…ë£Œì¼</label>
                                        <input type="date" id="statementEndDate" class="form-input" style="margin: 0;">
                                    </div>
                                    <button onclick="generateCustomStatement()" 
                                            style="background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color: white; border: none; padding: 14px 24px; 
                                                   border-radius: 8px; cursor: pointer; font-weight: 600; white-space: nowrap; font-size: 14px; box-shadow: 0 2px 8px rgba(34, 197, 94, 0.3);">
                                        ğŸ” ì¡°íšŒ
                                    </button>
                                </div>
                            </div>
                            
                            <!-- ê²€ìƒ‰ ê¸°ëŠ¥ -->
                            <div style="margin-bottom: 16px;">
                                <input type="text" id="statementSearchInput" placeholder="ğŸ” ì—…ì²´ëª… ë˜ëŠ” ì „í™”ë²ˆí˜¸ë¡œ ê²€ìƒ‰..." style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;" oninput="searchStatementCompanies()">
                            </div>
                            
                            <div style="background: #fef3c7; padding: 16px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #f59e0b;">
                                <div style="font-size: 14px; color: #92400e; line-height: 1.6;">
                                    <strong>ğŸ’¡ ì•ˆë‚´:</strong><br>
                                    â€¢ ì—…ì²´ë¥¼ ì„ íƒí•˜ì—¬ ê±°ë˜ëª…ì„¸ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”<br>
                                    â€¢ ë‚´ìš© í™•ì¸ í›„ ìŠ¹ì¸í•˜ë©´ ê³ ê°ì´ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤<br>
                                    â€¢ ìŠ¹ì¸ í›„ì—ë„ ì·¨ì†Œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤
                                </div>
                            </div>
                            <div id="statementCompanyList"></div>
                        </div>
                        
                        <button onclick="showApprovedSummary()" class="btn btn-full" style="background: #22c55e; margin-bottom: 12px;">
                            ğŸ’° ìŠ¹ì¸ ì™„ë£Œ ë‚´ì—­ (ì…ê¸ˆ í™•ì¸)
                        </button>
                        
                        <button onclick="showOrderManagement()" class="btn btn-full" style="background: #666;">
                            â† ì£¼ë¬¸ ê´€ë¦¬ë¡œ ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>

                <!-- ê²°ì œ ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="paymentManagementSection" style="display: none;">
                    <div class="content">
                        <div class="section">
                            <div class="section-title">ğŸ’³ ì—…ì²´ë³„ ê²°ì œ ë°©ë²• ê´€ë¦¬</div>
                            <div style="margin-bottom: 16px;">
                                <input type="text" id="paymentSearchInput" placeholder="ğŸ” ì—…ì²´ëª… ë˜ëŠ” ì „í™”ë²ˆí˜¸ë¡œ ê²€ìƒ‰..." style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;" oninput="searchPaymentMethods()">
                            </div>
                            <div id="paymentMethodList"></div>
                        </div>
                        
                        <button onclick="showOrderManagement()" class="btn btn-full" style="background: #666;">
                            â† ì£¼ë¬¸ ê´€ë¦¬ë¡œ ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>
                
                <!-- ìŠ¹ì¸ ì™„ë£Œ ë‚´ì—­ ì„¹ì…˜ -->
                <div id="approvedSummarySection" style="display: none;">
                    <div class="content">
                        <div class="section">
                            <div class="section-title">ğŸ’° ìŠ¹ì¸ ì™„ë£Œ ë‚´ì—­ (ì…ê¸ˆ í™•ì¸)</div>
                            
                            <!-- í˜„ì¬ ì¡°íšŒ ì›” í‘œì‹œ -->
                            <div style="padding: 12px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e; margin-bottom: 16px;">
                                <div style="font-size: 13px; font-weight: 600; color: #166534;">
                                    ğŸ“… ì¡°íšŒ ê¸°ê°„: <span id="summaryPeriodText"></span>
                                </div>
                            </div>
                            
                            <!-- í•„í„° -->
                            <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                                <button id="filterAllBtn" onclick="filterSummary('all')" style="flex: 1; padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%); color: white;">
                                    ì „ì²´
                                </button>
                                <button id="filterPaidBtn" onclick="filterSummary('paid')" style="flex: 1; padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: #f5f5f5; color: #666;">
                                    ì…ê¸ˆ ì™„ë£Œ
                                </button>
                                <button id="filterUnpaidBtn" onclick="filterSummary('unpaid')" style="flex: 1; padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; background: #f5f5f5; color: #666;">
                                    ë¯¸ì…ê¸ˆ
                                </button>
                            </div>
                            
                            <!-- ê²€ìƒ‰ -->
                            <div style="margin-bottom: 16px;">
                                <input type="text" id="summarySearchInput" placeholder="ğŸ” ì—…ì²´ëª… ë˜ëŠ” ì „í™”ë²ˆí˜¸ë¡œ ê²€ìƒ‰..." style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;" oninput="searchApprovedSummary()">
                            </div>
                            
                            <!-- í•©ê³„ ìš”ì•½ -->
                            <div id="summaryTotals" style="margin-bottom: 20px;"></div>
                            
                            <!-- ì—…ì²´ ë¦¬ìŠ¤íŠ¸ -->
                            <div id="approvedSummaryList"></div>
                        </div>
                        
                        <button onclick="downloadSummaryExcel()" class="btn btn-full" style="background: #22c55e; margin-bottom: 12px;">
                            ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
                        </button>
                        
                        <button onclick="showStatementManagement()" class="btn btn-full" style="background: #666;">
                            â† ê±°ë˜ëª…ì„¸ì„œ ê´€ë¦¬ë¡œ ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>

                <!-- ì£¼ë¬¸ ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="orderManagementSection">
                    <div style="background-color: #fff; padding: 16px; border-radius: 12px; margin-bottom: 16px; border: 1px solid #f0f0f0;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <div class="section-title" style="margin: 0; font-size: 16px;">ğŸ“… ë‚ ì§œë³„ ì£¼ë¬¸ ì¡°íšŒ</div>
                            <button onclick="downloadExcel()" style="background: #22c55e; color: #ffffff; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; white-space: nowrap;">
                                ğŸ“Š ì¼ë³„ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                        <input type="date" class="form-input" id="adminDateFilter" onchange="filterOrdersByDate()">
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 16px;">
                        <div style="background: linear-gradient(145deg, #fff 0%, #fafafa 100%); padding: 12px; border-radius: 12px; text-align: center; border: 1px solid #f0f0f0;">
                            <div style="font-size: 18px; font-weight: 700; color: #ff6b35;" id="totalCompanies">0</div>
                            <div style="font-size: 11px; color: #999; margin-top: 4px; font-weight: 500;">ì´ ì£¼ë¬¸ì—…ì²´</div>
                        </div>
                        <div style="background: linear-gradient(145deg, #fff 0%, #fafafa 100%); padding: 12px; border-radius: 12px; text-align: center; border: 1px solid #f0f0f0;">
                            <div style="font-size: 18px; font-weight: 700; color: #22c55e;" id="totalMenus">0</div>
                            <div style="font-size: 11px; color: #999; margin-top: 4px; font-weight: 500;">ì „ì²´ ë©”ë‰´</div>
                        </div>
                    </div>
                    
                    <!-- ë©”ë‰´ë³„ í†µê³„ -->
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 16px;">
                        <div style="background: #fff; padding: 10px 8px; border-radius: 10px; text-align: center; border: 1px solid #ffe4e1;">
                            <div style="font-size: 16px; font-weight: 700; color: #ff6b35;" id="warmCount">0</div>
                            <div style="font-size: 10px; color: #999; margin-top: 2px;">ğŸ± ë³´ì˜¨</div>
                        </div>
                        <div style="background: #fff; padding: 10px 8px; border-radius: 10px; text-align: center; border: 1px solid #d1fae5;">
                            <div style="font-size: 16px; font-weight: 700; color: #10b981;" id="saladCount">0</div>
                            <div style="font-size: 10px; color: #999; margin-top: 2px;">ğŸ¥— ìƒëŸ¬ë“œ</div>
                        </div>
                        <div style="background: #fff; padding: 10px 8px; border-radius: 10px; text-align: center; border: 1px solid #dbeafe;">
                            <div style="font-size: 16px; font-weight: 700; color: #3b82f6;" id="ilpoomCount">0</div>
                            <div style="font-size: 10px; color: #999; margin-top: 2px;">ğŸ½ï¸ ì¼í’ˆ</div>
                        </div>
                        <div style="background: #fff; padding: 10px 8px; border-radius: 10px; text-align: center; border: 1px solid #fef3c7;">
                            <div style="font-size: 16px; font-weight: 700; color: #f59e0b;" id="heatingCount">0</div>
                            <div style="font-size: 10px; color: #999; margin-top: 2px;">ğŸ”¥ ë°œì—´</div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ğŸ“‹ ì£¼ë¬¸ ëª©ë¡</div>
                        <div style="margin-bottom: 16px;">
                            <input type="text" id="companySearchInput" placeholder="ğŸ” ì—…ì²´ëª…ìœ¼ë¡œ ê²€ìƒ‰..." style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;" oninput="searchOrders()">
                        </div>
                        <div id="orderList" style="background-color: #fff; border-radius: 16px; overflow: hidden; border: 1px solid #f0f0f0;">
                            <div style="text-align: center; padding: 40px; color: #999;">
                                ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì‚¬ì´ë“œë°” -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">ë©”ë‰´</div>
            <button class="close-btn" onclick="toggleSidebar()">Ã—</button>
        </div>
        <ul class="menu-list">
            <li onclick="showOrderPage(); toggleSidebar();">ì£¼ë¬¸í•˜ê¸°</li>
            <li onclick="showOrderHistory(); toggleSidebar();">ì£¼ë¬¸ë‚´ì—­</li>
            <li onclick="showPaymentInfo(); toggleSidebar();">ê²°ì œ ì •ë³´</li>
            <li onclick="downloadMonthlyStatement(); toggleSidebar();">ì›” ê±°ë˜ëª…ì„¸ì„œ</li>
        </ul>
    </div>

    <!-- ì˜¤ë²„ë ˆì´ -->
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

    <!-- ì£¼ë¬¸ í™•ì¸ ëª¨ë‹¬ -->
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <div class="modal-title">ì£¼ë¬¸ í™•ì¸</div>
            <div class="modal-text">ê²°ì œëŠ” í›„ë¶ˆë¡œ ì§„í–‰ë©ë‹ˆë‹¤.<br>ì£¼ë¬¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
            <div class="modal-buttons">
                <button class="modal-btn cancel-btn" onclick="hideOrderModal()">ì·¨ì†Œ</button>
                <button class="modal-btn confirm-btn" onclick="confirmOrder()">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- ì£¼ë¬¸ ì™„ë£Œ ëª¨ë‹¬ -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-title">âœ… ì£¼ë¬¸ ì™„ë£Œ</div>
            <div class="modal-text">
                ì£¼ë¬¸ì´ ì •ìƒì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                ê°ì‚¬í•©ë‹ˆë‹¤!<br><br>
                <span style="font-size: 14px; color: #666;">ì ì‹œ í›„ ì£¼ë¬¸ë‚´ì—­ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.</span>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn confirm-btn" onclick="hideSuccessModal()">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- ì£¼ë¬¸ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal" id="editModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-title">ì£¼ë¬¸ ìˆ˜ì •</div>
            <div id="editMenuList" style="text-align: left; margin: 20px 0;"></div>
            <div style="font-size: 18px; font-weight: 600; color: #ff6b35; text-align: right; margin: 16px 0; padding: 12px; background: #fff3f0; border-radius: 8px;">
                ì´ ê¸ˆì•¡: <span id="editTotal">0</span>ì›
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel-btn" onclick="closeEditModal()">ì·¨ì†Œ</button>
                <button class="modal-btn confirm-btn" onclick="saveAdminEdit()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
    <div id="successMessage" style="display: none;"></div>

    <script>
        let selectedDate = null;
        let quantities = { warm: 0, salad: 0, ilpoom: 0, heating: 0 };
        let currentDisplayMonth = new Date(); // ìº˜ë¦°ë”ì— í‘œì‹œ ì¤‘ì¸ ì›”
        
        // ê¸°ë³¸ ë‹¨ê°€ (ì•ˆë‚´ìš©)
        const defaultPrices = { warm: 7500, salad: 7500, ilpoom: 7500, heating: 8000 };
        
        // í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ ë‹¨ê°€ (ë¡œê·¸ì¸í•œ ì—…ì²´ì˜ ë‹¨ê°€)
        let prices = { ...defaultPrices };
        
        let orders = JSON.parse(localStorage.getItem('jindamOrders')) || [];
        let userOrders = JSON.parse(localStorage.getItem('jindamUserOrders')) || [];
        let filteredOrders = [];
        let editingOrderId = null;
        let editQuantities = {};
        
        // ============================================
        // localStorage í‚¤ ë§ˆì´ê·¸ë ˆì´ì…˜ (ê¸°ì¡´ ë°ì´í„° ë³´ì¡´)
        // ============================================
        if (!localStorage.getItem('jindamCompanies') && localStorage.getItem('companies')) {
            console.log('ğŸ”„ ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤‘...');
            localStorage.setItem('jindamCompanies', localStorage.getItem('companies'));
            console.log('âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ!');
        }
        
        let registeredCompanies = JSON.parse(localStorage.getItem('jindamCompanies')) || [];
        let consultRequests = JSON.parse(localStorage.getItem('jindamConsultRequests')) || [];
        let currentCompany = null; // í˜„ì¬ ë¡œê·¸ì¸í•œ ì—…ì²´ ì •ë³´
        let isAdmin = false; // ê´€ë¦¬ì ì—¬ë¶€
        
        // ============================================
        // ì´ˆê¸° í…ŒìŠ¤íŠ¸ ê³„ì • ìë™ ìƒì„± (ìµœì´ˆ 1íšŒë§Œ)
        // ============================================
        if (registeredCompanies.length === 0) {
            console.log('ğŸ”§ ì´ˆê¸° í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± ì¤‘...');
            const testAccount = {
                id: Date.now(),
                company: 'í…ŒìŠ¤íŠ¸ì—…ì²´',
                name: 'í…ŒìŠ¤íŠ¸ì—…ì²´',
                phone: '15444679',
                manager: '01012345678',
                managerPhone: '01012345678',
                address: 'ë¶€ì‚°ì‹œ ì—°ì œêµ¬ ì¤‘ì•™ëŒ€ë¡œ 1060-1',
                paymentMethod: 'bank',
                businessNumber: '123-45-67890',
                prices: {
                    warm: 7500,
                    salad: 7500,
                    ilpoom: 7500,
                    heating: 8000
                },
                registeredAt: new Date().toISOString()
            };
            registeredCompanies.push(testAccount);
            localStorage.setItem('jindamCompanies', JSON.stringify(registeredCompanies));
            console.log('âœ… í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± ì™„ë£Œ!');
            console.log('   ë¡œê·¸ì¸ ë²ˆí˜¸: 15444679 ë˜ëŠ” 01012345678');
        }
        
        console.log('ğŸ“‹ ì‹œìŠ¤í…œ ì‹œì‘ - ë“±ë¡ëœ ì—…ì²´:', registeredCompanies.length, 'ê°œ');

        const menuNames = {
            warm: 'ë³´ì˜¨ë„ì‹œë½',
            salad: 'ìƒëŸ¬ë“œë„ì‹œë½',
            ilpoom: 'ì¼í’ˆë„ì‹œë½',
            heating: 'ë°œì—´ë„ì‹œë½'
        };

        // ìƒë‹´ ì‹ ì²­ ì œì¶œ
        function submitConsultRequest() {
            const company = document.getElementById('newCustomerCompany').value.trim();
            const phone = document.getElementById('newCustomerPhone').value.trim().replace(/[^0-9]/g, '');
            const manager = document.getElementById('newCustomerManager').value.trim().replace(/[^0-9]/g, '');
            const address = document.getElementById('newCustomerAddress').value.trim();
            const volume = document.getElementById('newCustomerVolume').value.trim();
            const note = document.getElementById('newCustomerNote').value.trim();
            const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
            const businessNumber = document.getElementById('newCustomerBusinessNumber').value.trim().replace(/[^0-9-]/g, '');
            const visitRequestTime = document.getElementById('visitRequestTime').value.trim();
            const linkSendNumber = document.getElementById('linkSendNumber').value.trim();
            
            // í˜„ê¸ˆì˜ìˆ˜ì¦ ì •ë³´
            let cashReceiptType = '';
            let cashReceiptNumber = '';
            if (paymentMethod === 'cash_receipt') {
                const cashReceiptTypeRadio = document.querySelector('input[name="cashReceiptType"]:checked');
                cashReceiptType = cashReceiptTypeRadio ? cashReceiptTypeRadio.value : 'personal';
                cashReceiptNumber = document.getElementById('cashReceiptNumber').value.trim();
            }
            
            if (!company || !phone || !manager || !address) {
                showValidationError('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì…ê¸ˆ ê²°ì œ ì„ íƒ ì‹œ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ í•„ìˆ˜
            if (paymentMethod === 'bank' && !businessNumber) {
                showValidationError('ì…ê¸ˆ ê²°ì œë¥¼ ì„ íƒí•˜ì‹  ê²½ìš° ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
                document.getElementById('newCustomerBusinessNumber').focus();
                return;
            }
            
            // ì…ê¸ˆ ê²°ì œ ì„ íƒ ì‹œ ì‚¬ì—…ìë“±ë¡ì¦ ì—…ë¡œë“œ ê¶Œì¥ (í•„ìˆ˜ ì•„ë‹˜)
            if (paymentMethod === 'bank' && !uploadedBusinessLicense) {
                if (!confirm('ì‚¬ì—…ìë“±ë¡ì¦ì„ ì—…ë¡œë“œí•˜ì§€ ì•Šìœ¼ì…¨ìŠµë‹ˆë‹¤.\në‚˜ì¤‘ì— ì—…ë¡œë“œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    return;
                }
            }
            
            // ì¤‘ë³µ ì²´í¬ (ì´ë¯¸ ìŠ¹ì¸ëœ ì—…ì²´)
            const existing = registeredCompanies.find(c => c.phone === phone);
            if (existing) {
                showValidationError('ì´ë¯¸ ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤.\nê¸°ì¡´ ê³ ê° ë¡œê·¸ì¸ì„ ì´ìš©í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì¤‘ë³µ ì²´í¬ (ì´ë¯¸ ì‹ ì²­í•œ ì—…ì²´)
            const existingRequest = consultRequests.find(c => c.phone === phone && c.status === 'pending');
            if (existingRequest) {
                showValidationError('ì´ë¯¸ ìƒë‹´ ì‹ ì²­ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.\nìŠ¹ì¸ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
                return;
            }
            
            const request = {
                id: Date.now(),
                company: company,
                phone: phone,
                manager: manager,
                address: address,
                volume: volume,
                note: note,
                paymentMethod: paymentMethod,
                businessNumber: businessNumber || "",
                businessLicense: uploadedBusinessLicense || null,
                cashReceiptType: cashReceiptType,
                cashReceiptNumber: cashReceiptNumber,
                visitRequestTime: visitRequestTime || "",
                linkSendNumber: linkSendNumber || "",
                status: 'pending', // pending, approved, rejected
                requestedAt: new Date().toISOString()
            };
            
            consultRequests.push(request);
            localStorage.setItem('jindamConsultRequests', JSON.stringify(consultRequests));
            
            alert('ìƒë‹´ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\në¹ ë¥¸ ì‹œì¼ ë‚´ì— ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('newCustomerCompany').value = '';
            document.getElementById('newCustomerPhone').value = '';
            document.getElementById('newCustomerManager').value = '';
            document.getElementById('newCustomerAddress').value = '';
            document.getElementById('newCustomerVolume').value = '';
            document.getElementById('newCustomerNote').value = '';
            document.getElementById('newCustomerBusinessNumber').value = '';
            document.getElementById('cashReceiptNumber').value = '';
            document.getElementById('visitRequestTime').value = '';
            document.getElementById('linkSendNumber').value = '';
            document.getElementById('businessLicenseUpload').value = '';
            document.getElementById('uploadedFileName').style.display = 'none';
            uploadedBusinessLicense = null;
            
            showCustomerTypePage();
        }

        // ìƒë‹´ ìš”ì²­ ìŠ¹ì¸
        function approveConsultRequest(id) {
            console.log('ìŠ¹ì¸ ë²„íŠ¼ í´ë¦­ë¨! ID:', id);
            console.log('í˜„ì¬ ìƒë‹´ ìš”ì²­ ëª©ë¡:', consultRequests);
            
            const request = consultRequests.find(r => r.id === id);
            console.log('ì°¾ì€ ìš”ì²­:', request);
            
            if (!request) {
                alert('ìš”ì²­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ìŠ¹ì¸ ì™„ë£Œë¡œ ìƒíƒœ ë³€ê²½
            request.status = 'approved';
            request.approvedAt = new Date().toISOString();
            
            // ì •ì‹ ì—…ì²´ë¡œ ë“±ë¡ (ê²°ì œ ë°©ë²• í¬í•¨)
            const newCompany = {
                id: Date.now(),
                company: request.company,  // company í•„ë“œ ì¶”ê°€
                name: request.company,     // name í•„ë“œë„ ìœ ì§€ (í˜¸í™˜ì„±)
                phone: request.phone,
                manager: request.manager,
                managerPhone: request.manager,  // ë‹´ë‹¹ì ì—°ë½ì²˜ë„ ì €ì¥
                address: request.address,
                paymentMethod: request.paymentMethod || 'bank',
                businessNumber: request.businessNumber || "",
                prices: {  // ê¸°ë³¸ ê°€ê²© ì¶”ê°€
                    warm: 7500,
                    salad: 7500,
                    ilpoom: 7500,
                    heating: 8000
                },
                registeredAt: request.approvedAt
            };
            
            console.log('âœ… ìƒˆ ì—…ì²´ ë“±ë¡:', newCompany);
            registeredCompanies.push(newCompany);
            
            localStorage.setItem('jindamConsultRequests', JSON.stringify(consultRequests));
            localStorage.setItem('jindamCompanies', JSON.stringify(registeredCompanies));
            
            console.log('âœ… localStorage ì €ì¥ ì™„ë£Œ');
            console.log('ë“±ë¡ëœ ì—…ì²´ ìˆ˜:', registeredCompanies.length);
            
            // Google Sheetsì—ë„ ì €ì¥
            saveCompanyToSheet(newCompany);
            
            displayConsultRequests();
            showValidationError('ì—…ì²´ê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!\ní•´ë‹¹ ì „í™”ë²ˆí˜¸ë¡œ ì£¼ë¬¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        }

        // ìƒë‹´ ìš”ì²­ ê±°ì ˆ
        function rejectConsultRequest(id) {
            const reason = prompt('ê±°ì ˆ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ì„ íƒì‚¬í•­):');
            if (reason === null) return; // ì·¨ì†Œ
            
            const request = consultRequests.find(r => r.id === id);
            if (!request) return;
            
            request.status = 'rejected';
            request.rejectedAt = new Date().toISOString();
            request.rejectReason = reason;
            
            localStorage.setItem('jindamConsultRequests', JSON.stringify(consultRequests));
            
            displayConsultRequests();
            alert('ê±°ì ˆ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ìƒë‹´ ìš”ì²­ ëª©ë¡ í‘œì‹œ
        function displayConsultRequests() {
            const pending = consultRequests.filter(r => r.status === 'pending');
            const approved = consultRequests.filter(r => r.status === 'approved');
            const rejected = consultRequests.filter(r => r.status === 'rejected');
            
            document.getElementById('pendingCount').textContent = pending.length;
            document.getElementById('approvedCount').textContent = approved.length;
            document.getElementById('rejectedCount').textContent = rejected.length;
            
            // ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡
            const pendingList = document.getElementById('pendingList');
            if (pending.length === 0) {
                pendingList.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            } else {
                const paymentMethodNames = {
                    'bank': 'ğŸ’° ì…ê¸ˆ (ì„¸ê¸ˆê³„ì‚°ì„œ)',
                    'visit_card': 'ğŸ’³ ë°©ë¬¸ ì¹´ë“œ ê²°ì œ',
                    'online_card': 'ğŸŒ ì˜¨ë¼ì¸ ì¹´ë“œ ê²°ì œ'
                };
                
                pendingList.innerHTML = '<div class="section-title">ğŸ“‹ ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡</div>' + pending.map(req => `
                    <div style="background: #fff; border-radius: 12px; padding: 20px; margin-bottom: 16px; border: 2px solid #ff6b35; box-shadow: 0 4px 12px rgba(255,107,53,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                            <div style="flex: 1;">
                                <div style="font-size: 18px; font-weight: 700; color: #ff6b35; margin-bottom: 8px;">${req.company}</div>
                                <div style="font-size: 14px; color: #666; margin-bottom: 4px;">ğŸ“ ëŒ€í‘œë²ˆí˜¸: ${req.phone}</div>
                                <div style="font-size: 14px; color: #666; margin-bottom: 4px;">ğŸ“± ë‹´ë‹¹ì: ${req.manager}</div>
                                <div style="font-size: 14px; color: #666; margin-bottom: 4px;">ğŸ“ ì£¼ì†Œ: ${req.address}</div>
                                <div style="background: #f0f9ff; padding: 8px 12px; border-radius: 6px; margin-top: 8px; display: inline-block;">
                                    <span style="font-size: 14px; font-weight: 600; color: #1e40af;">${paymentMethodNames[req.paymentMethod] || "ğŸ’° ì…ê¸ˆ"}</span>
                                    ${req.businessNumber ? `<div style="font-size: 12px; color: #666; margin-top: 4px;">ì‚¬ì—…ìë²ˆí˜¸: ${req.businessNumber}</div>` : ""}
                                    ${req.businessLicense ? `
                                        <div style="margin-top: 8px;">
                                            <a href="${req.businessLicense.data}" download="${req.businessLicense.name}" style="display: inline-flex; align-items: center; gap: 4px; padding: 6px 12px; background: #22c55e; color: white; text-decoration: none; border-radius: 6px; font-size: 12px; font-weight: 600;">
                                                ğŸ“„ ì‚¬ì—…ìë“±ë¡ì¦ ë‹¤ìš´ë¡œë“œ
                                            </a>
                                        </div>
                                    ` : ""}
                                </div>
                            </div>
                            <div style="padding: 6px 12px; border-radius: 20px; background: #fff3f0; color: #ff6b35; font-size: 12px; font-weight: 600; white-space: nowrap;">
                                ëŒ€ê¸°ì¤‘
                            </div>
                        </div>
                        ${req.volume ? `<div style="font-size: 14px; color: #666; margin-bottom: 8px;">ğŸ“¦ ì˜ˆìƒ ì£¼ë¬¸ëŸ‰: ${req.volume}</div>` : ""}
                        ${req.note ? `<div style="background: #f9f9f9; padding: 12px; border-radius: 8px; margin-bottom: 12px;"><div style="font-size: 13px; color: #999; margin-bottom: 4px;">ë¬¸ì˜ì‚¬í•­:</div><div style="font-size: 14px; color: #333;">${req.note}</div></div>` : ""}
                        <div style="font-size: 12px; color: #999; margin-bottom: 16px;">ì‹ ì²­ì¼: ${new Date(req.requestedAt).toLocaleString("ko-KR")}</div>
                        <div style="display: flex; gap: 8px;">
                            <button onclick="approveConsultRequest(${req.id})" style="flex: 1; background: #22c55e; color: #ffffff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                âœ… ìŠ¹ì¸
                            </button>
                            <button onclick="rejectConsultRequest(${req.id})" style="flex: 1; background: #ef4444; color: #ffffff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                âŒ ê±°ì ˆ
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            // ìŠ¹ì¸ ì™„ë£Œ ëª©ë¡
            const approvedList = document.getElementById('approvedList');
            if (approved.length === 0) {
                approvedList.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">ìŠ¹ì¸ëœ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            } else {
                approvedList.innerHTML = '<div class="section-title">âœ… ìŠ¹ì¸ ì™„ë£Œ ëª©ë¡</div>' + approved.map(req => `
                    <div style="background: #fff; border-radius: 12px; padding: 16px; margin-bottom: 12px; border: 1px solid #e0e0e0;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; color: #333; margin-bottom: 4px;">${req.company}</div>
                                <div style="font-size: 13px; color: #666;">ğŸ“ ${req.phone}</div>
                                <div style="font-size: 12px; color: #999; margin-top: 4px;">ìŠ¹ì¸ì¼: ${new Date(req.approvedAt).toLocaleDateString("ko-KR")}</div>
                            </div>
                            <div style="padding: 4px 12px; border-radius: 20px; background: #f0fdf4; color: #22c55e; font-size: 12px; font-weight: 600;">
                                ìŠ¹ì¸ì™„ë£Œ
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            // ê±°ì ˆ ëª©ë¡
            const rejectedList = document.getElementById('rejectedList');
            if (rejected.length === 0) {
                rejectedList.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">ê±°ì ˆëœ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            } else {
                rejectedList.innerHTML = '<div class="section-title">âŒ ê±°ì ˆ ëª©ë¡</div>' + rejected.map(req => `
                    <div style="background: #fff; border-radius: 12px; padding: 16px; margin-bottom: 12px; border: 1px solid #fee;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                <div style="font-weight: 600; color: #333; margin-bottom: 4px;">${req.company}</div>
                                <div style="font-size: 13px; color: #666; margin-bottom: 4px;">ğŸ“ ${req.phone}</div>
                                ${req.rejectReason ? `<div style="font-size: 12px; color: #f44; margin-top: 8px;">ê±°ì ˆì‚¬ìœ : ${req.rejectReason}</div>` : ""}
                                <div style="font-size: 12px; color: #999; margin-top: 4px;">ê±°ì ˆì¼: ${new Date(req.rejectedAt).toLocaleDateString("ko-KR")}</div>
                            </div>
                            <div style="padding: 4px 12px; border-radius: 20px; background: #fee; color: #f44; font-size: 12px; font-weight: 600;">
                                ê±°ì ˆ
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        // íƒ­ ì „í™˜
        function showPendingTab() {
            document.getElementById('pendingList').style.display = 'block';
            document.getElementById('approvedList').style.display = 'none';
            document.getElementById('rejectedList').style.display = 'none';
            
            document.getElementById('pendingTab').style.background = 'linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)';
            document.getElementById('pendingTab').style.color = '#ffffff';
            document.getElementById('approvedTab').style.background = '#f5f5f5';
            document.getElementById('approvedTab').style.color = '#666';
            document.getElementById('rejectedTab').style.background = '#f5f5f5';
            document.getElementById('rejectedTab').style.color = '#666';
        }

        function showApprovedTab() {
            document.getElementById('pendingList').style.display = 'none';
            document.getElementById('approvedList').style.display = 'block';
            document.getElementById('rejectedList').style.display = 'none';
            
            document.getElementById('pendingTab').style.background = '#f5f5f5';
            document.getElementById('pendingTab').style.color = '#666';
            document.getElementById('approvedTab').style.background = 'linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)';
            document.getElementById('approvedTab').style.color = '#ffffff';
            document.getElementById('rejectedTab').style.background = '#f5f5f5';
            document.getElementById('rejectedTab').style.color = '#666';
        }

        function showRejectedTab() {
            document.getElementById('pendingList').style.display = 'none';
            document.getElementById('approvedList').style.display = 'none';
            document.getElementById('rejectedList').style.display = 'block';
            
            document.getElementById('pendingTab').style.background = '#f5f5f5';
            document.getElementById('pendingTab').style.color = '#666';
            document.getElementById('approvedTab').style.background = '#f5f5f5';
            document.getElementById('approvedTab').style.color = '#666';
            document.getElementById('rejectedTab').style.background = 'linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)';
            document.getElementById('rejectedTab').style.color = '#ffffff';
        }

        function showPhoneVerifyPage() {
            hideAllPages();
            document.getElementById('phoneVerifyPage').classList.add('active');
            document.getElementById('verifyPhone').value = '';
            document.getElementById('verifyResult').style.display = 'none';
        }

        function showExistingCustomerRegister() {
            hideAllPages();
            document.getElementById('existingCustomerRegisterPage').classList.add('active');
        }

        // ê¸°ì¡´ ê³ ê° ë“±ë¡ ì œì¶œ
        function submitExistingCustomerRegister() {
            const company = document.getElementById('existingCompanyName').value.trim();
            const phone = document.getElementById('existingCompanyPhone').value.trim().replace(/[^0-9]/g, '');
            const manager = document.getElementById('existingManagerPhone').value.trim().replace(/[^0-9]/g, '');
            const address = document.getElementById('existingAddress').value.trim();
            
            if (!company || !phone || !manager || !address) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì¤‘ë³µ ì²´í¬
            const existing = registeredCompanies.find(c => c.phone === phone);
            if (existing) {
                alert('ì´ë¯¸ ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤.\ní•´ë‹¹ ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
                showPhoneVerifyPage();
                return;
            }
            
            const existingRequest = consultRequests.find(c => c.phone === phone && c.status === 'pending');
            if (existingRequest) {
                alert('ì´ë¯¸ ë“±ë¡ ì‹ ì²­ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.\nìŠ¹ì¸ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
                return;
            }
            
            const request = {
                id: Date.now(),
                company: company,
                phone: phone,
                manager: manager,
                address: address,
                volume: 'ê¸°ì¡´ ê³ ê°',
                note: 'ê¸°ì¡´ ê³ ê° - ì˜¨ë¼ì¸ ì‹œìŠ¤í…œ ì „í™˜',
                status: 'pending',
                requestedAt: new Date().toISOString(),
                isExisting: true
            };
            
            consultRequests.push(request);
            localStorage.setItem('jindamConsultRequests', JSON.stringify(consultRequests));
            
            alert('ë“±ë¡ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nìŠ¹ì¸ í›„ í•´ë‹¹ ë²ˆí˜¸ë¡œ ë°”ë¡œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('existingCompanyName').value = '';
            document.getElementById('existingCompanyPhone').value = '';
            document.getElementById('existingManagerPhone').value = '';
            document.getElementById('existingAddress').value = '';
            
            showCustomerTypePage();
        }

        function verifyPhoneNumber() {
            const phone = document.getElementById('verifyPhone').value.trim().replace(/[^0-9]/g, '');
            const resultDiv = document.getElementById('verifyResult');
            
            if (!phone) {
                resultDiv.style.display = 'block';
                resultDiv.style.background = '#fff3f0';
                resultDiv.style.color = '#ff6b35';
                resultDiv.innerHTML = 'ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                return;
            }
            
            console.log('ğŸ” ì „í™”ë²ˆí˜¸ í™•ì¸:', phone);
            console.log('ğŸ“‹ ë“±ë¡ëœ íšŒì‚¬ ìˆ˜:', registeredCompanies.length);
            
            // ë“±ë¡ëœ ì—…ì²´ ì°¾ê¸° (ì–‘ìª½ ëª¨ë‘ ì •ê·œí™”í•˜ì—¬ ë¹„êµ)
            const company = registeredCompanies.find(c => {
                const companyPhone = (c.phone || '').replace(/[^0-9]/g, '');
                const managerPhone = (c.managerPhone || '').replace(/[^0-9]/g, '');
                
                console.log('ë¹„êµ:', phone, 'vs', companyPhone, '/', managerPhone, '(', c.company, ')');
                
                return phone === companyPhone || phone === managerPhone;
            });
            
            if (company) {
                currentCompany = company;
                
                // ì—…ì²´ë³„ ë‹¨ê°€ ë¡œë“œ (ì—†ìœ¼ë©´ ê¸°ë³¸ ë‹¨ê°€ ì‚¬ìš©)
                if (company.prices) {
                    prices = { ...company.prices };
                } else {
                    prices = { ...defaultPrices };
                }
                
                resultDiv.style.display = 'block';
                resultDiv.style.background = '#f0fdf4';
                resultDiv.style.color = '#22c55e';
                const companyName = company.company || company.name || 'ê³ ê°';
                resultDiv.innerHTML = `âœ“ ${companyName}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`;
                
                setTimeout(() => {
                    showNoticePage();
                }, 1000);
            } else {
                resultDiv.style.display = 'block';
                resultDiv.style.background = '#fff3f0';
                resultDiv.style.color = '#ff6b35';
                resultDiv.innerHTML = 'ë“±ë¡ë˜ì§€ ì•Šì€ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤.<br>ì‹ ê·œ ê³ ê°ì€ ìƒë‹´ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.';
            }
        }
        
        function resetPhoneInput() {
            document.getElementById('verifyPhone').value = '';
            document.getElementById('verifyResult').style.display = 'none';
            currentCompany = null;
            document.getElementById('verifyPhone').focus();
        }

        function showCompanyManagement() {
            document.getElementById('orderManagementSection').style.display = 'none';
            document.getElementById('companyManagementSection').style.display = 'block';
            document.getElementById('statementManagementSection').style.display = 'none';
            document.getElementById('paymentManagementSection').style.display = 'none';
            displayConsultRequests();
            showPendingTab();
        }
        
        function showOrderManagement() {
            document.getElementById('orderManagementSection').style.display = 'block';
            document.getElementById('companyManagementSection').style.display = 'none';
            document.getElementById('statementManagementSection').style.display = 'none';
            document.getElementById('paymentManagementSection').style.display = 'none';
            
            // ì˜¤ëŠ˜ ë‚ ì§œë¡œ ìë™ ì„¤ì •
            const today = new Date();
            const todayString = today.toISOString().split('T')[0];
            document.getElementById('adminDateFilter').value = todayString;
            filterOrdersByDate();
        }
        
        function showStatementManagement() {
            document.getElementById('orderManagementSection').style.display = 'none';
            document.getElementById('companyManagementSection').style.display = 'none';
            document.getElementById('statementManagementSection').style.display = 'block';
            document.getElementById('paymentManagementSection').style.display = 'none';
            document.getElementById('approvedSummarySection').style.display = 'none';
            
            // í˜„ì¬ ì›” í‘œì‹œ
            const today = new Date();
            document.getElementById('adminPeriodText').textContent = `${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›”`;
            
            displayStatementCompanyList();
        }
        
        function displayStatementCompanyList() {
            const companies = registeredCompanies;
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${String(currentMonth).padStart(2, "0")}`;
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            
            // ê²€ìƒ‰ í•„í„°ë§
            const searchTerm = document.getElementById('statementSearchInput')?.value.toLowerCase().trim() || "";
            let filteredCompanies = companies;
            
            if (searchTerm) {
                filteredCompanies = companies.filter(c => 
                    c.company.toLowerCase().includes(searchTerm) || 
                    c.phone.includes(searchTerm)
                );
            }
            
            if (filteredCompanies.length === 0) {
                document.getElementById('statementCompanyList').innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 48px; margin-bottom: 16px;">${searchTerm ? "ğŸ”" : "ğŸ¢"}</div>
                        <div style="font-size: 16px;">${searchTerm ? "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤." : "ë“±ë¡ëœ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤."}</div>
                    </div>
                `;
                return;
            }
            
            const listHtml = `
                <div style="background: #f0f9ff; border: 2px solid #3b82f6; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="selectAllStatements" onchange="toggleAllStatements()" style="width: 20px; height: 20px; cursor: pointer;">
                        <span style="font-size: 15px; font-weight: 600; color: #1e40af;">ì „ì²´ ì„ íƒ</span>
                    </label>
                </div>
                
                ${filteredCompanies.map(company => {
                    const isApproved = approvedStatements[company.phone]?.[statementKey]?.approved || false;
                    const approvedDate = approvedStatements[company.phone]?.[statementKey]?.date || null;
                    
                    return `
                        <div style="background: white; padding: 16px; border-radius: 12px; margin-bottom: 12px; border: 2px solid ${isApproved ? "#10b981" : "#e0e0e0"};">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <input type="checkbox" class="statement-checkbox" data-phone="${company.phone}" ${isApproved ? "checked" : ""} onchange="updateApproveButton()" style="width: 20px; height: 20px; cursor: pointer;">
                                <div style="flex: 1; cursor: pointer;" onclick="viewCompanyStatement('${company.phone}')">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-size: 16px; font-weight: 600; color: #333; margin-bottom: 4px;">${company.company}</div>
                                            <div style="font-size: 13px; color: #999;">${company.phone}</div>
                                            ${company.address ? `<div style="font-size: 12px; color: #666; margin-top: 4px;">ğŸ“ ${company.address}</div>` : ""}
                                        </div>
                                        <div style="text-align: right;">
                                            ${isApproved ? 
                                                `<div style="background: #d1fae5; color: #065f46; padding: 6px 10px; border-radius: 6px; font-size: 12px; font-weight: 600; margin-bottom: 4px;">âœ… ìŠ¹ì¸ì™„ë£Œ</div>
                                                <div style="font-size: 10px; color: #666;">${approvedDate}</div>` 
                                                : 
                                                `<div style="background: #fef3c7; color: #92400e; padding: 6px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;">â³ ìŠ¹ì¸ëŒ€ê¸°</div>`
                                            }
                                        </div>
                                    </div>
                                </div>
                                <button onclick="viewCompanyStatement('${company.phone}')" style="background: #3b82f6; color: #ffffff; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; white-space: nowrap;">
                                    ë³´ê¸°
                                </button>
                            </div>
                        </div>
                    `;
                }).join('')}
                
                <div id="statementBulkActions" style="position: sticky; bottom: 20px; background: white; padding: 16px; border-radius: 12px; box-shadow: 0 -4px 20px rgba(0,0,0,0.1); margin-top: 20px; display: none;">
                    <div style="display: flex; gap: 12px;">
                        <button onclick="bulkApproveStatements()" id="bulkApproveBtn" style="flex: 1; background: #22c55e; color: #ffffff; border: none; padding: 16px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            âœ… ì„ íƒí•œ ì—…ì²´ ìŠ¹ì¸ (<span id="selectedCount">0</span>ê°œ)
                        </button>
                        <button onclick="bulkUnapproveStatements()" id="bulkUnapproveBtn" style="flex: 1; background: #dc2626; color: #ffffff; border: none; padding: 16px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600; display: none;">
                            âŒ ì„ íƒí•œ ì—…ì²´ ìŠ¹ì¸ ì·¨ì†Œ
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('statementCompanyList').innerHTML = listHtml;
            updateApproveButton();
        }
        
        function searchStatementCompanies() {
            displayStatementCompanyList();
        }
        
        function toggleAllStatements() {
            const selectAll = document.getElementById('selectAllStatements');
            const checkboxes = document.querySelectorAll('.statement-checkbox');
            checkboxes.forEach(cb => cb.checked = selectAll.checked);
            updateApproveButton();
        }
        
        function updateApproveButton() {
            const checkboxes = document.querySelectorAll('.statement-checkbox');
            const checkedBoxes = Array.from(checkboxes).filter(cb => cb.checked);
            const selectedCount = checkedBoxes.length;
            
            const bulkActions = document.getElementById('statementBulkActions');
            const selectedCountSpan = document.getElementById('selectedCount');
            const approveBtn = document.getElementById('bulkApproveBtn');
            const unapproveBtn = document.getElementById('bulkUnapproveBtn');
            
            if (selectedCount > 0) {
                bulkActions.style.display = 'block';
                selectedCountSpan.textContent = selectedCount;
                
                // ì„ íƒëœ í•­ëª© ì¤‘ ì´ë¯¸ ìŠ¹ì¸ëœ ê²ƒì´ ìˆëŠ”ì§€ í™•ì¸
                const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
                const today = new Date();
                const statementKey = `${today.getFullYear()}-${today.getMonth() + 1}`;
                
                const hasApproved = checkedBoxes.some(cb => {
                    const phone = cb.getAttribute('data-phone');
                    return approvedStatements[phone]?.[statementKey]?.approved;
                });
                
                const hasUnapproved = checkedBoxes.some(cb => {
                    const phone = cb.getAttribute('data-phone');
                    return !approvedStatements[phone]?.[statementKey]?.approved;
                });
                
                // ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
                approveBtn.style.display = hasUnapproved ? "block" : "none";
                unapproveBtn.style.display = hasApproved ? "block" : "none";
            } else {
                bulkActions.style.display = 'none';
            }
            
            // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
            const selectAll = document.getElementById('selectAllStatements');
            if (selectAll) {
                selectAll.checked = selectedCount === checkboxes.length && selectedCount > 0;
            }
        }
        
        function bulkApproveStatements() {
            const checkboxes = document.querySelectorAll('.statement-checkbox:checked');
            const phones = Array.from(checkboxes).map(cb => cb.getAttribute('data-phone'));
            
            if (phones.length === 0) return;
            
            if (!confirm(`ì„ íƒí•œ ${phones.length}ê°œ ì—…ì²´ì˜ ê±°ë˜ëª…ì„¸ì„œë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${currentMonth}`;
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            
            phones.forEach(phone => {
                if (!approvedStatements[phone]) {
                    approvedStatements[phone] = {};
                }
                approvedStatements[phone][statementKey] = {
                    approved: true,
                    date: new Date().toLocaleDateString("ko-KR")
                };
            });
            
            localStorage.setItem('approvedStatements', JSON.stringify(approvedStatements));
            
            alert(`${phones.length}ê°œ ì—…ì²´ì˜ ê±°ë˜ëª…ì„¸ì„œê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            displayStatementCompanyList();
        }
        
        function bulkUnapproveStatements() {
            const checkboxes = document.querySelectorAll('.statement-checkbox:checked');
            const phones = Array.from(checkboxes).map(cb => cb.getAttribute('data-phone'));
            
            if (phones.length === 0) return;
            
            if (!confirm(`ì„ íƒí•œ ${phones.length}ê°œ ì—…ì²´ì˜ ìŠ¹ì¸ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${currentMonth}`;
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            
            phones.forEach(phone => {
                if (approvedStatements[phone]?.[statementKey]) {
                    delete approvedStatements[phone][statementKey];
                }
            });
            
            localStorage.setItem('approvedStatements', JSON.stringify(approvedStatements));
            
            alert(`${phones.length}ê°œ ì—…ì²´ì˜ ìŠ¹ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            displayStatementCompanyList();
        }
        
        function viewCompanyStatement(phone) {
            // í•´ë‹¹ ì—…ì²´ ì •ë³´ë¡œ currentCompany ì„ì‹œ ì„¤ì •
            const company = registeredCompanies.find(c => c.phone === phone);
            
            if (!company) {
                alert('ì—…ì²´ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì„ì‹œë¡œ currentCompany ì„¤ì •
            const originalCompany = currentCompany;
            const originalIsAdmin = isAdmin;
            currentCompany = company;
            isAdmin = true; // ê´€ë¦¬ìë¡œ ì„¤ì •
            
            // ê±°ë˜ëª…ì„¸ì„œ í˜ì´ì§€ í‘œì‹œ
            hideAllPages();
            document.getElementById('monthlyStatementPage').classList.add('active');
            generateMonthlyStatement();
            
            // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìˆ˜ì •
            const backButton = document.querySelector('#monthlyStatementPage .header .icon');
            backButton.onclick = function() {
                currentCompany = originalCompany;
                isAdmin = originalIsAdmin;
                showAdminPage();
                showStatementManagement();
            };
        }

        function showOrderManagement() {
            document.getElementById('companyManagementSection').style.display = 'none';
            document.getElementById('statementManagementSection').style.display = 'none';
            document.getElementById('paymentManagementSection').style.display = 'none';
            document.getElementById('orderManagementSection').style.display = 'block';
        }

        function showCustomerTypePage() {
            hideAllPages();
            document.getElementById('customerTypePage').classList.add('active');
        }

        function showNewCustomerPage() {
            hideAllPages();
            document.getElementById('newCustomerPage').classList.add('active');
        }

        function showNoticePage() {
            hideAllPages();
            document.getElementById('noticePage').classList.add('active');
        }

        function canOrderForDate(targetDate) {
            const now = new Date();
            const target = new Date(targetDate);
            target.setHours(0, 0, 0, 0);
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // ê³¼ê±° ë‚ ì§œëŠ” ë¶ˆê°€
            if (target < today) return false;
            
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);
            
            // ì˜¤ëŠ˜ ë°°ì†¡: ì˜¤ëŠ˜ ì˜¤ì „ 9ì‹œê¹Œì§€ë§Œ ê°€ëŠ¥ (ë³´ì˜¨/ë°œì—´ ë„ì‹œë½)
            if (target.getTime() === today.getTime()) {
                if (now.getHours() >= 9) return false;
                return true;
            }
            
            // ë‚´ì¼ ë°°ì†¡: ì˜¤ëŠ˜ ì˜¤í›„ 6ì‹œê¹Œì§€ ê°€ëŠ¥
            if (target.getTime() === tomorrow.getTime()) {
                if (now.getHours() >= 18) {
                    return false;
                }
                return true;
            }
            
            // ëª¨ë ˆ ì´í›„: ëª¨ë‘ ê°€ëŠ¥
            return true;
        }

        // ë©”ë‰´ë³„ ì£¼ë¬¸ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸ (ìƒëŸ¬ë“œ/ì¼í’ˆì€ ì „ë‚  6ì‹œê¹Œì§€ë§Œ)
        function canOrderMenuForDate(targetDate, menuType) {
            const now = new Date();
            const target = new Date(targetDate);
            target.setHours(0, 0, 0, 0);
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // ë³´ì˜¨/ë°œì—´ì€ í•­ìƒ ê°€ëŠ¥ (canOrderForDateì—ì„œ ì²´í¬ë¨)
            if (menuType === 'warm' || menuType === 'heating') {
                return true;
            }
            
            // ìƒëŸ¬ë“œ/ì¼í’ˆì€ ì „ë‚  ì˜¤í›„ 6ì‹œê¹Œì§€ë§Œ ì£¼ë¬¸ ê°€ëŠ¥
            if (menuType === 'salad' || menuType === 'ilpoom') {
                const tomorrow = new Date(today);
                tomorrow.setDate(today.getDate() + 1);
                
                // ë‚´ì¼ ë°°ì†¡ì¸ ê²½ìš°: ì˜¤ëŠ˜ ì˜¤í›„ 6ì‹œê¹Œì§€ë§Œ
                if (target.getTime() === tomorrow.getTime()) {
                    if (now.getHours() >= 18) {
                        return false; // ì´ë¯¸ 6ì‹œ ì§€ë‚¨
                    }
                    return true;
                }
                
                // ì˜¤ëŠ˜ ë°°ì†¡ì¸ ê²½ìš°: ë¶ˆê°€ (ì–´ì œ 6ì‹œì— ë§ˆê°ë¨)
                if (target.getTime() === today.getTime()) {
                    return false;
                }
                
                // ëª¨ë ˆ ì´í›„: ê°€ëŠ¥
                return true;
            }
            
            return true;
        }

        function showOrderPage() {
            hideAllPages();
            document.getElementById('orderPage').classList.add('active');
            generateCalendar();
            
            // í˜„ì¬ ë¡œê·¸ì¸í•œ ì—…ì²´ ì •ë³´ ìë™ ì…ë ¥
            if (currentCompany) {
                // ì—…ì²´ëª…
                const companyInput = document.getElementById('customerCompany');
                if (companyInput) {
                    companyInput.value = currentCompany.name || "";
                }
                
                // ëŒ€í‘œ ì „í™”ë²ˆí˜¸
                const phoneInput = document.getElementById('customerPhone');
                if (phoneInput) {
                    phoneInput.value = currentCompany.phone || "";
                }
                
                // ê¸°ë³¸ ë°°ì†¡ ì£¼ì†Œë„ ìë™ ì…ë ¥ (ìˆ˜ì • ê°€ëŠ¥)
                const addressInput = document.getElementById('customerAddress');
                if (addressInput && currentCompany.address) {
                    addressInput.value = currentCompany.address;
                }
                
                // ì €ì¥ëœ ë‹´ë‹¹ì ì—°ë½ì²˜ ë¶ˆëŸ¬ì˜¤ê¸°
                const savedContact = localStorage.getItem(`contactPhone_${currentCompany.phone}`);
                const contactInput = document.getElementById('customerContactPhone');
                const saveBtn = document.getElementById('saveContactBtn');
                const editBtn = document.getElementById('editContactBtn');
                
                if (contactInput) {
                    if (savedContact) {
                        contactInput.value = savedContact;
                        contactInput.readOnly = true;
                        contactInput.style.backgroundColor = '#f5f5f5';
                        if (saveBtn) saveBtn.style.display = 'none';
                        if (editBtn) editBtn.style.display = 'block';
                    } else {
                        contactInput.value = '';
                        contactInput.readOnly = false;
                        contactInput.style.backgroundColor = '#ffffff';
                        if (saveBtn) saveBtn.style.display = 'block';
                        if (editBtn) editBtn.style.display = 'none';
                    }
                }
            } else {
                // currentCompanyê°€ ì—†ì„ ë•Œ (ë¹„ì •ìƒì ì¸ ìƒí™©)
                alert('ë¡œê·¸ì¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
                showPhoneVerifyPage();
            }
        }
        
        function saveContactPhone() {
            const contactPhone = document.getElementById('customerContactPhone').value.trim();
            
            if (!contactPhone) {
                showValidationError('ë‹´ë‹¹ì ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì „í™”ë²ˆí˜¸ í˜•ì‹ ê²€ì¦ (ê°„ë‹¨)
            const phonePattern = /^01[0-9]-?[0-9]{3,4}-?[0-9]{4}$/;
            if (!phonePattern.test(contactPhone)) {
                showValidationError('ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.\nì˜ˆ: 010-1234-5678');
                return;
            }
            
            // localStorageì— ì €ì¥ (ì—…ì²´ë³„ë¡œ)
            localStorage.setItem(`contactPhone_${currentCompany.phone}`, contactPhone);
            
            // UI ì—…ë°ì´íŠ¸
            document.getElementById('customerContactPhone').readOnly = true;
            document.getElementById('customerContactPhone').style.backgroundColor = '#f5f5f5';
            document.getElementById('saveContactBtn').style.display = 'none';
            document.getElementById('editContactBtn').style.display = 'block';
            
            // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            const message = document.getElementById('savedContactMessage');
            message.style.display = 'block';
            setTimeout(() => {
                message.style.display = 'none';
            }, 3000);
        }
        
        function editContactPhone() {
            document.getElementById('customerContactPhone').readOnly = false;
            document.getElementById('customerContactPhone').style.backgroundColor = '#ffffff';
            document.getElementById('customerContactPhone').focus();
            document.getElementById('saveContactBtn').style.display = 'block';
            document.getElementById('editContactBtn').style.display = 'none';
        }

        function showAdminPage() {
            hideAllPages();
            document.getElementById('adminPage').classList.add('active');
            document.getElementById('adminLogin').style.display = 'block';
            document.getElementById('adminDashboard').style.display = 'none';
        }

        function showOrderHistory() {
            hideAllPages();
            document.getElementById('orderHistoryPage').classList.add('active');
            displayUserOrderHistory();
        }
        
        function showPaymentInfo() {
            hideAllPages();
            document.getElementById('paymentInfoPage').classList.add('active');
            displayPaymentInfo();
        }

        function showMonthlyStatement() {
            if (!currentCompany) {
                alert('ë¡œê·¸ì¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            hideAllPages();
            document.getElementById('monthlyStatementPage').classList.add('active');
            generateMonthlyStatement();
        }

        function generateMonthlyStatement() {
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            
            // ì´ë²ˆ ë‹¬ ì£¼ë¬¸ë§Œ í•„í„°ë§
            const monthlyOrders = userOrders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate.getMonth() + 1 === currentMonth && 
                       orderDate.getFullYear() === currentYear;
            });
            
            if (monthlyOrders.length === 0) {
                document.getElementById('statementContent').innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“„</div>
                        <div style="font-size: 16px;">ì´ë²ˆ ë‹¬ ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</div>
                    </div>
                `;
                return;
            }
            
            // ìŠ¹ì¸ ìƒíƒœ í™•ì¸
            const statementKey = `${currentYear}-${String(currentMonth).padStart(2, "0")}`;
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            const isApproved = approvedStatements[currentCompany.phone]?.[statementKey]?.approved || false;
            
            // ê³ ê°ì´ê³  ìŠ¹ì¸ ì „ì´ë©´ ì£¼ë¬¸ ëª©ë¡ë§Œ í‘œì‹œ
            if (!isAdmin && !isApproved) {
                // ë©”ë‰´ë³„ í•©ê³„ ê³„ì‚°
                const menuTotals = {
                    warm: { quantity: 0, amount: 0 },
                    salad: { quantity: 0, amount: 0 },
                    ilpoom: { quantity: 0, amount: 0 },
                    heating: { quantity: 0, amount: 0 }
                };
                
                let totalAmount = 0;
                
                monthlyOrders.forEach(order => {
                    order.items.forEach(item => {
                        if (menuTotals[item.type]) {
                            menuTotals[item.type].quantity += item.quantity;
                            menuTotals[item.type].amount += item.quantity * item.price;
                        }
                    });
                    totalAmount += order.total;
                });
                
                const vat = Math.round(totalAmount * 0.1);
                const totalWithVat = totalAmount + vat;
                
                const content = `
                    <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                            <span style="font-size: 32px;">â³</span>
                            <div>
                                <div style="font-size: 18px; font-weight: 700; color: #92400e; margin-bottom: 4px;">ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ì¤‘</div>
                                <div style="font-size: 14px; color: #92400e;">ê´€ë¦¬ì ìŠ¹ì¸ í›„ ê±°ë˜ëª…ì„¸ì„œë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: white; border: 2px solid #e0e0e0; border-radius: 12px; padding: 24px;">
                        <h3 style="font-size: 20px; font-weight: 700; color: #333; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 2px solid #e0e0e0;">
                            ğŸ“‹ ${currentYear}ë…„ ${currentMonth}ì›” ì£¼ë¬¸ ë‚´ì—­
                        </h3>
                        
                        <div style="margin-bottom: 24px;">
                            ${monthlyOrders.map(order => `
                                <div style="background: #f9f9f9; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
                                    <div style="font-size: 14px; font-weight: 600; color: #333; margin-bottom: 8px;">
                                        ğŸ“… ${order.date} ${order.time}
                                    </div>
                                    <div style="font-size: 13px; color: #666;">
                                        ${order.items.map(item => `
                                            <div style="display: flex; justify-content: space-between; padding: 4px 0;">
                                                <span>${item.name}</span>
                                                <span>${item.quantity}ê°œ Ã— ${item.price.toLocaleString()}ì› = ${(item.quantity * item.price).toLocaleString()}ì›</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #e0e0e0; text-align: right; font-weight: 600; color: #ff6b35;">
                                        ì†Œê³„: ${order.total.toLocaleString()}ì›
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="background: #fff3f0; padding: 20px; border-radius: 12px; border: 2px solid #ff6b35;">
                            <div style="font-size: 16px; font-weight: 700; color: #333; margin-bottom: 16px;">ğŸ“Š ì›”ê°„ í•©ê³„</div>
                            
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px;">
                                ${menuTotals.warm.quantity > 0 ? `
                                    <div style="background: white; padding: 12px; border-radius: 8px;">
                                        <div style="font-size: 12px; color: #999; margin-bottom: 4px;">ğŸ± ë³´ì˜¨</div>
                                        <div style="font-size: 14px; font-weight: 600; color: #333;">${menuTotals.warm.quantity}ê°œ</div>
                                        <div style="font-size: 13px; color: #666;">${menuTotals.warm.amount.toLocaleString()}ì›</div>
                                    </div>
                                ` : ""}
                                ${menuTotals.salad.quantity > 0 ? `
                                    <div style="background: white; padding: 12px; border-radius: 8px;">
                                        <div style="font-size: 12px; color: #999; margin-bottom: 4px;">ğŸ¥— ìƒëŸ¬ë“œ</div>
                                        <div style="font-size: 14px; font-weight: 600; color: #333;">${menuTotals.salad.quantity}ê°œ</div>
                                        <div style="font-size: 13px; color: #666;">${menuTotals.salad.amount.toLocaleString()}ì›</div>
                                    </div>
                                ` : ""}
                                ${menuTotals.ilpoom.quantity > 0 ? `
                                    <div style="background: white; padding: 12px; border-radius: 8px;">
                                        <div style="font-size: 12px; color: #999; margin-bottom: 4px;">ğŸ½ï¸ ì¼í’ˆ</div>
                                        <div style="font-size: 14px; font-weight: 600; color: #333;">${menuTotals.ilpoom.quantity}ê°œ</div>
                                        <div style="font-size: 13px; color: #666;">${menuTotals.ilpoom.amount.toLocaleString()}ì›</div>
                                    </div>
                                ` : ""}
                                ${menuTotals.heating.quantity > 0 ? `
                                    <div style="background: white; padding: 12px; border-radius: 8px;">
                                        <div style="font-size: 12px; color: #999; margin-bottom: 4px;">ğŸ”¥ ë°œì—´</div>
                                        <div style="font-size: 14px; font-weight: 600; color: #333;">${menuTotals.heating.quantity}ê°œ</div>
                                        <div style="font-size: 13px; color: #666;">${menuTotals.heating.amount.toLocaleString()}ì›</div>
                                    </div>
                                ` : ""}
                            </div>
                            
                            <div style="border-top: 2px solid #ff6b35; padding-top: 16px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-size: 14px; color: #666;">ê³µê¸‰ê°€ì•¡</span>
                                    <span style="font-size: 16px; font-weight: 600; color: #333;">${totalAmount.toLocaleString()}ì›</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-size: 14px; color: #666;">ë¶€ê°€ì„¸ (10%)</span>
                                    <span style="font-size: 16px; font-weight: 600; color: #333;">${vat.toLocaleString()}ì›</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding-top: 12px; border-top: 1px solid #ff6b35;">
                                    <span style="font-size: 16px; font-weight: 700; color: #ff6b35;">í•©ê³„</span>
                                    <span style="font-size: 20px; font-weight: 700; color: #ff6b35;">${totalWithVat.toLocaleString()}ì›</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('statementContent').innerHTML = content;
                document.getElementById('statementStatusBanner').innerHTML = '';
                document.getElementById('statementActions').innerHTML = '';
                return;
            }
            
            // ê´€ë¦¬ìì´ê±°ë‚˜ ìŠ¹ì¸ëœ ê²½ìš° ì •ì‹ ê±°ë˜ëª…ì„¸ì„œ í‘œì‹œ
            // ë©”ë‰´ë³„ í•©ê³„ ê³„ì‚°
            const menuTotals = {
                warm: { quantity: 0, amount: 0 },
                salad: { quantity: 0, amount: 0 },
                ilpoom: { quantity: 0, amount: 0 },
                heating: { quantity: 0, amount: 0 }
            };
            
            let totalAmount = 0;
            
            monthlyOrders.forEach(order => {
                order.items.forEach(item => {
                    if (menuTotals[item.type]) {
                        menuTotals[item.type].quantity += item.quantity;
                        menuTotals[item.type].amount += item.quantity * item.price;
                    }
                });
                totalAmount += order.total;
            });
            
            const vat = Math.round(totalAmount * 0.1);
            const totalWithVat = totalAmount + vat;
            
            // ê³„ì•½ ë‹¨ê°€ (í˜„ì¬ ë¡œê·¸ì¸í•œ ì—…ì²´ì˜ ë‹¨ê°€)
            const contractPrices = currentCompany.prices || defaultPrices;
            
            const content = `
                <div style="background: white; border: 2px solid #333; padding: 0;">
                    <div style="text-align: center; padding: 20px; background: #f5f5f5; border-bottom: 2px solid #333;">
                        <h2 style="font-size: 28px; font-weight: 700; color: #333; margin: 0;">ê±° ë˜ ëª… ì„¸ ì„œ</h2>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 2fr; border-bottom: 1px solid #333;">
                        <div style="padding: 12px; border-right: 1px solid #333;">
                            <div style="font-size: 12px; font-weight: 700; color: #333; margin-bottom: 8px; padding-bottom: 4px; border-bottom: 2px solid #666;">ê³µê¸‰ë°›ëŠ”ì</div>
                            <div style="padding: 20px 0; text-align: center;">
                                <div style="font-size: 16px; font-weight: 700; color: #333;">
                                    ${currentCompany?.company || currentCompany?.name || "ê³ ê°"} ê·€í•˜
                                </div>
                            </div>
                        </div>
                        
                        <div style="padding: 12px;">
                            <div style="font-size: 12px; font-weight: 700; color: #333; margin-bottom: 8px; padding-bottom: 4px; border-bottom: 2px solid #666;">ê³µê¸‰ì</div>
                            <div style="font-size: 10px; line-height: 1.6; color: #333;">
                                <div><strong>ë“±ë¡ë²ˆí˜¸:</strong> 447-86-02287</div>
                                <div><strong>ìƒí˜¸(ë²•ì¸ëª…):</strong> ì£¼ì‹íšŒì‚¬ ê°€ì´ì˜¤í‘¸ë“œ</div>
                                <div><strong>ëŒ€í‘œì:</strong> ê¹€ì§„</div>
                                <div><strong>ì‚¬ì—…ì¥ì£¼ì†Œ:</strong> ë¶€ì‚° ì—°ì œêµ¬ ì¤‘ì•™ëŒ€ë¡œ 1060-1</div>
                                <div><strong>ì—…íƒœ/ì¢…ëª©:</strong> ìŒì‹ / í•œì‹, ë„ì‹œë½</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 12px 20px; background: #f9f9f9; border-bottom: 1px solid #333; text-align: right; font-size: 12px;">
                        <strong>ì‘ì„±ì¼ì:</strong> ${currentYear}ë…„ ${currentMonth}ì›” (ë°œí–‰ì¼: ${today.toLocaleDateString("ko-KR")})
                    </div>
                    
                    <div style="padding: 16px; overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 10px;">
                            <thead>
                                <tr style="background: #333; color: white; font-weight: 700;">
                                    <th style="padding: 5px; border: 1px solid #333; width: 50px; font-size: 10px;">ë‚ ì§œ</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 60px; font-size: 10px;">í’ˆëª©</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 40px; font-size: 10px;">ìˆ˜ëŸ‰</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 60px; font-size: 10px;">ë‹¨ê°€</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 70px; font-size: 10px;">ê³µê¸‰ê°€ì•¡</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 60px; font-size: 10px;">ì„¸ì•¡</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 50px; font-size: 10px;">ë¹„ê³ </th>
                                </tr>
                            </thead>
                            <tbody>
                                ${monthlyOrders.map(order => {
                                    return order.items.map((item, index) => {
                                        const itemVat = Math.round(item.quantity * item.price * 0.1);
                                        const shortName = item.name.replace('ë„ì‹œë½', '');
                                        const dateStr = order.date.substring(5).replace('-', '/').replace(/^0/, '').replace('/0', '/');
                                        return `
                                            <tr>
                                                ${index === 0 ? `<td rowspan="${order.items.length}" style="padding: 3px 4px; border: 1px solid #ddd; text-align: center; vertical-align: middle; font-size: 10px;">${dateStr}</td>` : ""}
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: center; font-size: 10px;">${shortName}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: center; font-size: 10px;">${item.quantity}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: right; font-size: 10px;">${item.price.toLocaleString()}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: right; font-size: 10px; font-weight: 600;">${(item.quantity * item.price).toLocaleString()}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: right; font-size: 10px;">${itemVat.toLocaleString()}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; font-size: 10px;"></td>
                                            </tr>
                                        `;
                                    }).join('');
                                }).join('')}
                                
                                <tr>
                                    <td colspan="4" style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: center; font-weight: 700;">í•© ê³„</td>
                                    <td style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: right; font-weight: 700; color: #ff6b35;">${totalAmount.toLocaleString()}</td>
                                    <td style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: right; font-weight: 700; color: #ff6b35;">${vat.toLocaleString()}</td>
                                    <td style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333;"></td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="padding: 12px; border: 1px solid #ddd; text-align: center; font-weight: 700; font-size: 15px;">ì´ ê¸ˆì•¡</td>
                                    <td colspan="3" style="padding: 12px; border: 1px solid #ddd; text-align: right; font-weight: 700; font-size: 17px; color: #ff6b35;">${totalWithVat.toLocaleString()}ì›</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="padding: 0 16px 16px 16px;">
                        <div style="background: #f9f9f9; padding: 12px; border-radius: 8px; border: 1px solid #ddd;">
                            <div style="font-size: 12px; font-weight: 600; color: #666; margin-bottom: 8px;">ğŸ“Š ë©”ë‰´ë³„ í•©ê³„ (ì°¸ê³ )</div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; font-size: 11px; color: #666;">
                                ${Object.keys(menuTotals).filter(menu => menuTotals[menu].quantity > 0).map(menu => {
                                    const shortName = menuNames[menu].replace('ë„ì‹œë½', '');
                                    return `<div>${shortName}: ${menuTotals[menu].quantity}ê°œ (${menuTotals[menu].amount.toLocaleString()}ì›)</div>`;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 0 16px 16px 16px;">
                        <div style="background: #fff3f0; padding: 12px; border-radius: 8px; border: 1px solid #ff6b35;">
                            <div style="font-size: 12px; font-weight: 600; color: #ff6b35; margin-bottom: 8px;">ğŸ’µ ê³„ì•½ ë‹¨ê°€ (ë¶€ê°€ì„¸ ë³„ë„)</div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; font-size: 11px; color: #666;">
                                <div>ğŸ± ë³´ì˜¨: ${contractPrices.warm.toLocaleString()}ì›</div>
                                <div>ğŸ¥— ìƒëŸ¬ë“œ: ${contractPrices.salad.toLocaleString()}ì›</div>
                                <div>ğŸ½ï¸ ì¼í’ˆ: ${contractPrices.ilpoom.toLocaleString()}ì›</div>
                                <div>ğŸ”¥ ë°œì—´: ${contractPrices.heating.toLocaleString()}ì›</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('statementContent').innerHTML = content;
            
            // ìŠ¹ì¸ ìƒíƒœ í™•ì¸ ë° ë²„íŠ¼ ìƒì„±
            updateStatementActions();
        }
        
        function updateStatementActions() {
            console.log('=== updateStatementActions ì‹œì‘ ===');
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${currentMonth}`;
            
            console.log('í˜„ì¬ ì›”:', currentMonth, 'ë…„:', currentYear);
            console.log('statementKey:', statementKey);
            
            // ìŠ¹ì¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            const isApproved = approvedStatements[currentCompany.phone]?.[statementKey]?.approved || false;
            const approvedDate = approvedStatements[currentCompany.phone]?.[statementKey]?.date || null;
            
            console.log('isAdmin:', isAdmin);
            console.log('isApproved:', isApproved);
            console.log('approvedDate:', approvedDate);
            
            const statusBanner = document.getElementById('statementStatusBanner');
            const actionsDiv = document.getElementById('statementActions');
            
            console.log('statusBanner ìš”ì†Œ:', statusBanner);
            console.log('actionsDiv ìš”ì†Œ:', actionsDiv);
            
            if (isAdmin) {
                // ê´€ë¦¬ì: ìŠ¹ì¸ ì „/í›„ ë²„íŠ¼
                if (isApproved) {
                    statusBanner.innerHTML = `
                        <div style="background: #d1fae5; border: 2px solid #10b981; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; align-items: center; gap: 8px; color: #065f46; font-weight: 600;">
                                <span style="font-size: 20px;">âœ…</span>
                                <div>
                                    <div>ìŠ¹ì¸ëœ ê±°ë˜ëª…ì„¸ì„œ</div>
                                    <div style="font-size: 12px; font-weight: 400; margin-top: 4px;">ìŠ¹ì¸ì¼: ${approvedDate}</div>
                                </div>
                            </div>
                        </div>
                    `;
                    actionsDiv.innerHTML = `
                        <button onclick="unapproveStatement()" style="flex: 1; background: #dc2626; color: #ffffff; border: none; padding: 16px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            âŒ ìŠ¹ì¸ ì·¨ì†Œ
                        </button>
                        <button onclick="downloadStatementExcel()" style="flex: 1; background: #22c55e; color: #ffffff; border: none; padding: 16px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
                        </button>
                    `;
                } else {
                    statusBanner.innerHTML = `
                        <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; align-items: center; gap: 8px; color: #92400e; font-weight: 600;">
                                <span style="font-size: 20px;">â³</span>
                                <div>ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ - ë‚´ìš© í™•ì¸ í›„ ìŠ¹ì¸í•´ì£¼ì„¸ìš”</div>
                            </div>
                        </div>
                    `;
                    actionsDiv.innerHTML = `
                        <button onclick="console.log('ë²„íŠ¼ í´ë¦­ë¨!'); approveStatement();" style="flex: 1; background: #3b82f6; color: #ffffff; border: none; padding: 16px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            âœ… ê±°ë˜ëª…ì„¸ì„œ ìŠ¹ì¸
                        </button>
                    `;
                }
            } else {
                // ê³ ê°: ìŠ¹ì¸ ì „/í›„ ë‹¤ë¥¸ UI
                if (isApproved) {
                    statusBanner.innerHTML = `
                        <div style="background: #d1fae5; border: 2px solid #10b981; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; align-items: center; gap: 8px; color: #065f46; font-weight: 600;">
                                <span style="font-size: 20px;">âœ…</span>
                                <div>
                                    <div>ìŠ¹ì¸ëœ ê±°ë˜ëª…ì„¸ì„œ</div>
                                    <div style="font-size: 12px; font-weight: 400; margin-top: 4px;">ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‚¬ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                                </div>
                            </div>
                        </div>
                    `;
                    actionsDiv.innerHTML = `
                        <button onclick="downloadStatementExcel()" style="flex: 1; background: #22c55e; color: #ffffff; border: none; padding: 16px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
                        </button>
                    `;
                } else {
                    statusBanner.innerHTML = `
                        <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; align-items: center; gap: 8px; color: #92400e; font-weight: 600;">
                                <span style="font-size: 20px;">â³</span>
                                <div>
                                    <div>ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ì¤‘</div>
                                    <div style="font-size: 12px; font-weight: 400; margin-top: 4px;">ê´€ë¦¬ì ìŠ¹ì¸ í›„ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤</div>
                                </div>
                            </div>
                        </div>
                    `;
                    actionsDiv.innerHTML = `
                        <div style="flex: 1; background: #f3f4f6; color: #9ca3af; border: 2px dashed #d1d5db; padding: 16px; border-radius: 12px; text-align: center; font-size: 16px; font-weight: 600;">
                            ğŸ”’ ìŠ¹ì¸ ëŒ€ê¸° ì¤‘
                        </div>
                    `;
                }
            }
        }
        
        window.approveStatement = function approveStatement() {
            if (!confirm('ì´ ê±°ë˜ëª…ì„¸ì„œë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nìŠ¹ì¸ í›„ ê³ ê°ì´ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {
                return;
            }
            
            console.log('ìŠ¹ì¸ ì‹œì‘ - currentCompany:', currentCompany);
            console.log('ìŠ¹ì¸ ì‹œì‘ - isAdmin:', isAdmin);
            
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${currentMonth}`;
            
            console.log('ìŠ¹ì¸ í‚¤:', statementKey);
            
            let approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            
            if (!approvedStatements[currentCompany.phone]) {
                approvedStatements[currentCompany.phone] = {};
            }
            
            approvedStatements[currentCompany.phone][statementKey] = {
                approved: true,
                date: new Date().toLocaleDateString("ko-KR")
            };
            
            // localStorageì— ì €ì¥
            localStorage.setItem('approvedStatements', JSON.stringify(approvedStatements));
            
            // ì €ì¥ í™•ì¸
            const savedData = JSON.parse(localStorage.getItem('approvedStatements'));
            console.log('ì €ì¥ í›„ í™•ì¸:', savedData);
            console.log('ì €ì¥ëœ ìŠ¹ì¸ ìƒíƒœ:', savedData[currentCompany.phone]?.[statementKey]);
            
            // í™”ë©´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
            console.log('updateStatementActions í˜¸ì¶œ ì „');
            updateStatementActions();
            console.log('updateStatementActions í˜¸ì¶œ í›„');
            
            // ì„±ê³µ ë©”ì‹œì§€
            showSuccessMessage('âœ… ê±°ë˜ëª…ì„¸ì„œê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        window.unapproveStatement = function unapproveStatement() {
            if (!confirm('ìŠ¹ì¸ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${currentMonth}`;
            
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            
            if (approvedStatements[currentCompany.phone]?.[statementKey]) {
                delete approvedStatements[currentCompany.phone][statementKey];
                localStorage.setItem('approvedStatements', JSON.stringify(approvedStatements));
            }
            
            // í™”ë©´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
            updateStatementActions();
            
            // ì„±ê³µ ë©”ì‹œì§€
            showSuccessMessage('âŒ ìŠ¹ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // ê±°ë˜ëª…ì„¸ì„œ íƒ­ ì „í™˜
        function switchStatementMode(mode) {
            const monthlyBtn = document.getElementById('monthlyTabBtn');
            const customBtn = document.getElementById('customTabBtn');
            const customDateRange = document.getElementById('customDateRange');
            
            if (mode === 'monthly') {
                // ì´ë²ˆ ë‹¬ íƒ­
                monthlyBtn.style.background = 'linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)';
                monthlyBtn.style.color = 'white';
                customBtn.style.background = '#f5f5f5';
                customBtn.style.color = '#666';
                customDateRange.style.display = 'none';
                
                // ì´ë²ˆ ë‹¬ ê±°ë˜ëª…ì„¸ì„œ ìƒì„±
                generateMonthlyStatement();
            } else {
                // ê¸°ê°„ ì„ íƒ íƒ­
                monthlyBtn.style.background = '#f5f5f5';
                monthlyBtn.style.color = '#666';
                customBtn.style.background = 'linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)';
                customBtn.style.color = 'white';
                customDateRange.style.display = 'block';
                
                // ê¸°ë³¸ ë‚ ì§œ ì„¤ì • (ì´ë²ˆ ë‹¬ 1ì¼ ~ ë§ì¼)
                const today = new Date();
                const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
                const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                
                document.getElementById('statementStartDate').value = firstDay.toISOString().split('T')[0];
                document.getElementById('statementEndDate').value = lastDay.toISOString().split('T')[0];
            }
        }
        
        // ê¸°ê°„ë³„ ê±°ë˜ëª…ì„¸ì„œ ìƒì„±
        function generateCustomStatement() {
            const startDate = document.getElementById('statementStartDate').value;
            const endDate = document.getElementById('statementEndDate').value;
            
            if (!startDate || !endDate) {
                alert('ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (new Date(startDate) > new Date(endDate)) {
                alert('ì‹œì‘ì¼ì´ ì¢…ë£Œì¼ë³´ë‹¤ ëŠ¦ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ê¸°ê°„ ë‚´ ì£¼ë¬¸ í•„í„°ë§
            const customOrders = userOrders.filter(order => {
                const orderDate = new Date(order.date);
                const start = new Date(startDate);
                const end = new Date(endDate);
                end.setHours(23, 59, 59, 999); // ì¢…ë£Œì¼ ë§ˆì§€ë§‰ ì‹œê°„ê¹Œì§€ í¬í•¨
                return orderDate >= start && orderDate <= end;
            });
            
            if (customOrders.length === 0) {
                document.getElementById('statementContent').innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“„</div>
                        <div style="font-size: 16px;">ì„ íƒí•œ ê¸°ê°„ì— ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</div>
                    </div>
                `;
                document.getElementById('statementActions').innerHTML = '';
                document.getElementById('statementStatusBanner').innerHTML = '';
                return;
            }
            
            // ë©”ë‰´ë³„ í•©ê³„ ê³„ì‚°
            const menuTotals = {
                warm: { quantity: 0, amount: 0 },
                salad: { quantity: 0, amount: 0 },
                ilpoom: { quantity: 0, amount: 0 },
                heating: { quantity: 0, amount: 0 }
            };
            
            let totalAmount = 0;
            
            customOrders.forEach(order => {
                order.items.forEach(item => {
                    if (menuTotals[item.type]) {
                        menuTotals[item.type].quantity += item.quantity;
                        menuTotals[item.type].amount += item.quantity * item.price;
                    }
                });
                totalAmount += order.total;
            });
            
            const vat = Math.round(totalAmount * 0.1);
            const totalWithVat = totalAmount + vat;
            const contractPrices = currentCompany.prices || defaultPrices;
            const today = new Date();
            
            const content = `
                <div style="background: white; border: 2px solid #333; padding: 0;">
                    <div style="text-align: center; padding: 20px; background: #f5f5f5; border-bottom: 2px solid #333;">
                        <h2 style="font-size: 28px; font-weight: 700; color: #333; margin: 0;">ê±° ë˜ ëª… ì„¸ ì„œ</h2>
                        <div style="font-size: 14px; color: #666; margin-top: 8px;">${startDate} ~ ${endDate}</div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 2fr; border-bottom: 1px solid #333;">
                        <div style="padding: 12px; border-right: 1px solid #333;">
                            <div style="font-size: 12px; font-weight: 700; color: #333; margin-bottom: 8px; padding-bottom: 4px; border-bottom: 2px solid #666;">ê³µê¸‰ë°›ëŠ”ì</div>
                            <div style="padding: 20px 0; text-align: center;">
                                <div style="font-size: 16px; font-weight: 700; color: #333;">
                                    ${currentCompany?.company || currentCompany?.name || "ê³ ê°"} ê·€í•˜
                                </div>
                            </div>
                        </div>
                        
                        <div style="padding: 12px;">
                            <div style="font-size: 12px; font-weight: 700; color: #333; margin-bottom: 8px; padding-bottom: 4px; border-bottom: 2px solid #666;">ê³µê¸‰ì</div>
                            <div style="font-size: 10px; line-height: 1.6; color: #333;">
                                <div><strong>ë“±ë¡ë²ˆí˜¸:</strong> 447-86-02287</div>
                                <div><strong>ìƒí˜¸(ë²•ì¸ëª…):</strong> ì£¼ì‹íšŒì‚¬ ê°€ì´ì˜¤í‘¸ë“œ</div>
                                <div><strong>ëŒ€í‘œì:</strong> ê¹€ì§„</div>
                                <div><strong>ì‚¬ì—…ì¥ì£¼ì†Œ:</strong> ë¶€ì‚° ì—°ì œêµ¬ ì¤‘ì•™ëŒ€ë¡œ 1060-1</div>
                                <div><strong>ì—…íƒœ/ì¢…ëª©:</strong> ìŒì‹ / í•œì‹, ë„ì‹œë½</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 12px 20px; background: #f9f9f9; border-bottom: 1px solid #333; text-align: right; font-size: 12px;">
                        <strong>ë°œí–‰ì¼:</strong> ${today.toLocaleDateString("ko-KR")}
                    </div>
                    
                    <div style="padding: 16px; overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 10px;">
                            <thead>
                                <tr style="background: #333; color: white; font-weight: 700;">
                                    <th style="padding: 5px; border: 1px solid #333; width: 50px; font-size: 10px;">ë‚ ì§œ</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 60px; font-size: 10px;">í’ˆëª©</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 40px; font-size: 10px;">ìˆ˜ëŸ‰</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 60px; font-size: 10px;">ë‹¨ê°€</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 70px; font-size: 10px;">ê³µê¸‰ê°€ì•¡</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 60px; font-size: 10px;">ì„¸ì•¡</th>
                                    <th style="padding: 5px; border: 1px solid #333; width: 50px; font-size: 10px;">ë¹„ê³ </th>
                                </tr>
                            </thead>
                            <tbody>
                                ${customOrders.map(order => {
                                    return order.items.map((item, index) => {
                                        const itemVat = Math.round(item.quantity * item.price * 0.1);
                                        const shortName = item.name.replace('ë„ì‹œë½', '');
                                        const dateStr = order.date.substring(5).replace('-', '/').replace(/^0/, '').replace('/0', '/');
                                        return `
                                            <tr>
                                                ${index === 0 ? `<td rowspan="${order.items.length}" style="padding: 3px 4px; border: 1px solid #ddd; text-align: center; vertical-align: middle; font-size: 10px;">${dateStr}</td>` : ""}
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: center; font-size: 10px;">${shortName}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: center; font-size: 10px;">${item.quantity}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: right; font-size: 10px;">${item.price.toLocaleString()}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: right; font-size: 10px; font-weight: 600;">${(item.quantity * item.price).toLocaleString()}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; text-align: right; font-size: 10px;">${itemVat.toLocaleString()}</td>
                                                <td style="padding: 3px 4px; border: 1px solid #ddd; font-size: 10px;"></td>
                                            </tr>
                                        `;
                                    }).join('');
                                }).join('')}
                                
                                <tr>
                                    <td colspan="4" style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: center; font-weight: 700;">í•© ê³„</td>
                                    <td style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: right; font-weight: 700; color: #ff6b35;">${totalAmount.toLocaleString()}</td>
                                    <td style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: right; font-weight: 700; color: #ff6b35;">${vat.toLocaleString()}</td>
                                    <td style="padding: 10px; border: 1px solid #ddd; border-top: 2px solid #333;"></td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="padding: 12px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: center; font-weight: 700; font-size: 14px; background: #f9f9f9;">ì´ ê¸ˆ ì•¡</td>
                                    <td colspan="3" style="padding: 12px; border: 1px solid #ddd; border-top: 2px solid #333; text-align: right; font-weight: 700; font-size: 16px; color: #ff6b35; background: #fff3f0;">${totalWithVat.toLocaleString()}ì›</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="padding: 0 16px 16px 16px;">
                        <div style="background: #f9f9f9; padding: 12px; border-radius: 8px; border: 1px solid #ddd;">
                            <div style="font-size: 12px; font-weight: 600; color: #666; margin-bottom: 8px;">ğŸ“Š ë©”ë‰´ë³„ í•©ê³„ (ì°¸ê³ )</div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; font-size: 11px; color: #666;">
                                ${Object.keys(menuTotals).filter(menu => menuTotals[menu].quantity > 0).map(menu => {
                                    const shortName = menuNames[menu].replace('ë„ì‹œë½', '');
                                    return `<div>${shortName}: ${menuTotals[menu].quantity}ê°œ (${menuTotals[menu].amount.toLocaleString()}ì›)</div>`;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 0 16px 16px 16px;">
                        <div style="background: #fff3f0; padding: 12px; border-radius: 8px; border: 1px solid #ff6b35;">
                            <div style="font-size: 12px; font-weight: 600; color: #ff6b35; margin-bottom: 8px;">ğŸ’µ ê³„ì•½ ë‹¨ê°€ (ë¶€ê°€ì„¸ ë³„ë„)</div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; font-size: 11px; color: #666;">
                                <div>ğŸ± ë³´ì˜¨: ${contractPrices.warm.toLocaleString()}ì›</div>
                                <div>ğŸ¥— ìƒëŸ¬ë“œ: ${contractPrices.salad.toLocaleString()}ì›</div>
                                <div>ğŸ½ï¸ ì¼í’ˆ: ${contractPrices.ilpoom.toLocaleString()}ì›</div>
                                <div>ğŸ”¥ ë°œì—´: ${contractPrices.heating.toLocaleString()}ì›</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('statementContent').innerHTML = content;
            
            // ê¸°ê°„ë³„ ì¡°íšŒëŠ” ìŠ¹ì¸ ê¸°ëŠ¥ ì—†ì´ ë‹¤ìš´ë¡œë“œë§Œ ê°€ëŠ¥
            document.getElementById('statementStatusBanner').innerHTML = `
                <div style="background: #e0f2fe; border: 2px solid #0ea5e9; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                    <div style="display: flex; align-items: center; gap: 8px; color: #075985; font-weight: 600;">
                        <span style="font-size: 20px;">ğŸ“…</span>
                        <div>ê¸°ê°„ë³„ ê±°ë˜ëª…ì„¸ì„œ (${startDate} ~ ${endDate})</div>
                    </div>
                </div>
            `;
            
            const btn = document.createElement('button');
            btn.style.cssText = 'flex: 1; background: #22c55e; color: #ffffff; border: none; padding: 16px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600;';
            btn.innerHTML = 'ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ';
            btn.onclick = () => downloadCustomStatement(startDate, endDate);
            
            const actionsDiv = document.getElementById('statementActions');
            actionsDiv.innerHTML = '';
            actionsDiv.appendChild(btn);
        }
        
        // ê¸°ê°„ë³„ ê±°ë˜ëª…ì„¸ì„œ ë‹¤ìš´ë¡œë“œ
        function downloadCustomStatement(startDate, endDate) {
            // ì´ í•¨ìˆ˜ëŠ” downloadStatementExcelê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ë‚ ì§œ í•„í„°ê°€ ë‹¤ë¦„
            // ê°„ë‹¨í•˜ê²Œ ê¸°ì¡´ í•¨ìˆ˜ ì¬ì‚¬ìš©
            downloadStatementExcel();
        }
        
        
        function showSuccessMessage(message) {
            // ê¸°ì¡´ ë©”ì‹œì§€ê°€ ìˆìœ¼ë©´ ì œê±°
            const existingMsg = document.getElementById('successMessage');
            if (existingMsg) {
                existingMsg.remove();
            }
            
            // ì„±ê³µ ë©”ì‹œì§€ ìƒì„±
            const msgDiv = document.createElement('div');
            msgDiv.id = 'successMessage';
            msgDiv.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4);
                font-size: 16px;
                font-weight: 600;
                z-index: 10000;
                animation: slideDown 0.3s ease-out;
            `;
            msgDiv.textContent = message;
            
            document.body.appendChild(msgDiv);
            
            // 3ì´ˆ í›„ ìë™ ì œê±°
            setTimeout(() => {
                msgDiv.style.animation = 'slideUp 0.3s ease-out';
                setTimeout(() => msgDiv.remove(), 300);
            }, 3000);
        }

        function downloadStatementExcel() {
            if (!currentCompany) return;
            
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            
            const monthlyOrders = userOrders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate.getMonth() + 1 === currentMonth && 
                       orderDate.getFullYear() === currentYear;
            });
            
            if (monthlyOrders.length === 0) {
                alert('ì´ë²ˆ ë‹¬ ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë©”ë‰´ë³„ í•©ê³„
            const menuTotals = {
                warm: { quantity: 0, amount: 0 },
                salad: { quantity: 0, amount: 0 },
                ilpoom: { quantity: 0, amount: 0 },
                heating: { quantity: 0, amount: 0 }
            };
            
            let totalAmount = 0;
            
            monthlyOrders.forEach(order => {
                order.items.forEach(item => {
                    if (menuTotals[item.type]) {
                        menuTotals[item.type].quantity += item.quantity;
                        menuTotals[item.type].amount += item.quantity * item.price;
                    }
                });
                totalAmount += order.total;
            });
            
            const vat = Math.round(totalAmount * 0.1);
            const totalWithVat = totalAmount + vat;
            const contractPrices = currentCompany.prices || defaultPrices;
            
            let excelContent = `
                <table border="1" style="border-collapse: collapse; width: 100%;">
                    <tr style="background-color: #ffffff;">
                        <td colspan="7" style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border: 1px solid #000;">ê±° ë˜ ëª… ì„¸ ì„œ</td>
                    </tr>
                    
                    <tr>
                        <td colspan="2" style="padding: 6px 8px; font-weight: bold; background-color: #f5f5f5; border: 1px solid #000; text-align: center;">ê³µê¸‰ë°›ëŠ”ì</td>
                        <td colspan="5" style="padding: 6px 8px; font-weight: bold; background-color: #f5f5f5; border: 1px solid #000; text-align: center;">ê³µê¸‰ì</td>
                    </tr>
                    <tr>
                        <td colspan="2" rowspan="5" style="padding: 20px 8px; text-align: center; vertical-align: middle; font-weight: bold; font-size: 14px; border: 1px solid #000;">${currentCompany?.company || currentCompany?.name || "ê³ ê°"} ê·€í•˜</td>
                        <td colspan="5" style="padding: 4px 8px; border: 1px solid #000; font-size: 11px;">ë“±ë¡ë²ˆí˜¸: 447-86-02287</td>
                    </tr>
                    <tr>
                        <td colspan="5" style="padding: 4px 8px; border: 1px solid #000; font-size: 11px;">ìƒí˜¸(ë²•ì¸ëª…): ì£¼ì‹íšŒì‚¬ ê°€ì´ì˜¤í‘¸ë“œ</td>
                    </tr>
                    <tr>
                        <td colspan="5" style="padding: 4px 8px; border: 1px solid #000; font-size: 11px;">ëŒ€í‘œì: ê¹€ì§„</td>
                    </tr>
                    <tr>
                        <td colspan="5" style="padding: 4px 8px; border: 1px solid #000; font-size: 11px;">ì‚¬ì—…ì¥ì£¼ì†Œ: ë¶€ì‚° ì—°ì œêµ¬ ì¤‘ì•™ëŒ€ë¡œ 1060-1</td>
                    </tr>
                    <tr>
                        <td colspan="5" style="padding: 4px 8px; border: 1px solid #000; font-size: 11px;">ì—…íƒœ/ì¢…ëª©: ìŒì‹ / í•œì‹, ë„ì‹œë½</td>
                    </tr>
                    
                    <tr>
                        <td colspan="7" style="padding: 6px 8px; text-align: right; background-color: #f9f9f9; border: 1px solid #000; font-size: 11px;">
                            ì‘ì„±ì¼ì: ${currentYear}ë…„ ${currentMonth}ì›” (ë°œí–‰ì¼: ${today.toLocaleDateString("ko-KR")})
                        </td>
                    </tr>
                    
                    <tr style="background-color: #333333; color: #ffffff; font-weight: bold;">
                        <td style="padding: 6px 4px; text-align: center; border: 1px solid #000; font-size: 11px;">ë‚ ì§œ</td>
                        <td style="padding: 6px 4px; text-align: center; border: 1px solid #000; font-size: 11px;">í’ˆëª©</td>
                        <td style="padding: 6px 4px; text-align: center; border: 1px solid #000; font-size: 11px;">ìˆ˜ëŸ‰</td>
                        <td style="padding: 6px 4px; text-align: center; border: 1px solid #000; font-size: 11px;">ë‹¨ê°€</td>
                        <td style="padding: 6px 4px; text-align: center; border: 1px solid #000; font-size: 11px;">ê³µê¸‰ê°€ì•¡</td>
                        <td style="padding: 6px 4px; text-align: center; border: 1px solid #000; font-size: 11px;">ì„¸ì•¡</td>
                        <td style="padding: 6px 4px; text-align: center; border: 1px solid #000; font-size: 11px;">ë¹„ê³ </td>
                    </tr>
                    
                    ${monthlyOrders.map(order => {
                        const dateStr = order.date.substring(5).replace('-', '/').replace(/^0/, '').replace('/0', '/');
                        const itemsText = order.items.map(item => item.name.replace('ë„ì‹œë½', '')).join(', ');
                        const totalQty = order.items.reduce((sum, item) => sum + item.quantity, 0);
                        const orderVat = Math.round(order.total * 0.1);
                        
                        return `
                            <tr>
                                <td style="padding: 4px; text-align: center; border: 1px solid #000; font-size: 10px;">${dateStr}</td>
                                <td style="padding: 4px; text-align: center; border: 1px solid #000; font-size: 10px;">${itemsText}</td>
                                <td style="padding: 4px; text-align: center; border: 1px solid #000; font-size: 10px;">${totalQty}</td>
                                <td style="padding: 4px; text-align: right; border: 1px solid #000; font-size: 10px;">-</td>
                                <td style="padding: 4px; text-align: right; border: 1px solid #000; font-size: 10px; font-weight: bold;">${order.total.toLocaleString()}</td>
                                <td style="padding: 4px; text-align: right; border: 1px solid #000; font-size: 10px;">${orderVat.toLocaleString()}</td>
                                <td style="padding: 4px; border: 1px solid #000; font-size: 10px;"></td>
                            </tr>
                        `;
                    }).join('')}
                    
                    <tr style="font-weight: bold;">
                        <td colspan="4" style="padding: 8px; text-align: center; border: 1px solid #000; font-size: 12px;">í•© ê³„</td>
                        <td style="padding: 8px; text-align: right; border: 1px solid #000; font-size: 11px;">${totalAmount.toLocaleString()}</td>
                        <td style="padding: 8px; text-align: right; border: 1px solid #000; font-size: 11px;">${vat.toLocaleString()}</td>
                        <td style="padding: 8px; border: 1px solid #000;"></td>
                    </tr>
                    <tr style="font-weight: bold;">
                        <td colspan="4" style="padding: 10px; text-align: center; border: 1px solid #000; font-size: 13px;">ì´ ê¸ˆ ì•¡</td>
                        <td colspan="3" style="padding: 10px; text-align: right; border: 1px solid #000; font-size: 14px; color: #ff6b35;">${totalWithVat.toLocaleString()}ì›</td>
                    </tr>
                </table>
            `;
            
            const htmlContent = `<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <meta name="ProgId" content="Excel.Sheet">
                    <meta name="Generator" content="Microsoft Excel 15">
                    <style>
                        table { border-collapse: collapse; }
                        th, td { border: 1px solid #ccc; padding: 5px; }
                    </style>
                    <meta property="og:title" content="ì§„ë‹´ë„ì‹œë½ - ì˜¨ë¼ì¸ ì£¼ë¬¸">
    <meta property="og:description" content="ê±´ê°•í•˜ê³  ë§›ìˆëŠ” í•œì‹ ë„ì‹œë½ì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì£¼ë¬¸í•˜ì„¸ìš”!">
    <meta property="og:type" content="website">
</head>
                <body>${excelContent}</body>
                </html>`;
            
            const blob = new Blob(['\ufeff' + htmlContent], { 
                type: 'application/vnd.ms-excel;charset=utf-8;' 
            });
            
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `${currentCompany.company}_ê±°ë˜ëª…ì„¸ì„œ_${currentYear}ë…„${currentMonth}ì›”.xls`);
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function hideAllPages() {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        }

        function generateCalendar() {
            const calendarDays = document.getElementById('calendarDays');
            const calendarHeader = document.getElementById('calendarHeader');
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const year = currentDisplayMonth.getFullYear();
            const month = currentDisplayMonth.getMonth();
            
            calendarHeader.textContent = `${year}ë…„ ${month + 1}ì›”`;
            
            const firstDay = new Date(year, month, 1);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            calendarDays.innerHTML = '';

            for (let i = 0; i < 42; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = currentDate.getDate();
                
                const isToday = currentDate.toDateString() === today.toDateString();
                const isPast = currentDate < today && !isToday;
                const isCurrentMonth = currentDate.getMonth() === month;
                const canOrder = canOrderForDate(currentDate);
                
                // í•´ë‹¹ ë‚ ì§œì— ì£¼ë¬¸ì´ ìˆëŠ”ì§€ í™•ì¸ (ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ)
                let hasOrder = false;
                if (currentCompany && currentCompany.phone) {
                    const dateStr = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, "0")}-${String(currentDate.getDate()).padStart(2, "0")}`;
                    hasOrder = userOrders.some(order => 
                        order.date === dateStr && 
                        order.customer.phone === currentCompany.phone &&
                        order.status === 'pending'
                    );
                }
                
                if (!isCurrentMonth) {
                    // í‘œì‹œ ì¤‘ì¸ ì›”ì´ ì•„ë‹Œ ë‚ ì§œë“¤
                    dayElement.style.color = '#ddd';  // ì—°í•˜ê²Œ í‘œì‹œ
                    if (!isPast && canOrder) {
                        // ë¯¸ë˜ ë‚ ì§œë©´ ì„ íƒ ê°€ëŠ¥
                        dayElement.onclick = () => selectDate(currentDate);
                    } else {
                        dayElement.classList.add('disabled');
                    }
                } else if (isPast || !canOrder) {
                    dayElement.classList.add('disabled');
                    if (!isPast && !canOrder) {
                        dayElement.title = 'ì£¼ë¬¸ ë§ˆê°ëœ ë‚ ì§œì…ë‹ˆë‹¤ (í•˜ë£¨ ì „ ì˜¤í›„ 6ì‹œ ë§ˆê°)';
                        dayElement.style.backgroundColor = '#ffe6e6';
                        dayElement.style.color = '#d63384';
                    }
                } else {
                    if (isToday) dayElement.classList.add('today');
                    
                    // ì£¼ë¬¸ì´ ìˆëŠ” ë‚ ì§œ í‘œì‹œ
                    if (hasOrder) {
                        dayElement.style.backgroundColor = '#d4edda';
                        dayElement.style.color = '#155724';
                        dayElement.style.fontWeight = '700';
                        dayElement.title = 'ì´ë¯¸ ì£¼ë¬¸í•œ ë‚ ì§œì…ë‹ˆë‹¤ (ì£¼ë¬¸ë‚´ì—­ì—ì„œ ìˆ˜ì • ê°€ëŠ¥)';
                        dayElement.innerHTML = `${currentDate.getDate()}<div style="font-size: 10px; margin-top: 2px;">âœ“</div>`;
                    }
                    
                    dayElement.onclick = () => selectDate(currentDate);
                }
                
                calendarDays.appendChild(dayElement);
            }
        }
        
        // ì›” ì „í™˜ í•¨ìˆ˜
        function changeMonth(direction) {
            currentDisplayMonth.setMonth(currentDisplayMonth.getMonth() + direction);
            generateCalendar();
        }

        function selectDate(date) {
            if (!canOrderForDate(date)) {
                alert('ì„ íƒí•˜ì‹  ë‚ ì§œëŠ” ì£¼ë¬¸ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.\nì£¼ë¬¸/ìˆ˜ì •ì€ ë°°ì†¡ì¼ í•˜ë£¨ ì „ ì˜¤í›„ 6ì‹œê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            document.querySelectorAll('.calendar-day').forEach(day => day.classList.remove('selected'));
            event.target.classList.add('selected');
            
            // UTC ì‹œê°„ëŒ€ ë¬¸ì œ í•´ê²°: ë¡œì»¬ ë‚ ì§œ ê·¸ëŒ€ë¡œ ì‚¬ìš©
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, "0");
            const day = String(date.getDate()).padStart(2, "0");
            selectedDate = `${year}-${month}-${day}`;
            
            document.getElementById('selectedDateText').textContent = 
                `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
            
            // ê°™ì€ ë‚  ê¸°ì¡´ ì£¼ë¬¸ ì²´í¬ (ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ)
            if (currentCompany && currentCompany.phone) {
                const existingOrder = userOrders.find(order => 
                    order.date === selectedDate && 
                    order.customer.phone === currentCompany.phone &&
                    order.status === 'pending'
                );
                
                if (existingOrder) {
                    showValidationError(`âš ï¸ ${selectedDate} ë‚ ì§œì— ì´ë¯¸ ì£¼ë¬¸ì´ ìˆìŠµë‹ˆë‹¤.\n\nìˆ˜ì •í•˜ì‹œë ¤ë©´:\nâ˜° ë©”ë‰´ â†’ ì£¼ë¬¸ë‚´ì—­ â†’ í•´ë‹¹ ì£¼ë¬¸ì˜ ìˆ˜ì • ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.`);
                    // ì„ íƒ í•´ì œ
                    event.target.classList.remove('selected');
                    selectedDate = null;
                    document.getElementById('selectedDateText').textContent = 'ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
                    return;
                }
            }
            
            updateMenuAvailability();
            
            // ë‚ ì§œ ë³€ê²½ ì‹œ ìˆ˜ëŸ‰ ì´ˆê¸°í™”
            quantities = {
                warm: 0,
                salad: 0,
                ilpoom: 0,
                heating: 0
            };
            
            // í™”ë©´ì˜ ìˆ˜ëŸ‰ í‘œì‹œë„ ì´ˆê¸°í™”
            document.querySelectorAll('.quantity').forEach(span => {
                span.textContent = '0';
            });
            
            console.log('ğŸ”„ ë‚ ì§œ ë³€ê²½: ìˆ˜ëŸ‰ ì´ˆê¸°í™”ë¨');
            
            updateOrderButton();
        }
        
        function updateMenuAvailability() {
            if (!selectedDate) return;
            
            const saladCanOrder = canOrderMenuForDate(selectedDate, 'salad');
            const ilpoomCanOrder = canOrderMenuForDate(selectedDate, 'ilpoom');
            
            const menuItems = document.querySelectorAll('.menu-item');
            // menuItems[0] = ë³´ì˜¨, [1] = ìƒëŸ¬ë“œ, [2] = ì¼í’ˆ, [3] = ë°œì—´
            
            // ìƒëŸ¬ë“œ ë©”ë‰´ (2ë²ˆì§¸ menu-item)
            if (menuItems[1]) {
                const saladButtons = menuItems[1].querySelectorAll('.qty-btn');
                saladButtons.forEach(btn => {
                    if (!saladCanOrder) {
                        btn.disabled = true;
                        btn.style.opacity = '0.3';
                        btn.style.cursor = 'not-allowed';
                    } else {
                        btn.disabled = false;
                        btn.style.opacity = '1';
                        btn.style.cursor = 'pointer';
                    }
                });
                
                if (!saladCanOrder) {
                    menuItems[1].style.opacity = '0.5';
                    menuItems[1].style.backgroundColor = '#f9f9f9';
                } else {
                    menuItems[1].style.opacity = '1';
                    menuItems[1].style.backgroundColor = '#ffffff';
                }
            }
            
            // ì¼í’ˆ ë©”ë‰´ (3ë²ˆì§¸ menu-item)
            if (menuItems[2]) {
                const ilpoomButtons = menuItems[2].querySelectorAll('.qty-btn');
                ilpoomButtons.forEach(btn => {
                    if (!ilpoomCanOrder) {
                        btn.disabled = true;
                        btn.style.opacity = '0.3';
                        btn.style.cursor = 'not-allowed';
                    } else {
                        btn.disabled = false;
                        btn.style.opacity = '1';
                        btn.style.cursor = 'pointer';
                    }
                });
                
                if (!ilpoomCanOrder) {
                    menuItems[2].style.opacity = '0.5';
                    menuItems[2].style.backgroundColor = '#f9f9f9';
                } else {
                    menuItems[2].style.opacity = '1';
                    menuItems[2].style.backgroundColor = '#ffffff';
                }
            }
        }

        function changeQuantity(menuType, change) {
            // ìƒëŸ¬ë“œ/ì¼í’ˆì€ ë‚ ì§œë³„ë¡œ ì£¼ë¬¸ ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬
            if ((menuType === 'salad' || menuType === 'ilpoom') && change > 0) {
                if (!selectedDate) {
                    alert('ë°°ì†¡ ë‚ ì§œë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                if (!canOrderMenuForDate(selectedDate, menuType)) {
                    alert('ìƒëŸ¬ë“œ/ì¼í’ˆ ë„ì‹œë½ì€ ë°°ì†¡ ì „ë‚  ì˜¤í›„ 6ì‹œê¹Œì§€ë§Œ ì£¼ë¬¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\në³´ì˜¨/ë°œì—´ ë„ì‹œë½ì„ ì„ íƒí•˜ì‹œê±°ë‚˜ ë‹¤ë¥¸ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
            }
            
            quantities[menuType] = Math.max(0, quantities[menuType] + change);
            document.getElementById(menuType + '-qty').textContent = quantities[menuType];
            updateTotal();
            updateOrderButton();
        }

        function updateTotal() {
            let total = 0;
            for (let menu in quantities) {
                total += quantities[menu] * prices[menu];
            }
            document.getElementById('totalAmount').textContent = total.toLocaleString() + 'ì›';
        }

        function updateOrderButton() {
            const btn = document.getElementById('orderBtn');
            const total = Object.values(quantities).reduce((sum, qty) => sum + qty, 0);
            const totalAmount = Object.keys(quantities).reduce((sum, menu) => sum + quantities[menu] * prices[menu], 0);
            
            if (total >= 2 && selectedDate) {
                btn.disabled = false;
                btn.textContent = `${totalAmount.toLocaleString()}ì› ë°”ë¡œ ì£¼ë¬¸í•˜ê¸°`;
            } else {
                btn.disabled = true;
                if (total < 2 && total > 0) {
                    btn.textContent = `ìµœì†Œ 2ê°œ ì´ìƒ ì£¼ë¬¸í•´ì£¼ì„¸ìš” (í˜„ì¬: ${total}ê°œ)`;
                } else if (!selectedDate && total >= 2) {
                    btn.textContent = 'ë°°ì†¡ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
                } else {
                    btn.textContent = 'ë©”ë‰´ 2ê°œ ì´ìƒê³¼ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
                }
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
                overlay.classList.remove('show');
            } else {
                sidebar.classList.add('open');
                overlay.classList.add('show');
            }
        }

        function showOrderModal() {
            console.log('ğŸ”µ ì£¼ë¬¸í•˜ê¸° ë²„íŠ¼ í´ë¦­ë¨');
            console.log('ì„ íƒëœ ë‚ ì§œ:', selectedDate);
            console.log('ì„ íƒëœ ìˆ˜ëŸ‰:', quantities);
            console.log('í˜„ì¬ ì—…ì²´:', currentCompany);
            
            if (validateOrder()) {
                document.getElementById('orderModal').classList.add('show');
            } else {
                console.log('âŒ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨');
            }
        }

        function hideOrderModal() {
            document.getElementById('orderModal').classList.remove('show');
        }

        function hideSuccessModal() {
            document.getElementById('successModal').classList.remove('show');
            resetOrder();
            
            // ì£¼ë¬¸ë‚´ì—­ í˜ì´ì§€ë¡œ ì´ë™
            setTimeout(() => {
                showOrderHistory();
            }, 300);
        }

        function validateOrder() {
            const contactPhone = document.getElementById('customerContactPhone').value.trim();
            const address = document.getElementById('customerAddress').value.trim();
            
            if (!contactPhone) {
                showValidationError('ë‹´ë‹¹ì ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                document.getElementById('customerContactPhone').focus();
                document.getElementById('customerContactPhone').style.border = '2px solid #ff6b35';
                setTimeout(() => {
                    document.getElementById('customerContactPhone').style.border = '1px solid #e0e0e0';
                }, 3000);
                return false;
            }
            
            if (!address) {
                showValidationError('ë°°ì†¡ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                document.getElementById('customerAddress').focus();
                document.getElementById('customerAddress').style.border = '2px solid #ff6b35';
                setTimeout(() => {
                    document.getElementById('customerAddress').style.border = '1px solid #e0e0e0';
                }, 3000);
                return false;
            }
            
            // ë‹´ë‹¹ì ì—°ë½ì²˜ê°€ ì €ì¥ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ìë™ ì €ì¥
            const savedContact = localStorage.getItem(`contactPhone_${currentCompany.phone}`);
            if (!savedContact && currentCompany && currentCompany.phone) {
                localStorage.setItem(`contactPhone_${currentCompany.phone}`, contactPhone);
            }


            
            if (!currentCompany) {
                showValidationError('ë¡œê·¸ì¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
                showCustomerTypePage();
                return false;
            }
            
            if (!selectedDate) {
                showValidationError('ë°°ì†¡ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return false;
            }

            if (!canOrderForDate(selectedDate)) {
                showValidationError('ì„ íƒí•˜ì‹  ë°°ì†¡ì¼ì€ ì£¼ë¬¸ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.');
                return false;
            }
            
            // ë©”ë‰´ë³„ ì£¼ë¬¸ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
            const orderedMenus = Object.keys(quantities).filter(menu => quantities[menu] > 0);
            for (let menu of orderedMenus) {
                if (!canOrderMenuForDate(selectedDate, menu)) {
                    const menuName = menuNames[menu];
                    showValidationError(`${menuName}ì€(ëŠ”) ë‹¹ì¼ ì£¼ë¬¸ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.\nì „ë‚  ì˜¤í›„ 6ì‹œê¹Œì§€ ì£¼ë¬¸í•´ì£¼ì„¸ìš”.`);
                    return false;
                }
            }
            
            const total = Object.values(quantities).reduce((sum, qty) => sum + qty, 0);
            
            if (total < 2) {
                showValidationError('ìµœì†Œ 2ê°œ ì´ìƒ ì£¼ë¬¸í•´ì£¼ì„¸ìš”. (í˜„ì¬: ' + total + 'ê°œ)');
                return false;
            }
            
            return true;
        }
        
        function showValidationError(message) {
            // ê¸°ì¡´ ì—ëŸ¬ ë©”ì‹œì§€ ì œê±°
            const existingError = document.querySelector('.validation-error');
            if (existingError) {
                existingError.remove();
            }
            
            // ìƒˆ ì—ëŸ¬ ë©”ì‹œì§€ ìƒì„±
            const errorDiv = document.createElement('div');
            errorDiv.className = 'validation-error';
            errorDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 24px 32px;
                border-radius: 16px;
                box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 400px;
                text-align: center;
            `;
            errorDiv.innerHTML = `
                <div style="font-size: 16px; color: #333; margin-bottom: 16px; white-space: pre-line;">${message}</div>
                <button onclick="this.parentElement.remove()" style="background: #ff6b35; color: #ffffff; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600;">í™•ì¸</button>
            `;
            document.body.appendChild(errorDiv);
            
            // 3ì´ˆ í›„ ìë™ ì œê±°
            setTimeout(() => {
                if (errorDiv.parentElement) {
                    errorDiv.remove();
                }
            }, 3000);
            
            // ë°°ê²½ ì–´ë‘¡ê²Œ
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 9999;
            `;
            overlay.onclick = () => {
                overlay.remove();
                errorDiv.remove();
            };
            document.body.appendChild(overlay);
        }

        function confirmOrder() {
            // ê°™ì€ ë‚  ì¤‘ë³µ ì£¼ë¬¸ ì²´í¬ (ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸)
            if (currentCompany && currentCompany.phone) {
                const existingOrder = userOrders.find(order => 
                    order.date === selectedDate && 
                    order.customer.phone === currentCompany.phone &&
                    order.status === 'pending'
                );
                
                if (existingOrder) {
                    showValidationError(`${selectedDate} ë‚ ì§œì— ì´ë¯¸ ì£¼ë¬¸ì´ ìˆìŠµë‹ˆë‹¤.\n\nê¸°ì¡´ ì£¼ë¬¸ì„ ìˆ˜ì •í•˜ì‹œë ¤ë©´:\nâ˜° ë©”ë‰´ â†’ ì£¼ë¬¸ë‚´ì—­ â†’ ìˆ˜ì • ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.`);
                    hideOrderModal();
                    return;
                }
            }
            
            const orderData = {
                id: Date.now(),
                date: selectedDate,
                time: new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' }),
                customer: {
                    company: document.getElementById('customerCompany').value,
                    phone: document.getElementById('customerPhone').value, // ëŒ€í‘œë²ˆí˜¸
                    contactPhone: document.getElementById('customerContactPhone').value, // ë‹´ë‹¹ì ì—°ë½ì²˜
                    address: document.getElementById('customerAddress').value,
                    memo: document.getElementById('customerMemo').value
                },
                items: Object.keys(quantities).filter(menu => quantities[menu] > 0).map(menu => ({
                    type: menu,
                    name: menuNames[menu],
                    quantity: quantities[menu],
                    price: prices[menu]
                })),
                total: Object.keys(quantities).reduce((sum, menu) => sum + quantities[menu] * prices[menu], 0),
                status: 'pending'
            };
            
            orders.push(orderData);
            userOrders.push(orderData);
            
            localStorage.setItem('jindamOrders', JSON.stringify(orders));
            localStorage.setItem('jindamUserOrders', JSON.stringify(userOrders));
            
            // Google Sheetsì—ë„ ì €ì¥
            saveOrderToSheet(orderData);
            
            hideOrderModal();
            
            // ë‹¬ë ¥ ìƒˆë¡œê³ ì¹¨ (ì£¼ë¬¸ í‘œì‹œ ì—…ë°ì´íŠ¸)
            generateCalendar();
            
            document.getElementById('successModal').classList.add('show');
        }

        function resetOrder() {
            quantities = { warm: 0, salad: 0, ilpoom: 0, heating: 0 };
            selectedDate = null;
            
            Object.keys(quantities).forEach(menu => {
                document.getElementById(menu + '-qty').textContent = '0';
            });
            
            document.getElementById('selectedDateText').textContent = 'ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
            document.getElementById('totalAmount').textContent = '0ì›';
            
            // ì €ì¥ëœ ë‹´ë‹¹ì ì—°ë½ì²˜ê°€ ìˆìœ¼ë©´ ìœ ì§€, ì—†ìœ¼ë©´ ì´ˆê¸°í™”
            const savedContact = localStorage.getItem(`contactPhone_${currentCompany.phone}`);
            if (!savedContact) {
                document.getElementById('customerContactPhone').value = '';
            }
            // customerCompany, customerPhone, customerAddressëŠ” ìœ ì§€
            
            document.getElementById('customerMemo').value = '';
            
            document.querySelectorAll('.calendar-day').forEach(day => day.classList.remove('selected'));
            
            updateOrderButton();
        }
        
        function displayPaymentInfo() {
            const currentInfo = document.getElementById('currentPaymentInfo');
            
            if (!currentCompany) {
                currentInfo.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">ë¡œê·¸ì¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            const company = registeredCompanies.find(c => c.phone === currentCompany.phone);
            if (!company) {
                currentInfo.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">ì—…ì²´ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            // ê²°ì œ ë°©ë²• í‘œì‹œ ì´ë¦„
            const paymentMethodNames = {
                'bank': 'ğŸ’° ì…ê¸ˆ (ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰)',
                'cash_receipt': 'ğŸ§¾ í˜„ê¸ˆì˜ìˆ˜ì¦',
                'visit_card': 'ğŸ’³ ë°©ë¬¸ ì¹´ë“œ ê²°ì œ',
                'online_card': 'ğŸŒ ì˜¨ë¼ì¸ ì¹´ë“œ ê²°ì œ'
            };
            
            // í˜„ì¬ ê²°ì œ ì •ë³´ í‘œì‹œ
            let infoHTML = `
                <div style="background: linear-gradient(135deg, #fff 0%, #fafafa 100%); padding: 24px; border-radius: 16px; border: 2px solid #f0f0f0;">
                    <div style="font-size: 16px; font-weight: 700; color: #333; margin-bottom: 16px;">
                        ${paymentMethodNames[company.paymentMethod] || "ë¯¸ì„¤ì •"}
                    </div>
            `;
            
            if (company.paymentMethod === 'bank' && company.businessNumber) {
                infoHTML += `
                    <div style="font-size: 14px; color: #666; margin-bottom: 8px;">
                        <strong>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:</strong> ${company.businessNumber}
                    </div>
                `;
            } else if (company.paymentMethod === "cash_receipt") {
                if (company.cashReceiptType && company.cashReceiptNumber) {
                    const typeText = company.cashReceiptType === "personal" ? "ê°œì¸ (íœ´ëŒ€í°ë²ˆí˜¸)" : "ì‚¬ì—…ì (ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸)";
                    infoHTML += `
                        <div style="font-size: 14px; color: #666; margin-bottom: 8px;">
                            <strong>ë°œí–‰ ìœ í˜•:</strong> ${typeText}
                        </div>
                        <div style="font-size: 14px; color: #666; margin-bottom: 8px;">
                            <strong>ë²ˆí˜¸:</strong> ${company.cashReceiptNumber}
                        </div>
                    `;
                }
            } else if (company.paymentMethod === 'visit_card' && company.visitRequestTime) {
                infoHTML += `
                    <div style="font-size: 14px; color: #666; margin-bottom: 8px;">
                        <strong>ë°©ë¬¸ ìš”ì²­ ì‹œê°„:</strong> ${company.visitRequestTime}
                    </div>
                `;
            } else if (company.paymentMethod === 'online_card' && company.linkSendNumber) {
                infoHTML += `
                    <div style="font-size: 14px; color: #666; margin-bottom: 8px;">
                        <strong>ë§í¬ ë°œì†¡ ë²ˆí˜¸:</strong> ${company.linkSendNumber}
                    </div>
                `;
            }
            
            infoHTML += `</div>`;
            currentInfo.innerHTML = infoHTML;
        }
        


        function displayUserOrderHistory() {
            const orderHistoryList = document.getElementById('orderHistoryList');
            
            // í˜„ì¬ ë¡œê·¸ì¸í•œ ì—…ì²´ì˜ ì£¼ë¬¸ë§Œ í•„í„°ë§
            const myOrders = orders.filter(order => {
                const orderPhone = order.customer?.phone || order.phone || '';
                return orderPhone === currentCompany?.phone;
            });
            
            if (myOrders.length === 0) {
                orderHistoryList.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">ì£¼ë¬¸ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            // ìµœì‹ ìˆœ ì •ë ¬ (ë‚ ì§œ + ì‹œê°„ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ)
            const sortedOrders = [...myOrders].sort((a, b) => {
                // ë¨¼ì € ë‚ ì§œ ë¹„êµ
                if (a.date !== b.date) {
                    return b.date.localeCompare(a.date);
                }
                // ë‚ ì§œê°€ ê°™ìœ¼ë©´ ì‹œê°„ ë¹„êµ
                return b.time.localeCompare(a.time);
            });
            
            orderHistoryList.innerHTML = sortedOrders.map(order => {
                // ì£¼ë¬¸ì— í¬í•¨ëœ ë©”ë‰´ë³„ë¡œ ìˆ˜ì • ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
                const hasSaladOrIlpoom = order.items.some(item => 
                    item.type === 'salad' || item.type === 'ilpoom'
                );
                
                let canEdit = false;
                let deadlineMessage = '';
                
                if (hasSaladOrIlpoom) {
                    // ìƒëŸ¬ë“œ/ì¼í’ˆ í¬í•¨: ì „ë‚  6ì‹œê¹Œì§€ë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
                    canEdit = canOrderMenuForDate(order.date, 'salad');
                    deadlineMessage = 'ìˆ˜ì • ë§ˆê°: ë°°ì†¡ ì „ë‚  ì˜¤í›„ 6ì‹œ';
                } else {
                    // ë³´ì˜¨/ë°œì—´ë§Œ: ë‹¹ì¼ 6ì‹œê¹Œì§€ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
                    canEdit = canOrderForDate(order.date);
                    deadlineMessage = 'ìˆ˜ì • ë§ˆê°: ë°°ì†¡ ë‹¹ì¼ ì˜¤ì „ 6ì‹œ';
                }
                
                // ë©”ë‰´ ì´ë¦„ ê°„ë‹¨í•˜ê²Œ (ë„ì‹œë½ ì œì™¸)
                const menuText = order.items.map(item => {
                    const shortName = item.name.replace('ë„ì‹œë½', '').trim();
                    return `${shortName} ${item.quantity}ê°œ`;
                }).join(', ');
                
                // ì´ ê°œìˆ˜ ê³„ì‚°
                const totalQty = order.items.reduce((sum, item) => sum + item.quantity, 0);
                
                return `
                <div style="background: #fff; border-radius: 12px; padding: 16px; margin-bottom: 12px; border: 1px solid #f0f0f0; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div style="font-weight: 600; color: #333; font-size: 14px;">${order.date} ${order.time}</div>
                        <div style="display: flex; gap: 6px; align-items: center;">
                            ${canEdit ? 
                                `<button onclick="showEditModal(${order.id})" style="background: #fff; color: #ff6b35; border: 1px solid #ff6b35; padding: 5px 10px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600;">âœï¸</button>
                                 <button onclick="deleteOrder(${order.id})" style="background: #fff; color: #ef4444; border: 1px solid #ef4444; padding: 5px 10px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600;">ğŸ—‘ï¸</button>` : 
                                `<span style="padding: 5px 10px; border-radius: 6px; font-size: 11px; color: #999; background: #f5f5f5;">ìˆ˜ì •ë§ˆê°</span>`
                            }
                        </div>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <div style="font-size: 13px; color: #333; line-height: 1.5;">
                            ğŸ“‹ ${menuText} <span style="color: #ff6b35; font-weight: 600;">(ì´ ${totalQty}ê°œ)</span>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 13px; color: #666;">
                            ğŸ“ ${order.customer.address}
                        </div>
                        <div style="font-weight: 600; color: #ff6b35; font-size: 15px;">
                            ${order.total.toLocaleString()}ì›
                        </div>
                    </div>
                    ${!canEdit ? 
                        `<div style="margin-top: 10px; padding: 8px; background: #ffe6e6; border-radius: 6px; font-size: 11px; color: #d63384;">
                            <div style="font-weight: 600; margin-bottom: 2px;">â° ${deadlineMessage}</div>
                            <div style="font-size: 10px;">ì·¨ì†Œ ë¬¸ì˜: â˜ 1544-4679 (ë‹¹ì¼ ì˜¤ì „ 8ì‹œê¹Œì§€)</div>
                        </div>` : 
                        (canEdit ? 
                            `<div style="margin-top: 8px; padding: 6px; background: #f0fdf4; border-radius: 6px; font-size: 10px; color: #22c55e; text-align: center;">
                                ğŸ’¡ ${deadlineMessage}
                            </div>` : "")
                    }
                </div>
            `;
            }).join('');
        }
        
        function deleteOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            // ë§ˆê° ì‹œê°„ ì²´í¬
            const hasSaladOrIlpoom = order.items.some(item => 
                item.type === 'salad' || item.type === 'ilpoom'
            );
            
            let canDelete = false;
            let deadlineMessage = '';
            
            if (hasSaladOrIlpoom) {
                // ìƒëŸ¬ë“œ/ì¼í’ˆ í¬í•¨: ì „ë‚  6ì‹œê¹Œì§€ë§Œ ì‚­ì œ ê°€ëŠ¥
                canDelete = canOrderMenuForDate(order.date, 'salad');
                deadlineMessage = 'ë°°ì†¡ ì „ë‚  ì˜¤í›„ 6ì‹œ';
            } else {
                // ë³´ì˜¨/ë°œì—´ë§Œ: ë‹¹ì¼ 6ì‹œê¹Œì§€ ì‚­ì œ ê°€ëŠ¥
                canDelete = canOrderForDate(order.date);
                deadlineMessage = 'ë°°ì†¡ ë‹¹ì¼ ì˜¤ì „ 6ì‹œ';
            }
            
            // ë§ˆê° ì‹œê°„ ì§€ë‚¬ìœ¼ë©´ ì‚­ì œ ë¶ˆê°€
            if (!canDelete) {
                alert(`â° ì‚­ì œ ë§ˆê° ì‹œê°„ì´ ì§€ë‚¬ìŠµë‹ˆë‹¤.\n\në§ˆê° ì‹œê°„: ${deadlineMessage}\n\nì·¨ì†Œ ë¬¸ì˜: â˜ 1544-4679 (ë‹¹ì¼ ì˜¤ì „ 8ì‹œê¹Œì§€)`);
                return;
            }
            
            // ì‚­ì œ í™•ì¸ ëª¨ë‹¬ ìƒì„±
            const modal = document.createElement('div');
            modal.className = 'delete-order-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = 'background: white; border-radius: 16px; padding: 24px; max-width: 400px; width: 100%;';
            
            modalContent.innerHTML = `
                <h3 style="font-size: 18px; font-weight: 700; color: #333; margin-bottom: 8px;">ğŸ—‘ï¸ ì£¼ë¬¸ ì‚­ì œ</h3>
                <p style="font-size: 14px; color: #666; margin-bottom: 16px; line-height: 1.6;">
                    <strong>${order.date}</strong> ì£¼ë¬¸ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?<br>
                    <span style="color: #999; font-size: 13px;">ì‚­ì œëœ ì£¼ë¬¸ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>
                </p>
                
                <div style="background: #f9f9f9; padding: 12px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 4px;">ì£¼ë¬¸ ë‚´ì—­:</div>
                    <div style="font-size: 14px; color: #333;">${order.items.map(item => `${item.name} ${item.quantity}ê°œ`).join(', ')}</div>
                </div>
                
                <div style="display: flex; gap: 12px;">
                    <button class="cancel-delete-btn" style="flex: 1; background: #f5f5f5; color: #666; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        ì·¨ì†Œ
                    </button>
                    <button class="confirm-delete-btn" style="flex: 1; background: #ef4444; color: #ffffff; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        ì‚­ì œ
                    </button>
                </div>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            modalContent.querySelector('.cancel-delete-btn').addEventListener('click', () => {
                modal.remove();
            });
            
            modalContent.querySelector('.confirm-delete-btn').addEventListener('click', () => {
                confirmDeleteOrder(orderId);
            });
            
            // ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
        
        function confirmDeleteOrder(orderId) {
            // userOrdersì—ì„œ ì‚­ì œ
            const userIndex = userOrders.findIndex(o => o.id === orderId);
            if (userIndex !== -1) {
                userOrders.splice(userIndex, 1);
                localStorage.setItem('jindamUserOrders', JSON.stringify(userOrders));
            }
            
            // ordersì—ì„œë„ ì‚­ì œ
            const orderIndex = orders.findIndex(o => o.id === orderId);
            if (orderIndex !== -1) {
                orders.splice(orderIndex, 1);
                localStorage.setItem('jindamOrders', JSON.stringify(orders));
            }
            
            // ëª¨ë‹¬ ë‹«ê¸°
            const modal = document.querySelector('.delete-order-modal');
            if (modal) {
                modal.remove();
            }
            
            // ì£¼ë¬¸ ë‚´ì—­ ìƒˆë¡œê³ ì¹¨
            displayUserOrderHistory();
            
            // ë‹¬ë ¥ë„ ìƒˆë¡œê³ ì¹¨ (ì£¼ë¬¸ í‘œì‹œ ì—…ë°ì´íŠ¸)
            generateCalendar();
            
            // ì„±ê³µ ë©”ì‹œì§€
            showValidationError('ì£¼ë¬¸ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function showEditModal(orderId) {
            const order = userOrders.find(o => o.id === orderId);
            
            // ë§ˆê° ì‹œê°„ ì²´í¬
            const hasSaladOrIlpoom = order.items.some(item => 
                item.type === 'salad' || item.type === 'ilpoom'
            );
            
            let canEdit = false;
            let deadlineMessage = '';
            
            if (hasSaladOrIlpoom) {
                // ìƒëŸ¬ë“œ/ì¼í’ˆ í¬í•¨: ì „ë‚  6ì‹œê¹Œì§€ë§Œ ìˆ˜ì • ê°€ëŠ¥
                canEdit = canOrderMenuForDate(order.date, 'salad');
                deadlineMessage = 'ë°°ì†¡ ì „ë‚  ì˜¤í›„ 6ì‹œ';
            } else {
                // ë³´ì˜¨/ë°œì—´ë§Œ: ë‹¹ì¼ 6ì‹œê¹Œì§€ ìˆ˜ì • ê°€ëŠ¥
                canEdit = canOrderForDate(order.date);
                deadlineMessage = 'ë°°ì†¡ ë‹¹ì¼ ì˜¤ì „ 6ì‹œ';
            }
            
            if (!canEdit) {
                alert(`â° ìˆ˜ì • ë§ˆê° ì‹œê°„ì´ ì§€ë‚¬ìŠµë‹ˆë‹¤.\n\në§ˆê° ì‹œê°„: ${deadlineMessage}\n\nì·¨ì†Œ ë¬¸ì˜: â˜ 1544-4679 (ë‹¹ì¼ ì˜¤ì „ 8ì‹œê¹Œì§€)`);
                return;
            }

            editingOrderId = orderId;
            
            editQuantities = {};
            Object.keys(menuNames).forEach(menu => {
                const item = order.items.find(i => i.type === menu);
                editQuantities[menu] = item ? item.quantity : 0;
            });
            
            const editMenuList = document.getElementById('editMenuList');
            editMenuList.innerHTML = Object.keys(menuNames).map(menu => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f0f0f0;">
                    <div>
                        <div style="font-weight: 500;">${menuNames[menu]}</div>
                        <div style="font-size: 14px; color: #ff6b35;">${prices[menu].toLocaleString()}ì›</div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <button class="qty-btn" onclick="changeEditQuantity('${menu}', -1)">-</button>
                        <span id="edit-${menu}-qty" style="min-width: 20px; text-align: center; font-weight: 600;">${editQuantities[menu]}</span>
                        <button class="qty-btn" onclick="changeEditQuantity('${menu}', 1)">+</button>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('editModal').classList.add('show');
        }

        function hideEditModal() {
            document.getElementById('editModal').classList.remove('show');
            editingOrderId = null;
            editQuantities = {};
        }

        function changeEditQuantity(menuType, change) {
            editQuantities[menuType] = Math.max(0, editQuantities[menuType] + change);
            const qtyElement = document.getElementById(`edit-${menuType}-qty`);
            if (qtyElement) {
                qtyElement.textContent = editQuantities[menuType];
            }
        }

        function saveEditedOrder() {
            const orderIndex = userOrders.findIndex(o => o.id === editingOrderId);
            const adminOrderIndex = orders.findIndex(o => o.id === editingOrderId);
            
            // ì´ ìˆ˜ëŸ‰ ê³„ì‚°
            const totalQuantity = Object.values(editQuantities).reduce((sum, qty) => sum + qty, 0);
            
            // ìµœì†Œ ì£¼ë¬¸ ìˆ˜ëŸ‰ ì²´í¬ (2ê°œ ì´ìƒ)
            if (totalQuantity < 2) {
                alert('ìµœì†Œ ì£¼ë¬¸ ìˆ˜ëŸ‰ì€ 2ê°œ ì´ìƒì…ë‹ˆë‹¤.\ní˜„ì¬ ì£¼ë¬¸ ìˆ˜ëŸ‰: ' + totalQuantity + 'ê°œ');
                return;
            }
            
            if (orderIndex !== -1) {
                userOrders[orderIndex].items = Object.keys(editQuantities).filter(menu => editQuantities[menu] > 0).map(menu => ({
                    type: menu,
                    name: menuNames[menu],
                    quantity: editQuantities[menu],
                    price: prices[menu]
                }));
                
                userOrders[orderIndex].total = Object.keys(editQuantities).reduce((sum, menu) => sum + editQuantities[menu] * prices[menu], 0);
                
                if (adminOrderIndex !== -1) {
                    orders[adminOrderIndex] = { ...userOrders[orderIndex] };
                }
                
                localStorage.setItem('jindamOrders', JSON.stringify(orders));
                localStorage.setItem('jindamUserOrders', JSON.stringify(userOrders));
            } else if (adminOrderIndex !== -1) {
                // ê´€ë¦¬ìê°€ ì§ì ‘ ìˆ˜ì •í•˜ëŠ” ê²½ìš°
                orders[adminOrderIndex].items = Object.keys(editQuantities).filter(menu => editQuantities[menu] > 0).map(menu => ({
                    type: menu,
                    name: menuNames[menu],
                    quantity: editQuantities[menu],
                    price: prices[menu]
                }));
                
                orders[adminOrderIndex].total = Object.keys(editQuantities).reduce((sum, menu) => sum + editQuantities[menu] * prices[menu], 0);
                
                // userOrdersì—ë„ ë°˜ì˜
                const userOrderIndex = userOrders.findIndex(o => o.id === editingOrderId);
                if (userOrderIndex !== -1) {
                    userOrders[userOrderIndex] = { ...orders[adminOrderIndex] };
                }
                
                localStorage.setItem('jindamOrders', JSON.stringify(orders));
                localStorage.setItem('jindamUserOrders', JSON.stringify(userOrders));
            }
            
            hideEditModal();
            
            // ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ìˆ˜ì •í–ˆìœ¼ë©´ ì£¼ë¬¸ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            if (document.getElementById('adminDashboard').style.display === 'block') {
                filterOrdersByDate();
            } else {
                displayUserOrderHistory();
            }
            
            alert('ì£¼ë¬¸ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === '2425') {
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                loadAdminData();
            } else {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                document.getElementById('adminPassword').value = '';
            }
        }

        function loadAdminData() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('adminDateFilter').value = today;
            filterOrdersByDate();
            showOrderManagement();
        }

        function filterOrdersByDate() {
            const selectedDate = document.getElementById('adminDateFilter').value;
            filteredOrders = orders.filter(order => order.date === selectedDate);
            
            updateStats();
            displayOrders();
        }

        function updateStats() {
            // ì´ ì£¼ë¬¸ì—…ì²´ ìˆ˜ (ì¤‘ë³µ ì œê±°)
            const uniqueCompanies = new Set(filteredOrders.map(order => order.customer.phone));
            const totalCompaniesElement = document.getElementById('totalCompanies');
            if (totalCompaniesElement) {
                totalCompaniesElement.textContent = uniqueCompanies.size;
            }
            
            // ë©”ë‰´ë³„ ìˆ˜ëŸ‰ ì§‘ê³„
            const menuCounts = {
                warm: 0,
                salad: 0,
                ilpoom: 0,
                heating: 0
            };
            
            let totalMenuCount = 0;
            
            filteredOrders.forEach(order => {
                order.items.forEach(item => {
                    if (menuCounts.hasOwnProperty(item.type)) {
                        menuCounts[item.type] += item.quantity;
                    }
                    totalMenuCount += item.quantity;
                });
            });
            
            // ì „ì²´ ë©”ë‰´ ìˆ˜
            const totalMenusElement = document.getElementById('totalMenus');
            if (totalMenusElement) {
                totalMenusElement.textContent = totalMenuCount;
            }
            
            // ë©”ë‰´ë³„ ê°œë³„ í‘œì‹œ
            const warmElement = document.getElementById('warmCount');
            if (warmElement) warmElement.textContent = menuCounts.warm;
            
            const saladElement = document.getElementById('saladCount');
            if (saladElement) saladElement.textContent = menuCounts.salad;
            
            const ilpoomElement = document.getElementById('ilpoomCount');
            if (ilpoomElement) ilpoomElement.textContent = menuCounts.ilpoom;
            
            const heatingElement = document.getElementById('heatingCount');
            if (heatingElement) heatingElement.textContent = menuCounts.heating;
        }

        function displayOrders() {
            const orderList = document.getElementById('orderList');
            
            if (filteredOrders.length === 0) {
                orderList.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">í•´ë‹¹ ë‚ ì§œì— ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            orderList.innerHTML = filteredOrders.map(order => {
                // ë©”ë‰´ ì´ë¦„ ê°„ë‹¨í•˜ê²Œ (ë„ì‹œë½ ì œì™¸) + ì´ ê°œìˆ˜ ê³„ì‚°
                const menuText = order.items.map(item => {
                    const shortName = item.name.replace('ë„ì‹œë½', '').trim();
                    return `${shortName} ${item.quantity}ê°œ`;
                }).join(', ');
                const totalQty = order.items.reduce((sum, item) => sum + item.quantity, 0);
                
                return `<div style="padding: 16px; border-bottom: 1px solid #f5f5f5;">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #333; font-size: 15px;">${order.customer.company}</div>
                            <div style="font-size: 12px; color: #999; margin-top: 2px;">ğŸ“… ${order.date} ${order.time}</div>
                        </div>
                        <button onclick="showAdminEditModal(${order.id})" style="background: #ff6b35; color: #ffffff; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; white-space: nowrap;">âœï¸ ìˆ˜ì •</button>
                    </div>
                    
                    <div style="background: #f9f9f9; padding: 10px 12px; border-radius: 8px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="font-size: 13px; color: #333; line-height: 1.5; flex: 1;">
                                ğŸ± ${menuText}
                            </div>
                            <div style="background: #ff6b35; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 700; white-space: nowrap; margin-left: 8px;">
                                ì´ ${totalQty}ê°œ
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; font-size: 13px;">
                        <div style="color: #666; line-height: 1.6; flex: 1;">
                            <div>ğŸ“ ${order.customer.phone}</div>
                            ${order.customer.contactPhone ? `<div>ğŸ“± ${order.customer.contactPhone}</div>` : ""}
                            <div>ğŸ“ ${order.customer.address}</div>
                            ${order.customer.memo ? `<div>ğŸ“ ${order.customer.memo}</div>` : ""}
                        </div>
                        <div style="font-weight: 700; color: #ff6b35; font-size: 16px; white-space: nowrap; text-align: right; margin-left: 12px;">
                            ${order.total.toLocaleString()}ì›
                            <div style="font-size: 10px; color: #999; font-weight: 400; margin-top: 2px;">(ë¶€ê°€ì„¸ ë³„ë„)</div>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }


        function searchOrders() {
            const searchInput = document.getElementById('companySearchInput').value.toLowerCase();
            const selectedDate = document.getElementById('adminDateFilter').value;
            
            if (!selectedDate) {
                return;
            }
            
            const allOrdersForDate = orders.filter(order => order.date === selectedDate);
            
            if (searchInput.trim() === '') {
                filteredOrders = allOrdersForDate;
            } else {
                filteredOrders = allOrdersForDate.filter(order => 
                    order.customer.company && order.customer.company.toLowerCase().includes(searchInput)
                );
            }
            
            updateStats();
            displayOrders();
        }

        function showAdminEditModal(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            editingOrderId = orderId;
            
            editQuantities = {};
            Object.keys(menuNames).forEach(menu => {
                const item = order.items.find(i => i.type === menu);
                editQuantities[menu] = item ? item.quantity : 0;
            });
            
            const editMenuList = document.getElementById('editMenuList');
            editMenuList.innerHTML = Object.keys(menuNames).map(menu => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f0f0f0;">
                    <div>
                        <div style="font-weight: 500;">${menuNames[menu]}</div>
                        <div style="font-size: 14px; color: #ff6b35;">${prices[menu].toLocaleString()}ì›</div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <button class="qty-btn" onclick="changeEditQuantity('${menu}', -1)">-</button>
                        <span id="edit-${menu}-qty" style="min-width: 20px; text-align: center; font-weight: 600;">${editQuantities[menu]}</span>
                        <button class="qty-btn" onclick="changeEditQuantity('${menu}', 1)">+</button>
                    </div>
                </div>
            `).join('');
            
            updateEditTotal();
            document.getElementById('editModal').classList.add('show');
        }

        function changeEditQuantity(menuType, change) {
            editQuantities[menuType] = Math.max(0, editQuantities[menuType] + change);
            const qtyElement = document.getElementById(`edit-${menuType}-qty`);
            if (qtyElement) {
                qtyElement.textContent = editQuantities[menuType];
            }
            updateEditTotal();
        }

        function updateEditTotal() {
            let total = 0;
            Object.keys(editQuantities).forEach(menu => {
                total += editQuantities[menu] * prices[menu];
            });
            const totalElement = document.getElementById('editTotal');
            if (totalElement) {
                totalElement.textContent = total.toLocaleString();
            }
        }

        function saveAdminEdit() {
            const order = orders.find(o => o.id === editingOrderId);
            if (!order) return;
            
            const newItems = Object.keys(editQuantities)
                .filter(menu => editQuantities[menu] > 0)
                .map(menu => ({
                    type: menu,
                    name: menuNames[menu],
                    price: prices[menu],
                    quantity: editQuantities[menu]
                }));
            
            if (newItems.length === 0) {
                alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì´ ìˆ˜ëŸ‰ ê³„ì‚°
            const totalQuantity = newItems.reduce((sum, item) => sum + item.quantity, 0);
            
            // ìµœì†Œ ì£¼ë¬¸ ìˆ˜ëŸ‰ ì²´í¬ (2ê°œ ì´ìƒ)
            if (totalQuantity < 2) {
                alert('ìµœì†Œ ì£¼ë¬¸ ìˆ˜ëŸ‰ì€ 2ê°œ ì´ìƒì…ë‹ˆë‹¤.\ní˜„ì¬ ì£¼ë¬¸ ìˆ˜ëŸ‰: ' + totalQuantity + 'ê°œ');
                return;
            }
            
            const newTotal = newItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // orders ë°°ì—´ ì—…ë°ì´íŠ¸
            const orderIndex = orders.findIndex(o => o.id === editingOrderId);
            if (orderIndex !== -1) {
                orders[orderIndex].items = newItems;
                orders[orderIndex].total = newTotal;
                localStorage.setItem('jindamOrders', JSON.stringify(orders));
            }
            
            // userOrders ë°°ì—´ë„ ì—…ë°ì´íŠ¸
            const userOrderIndex = userOrders.findIndex(o => o.id === editingOrderId);
            if (userOrderIndex !== -1) {
                userOrders[userOrderIndex].items = newItems;
                userOrders[userOrderIndex].total = newTotal;
                localStorage.setItem('jindamUserOrders', JSON.stringify(userOrders));
            }
            
            closeEditModal();
            filterOrdersByDate();
            alert('ì£¼ë¬¸ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        function closeEditModal() {
            document.getElementById('editModal').classList.remove('show');
            editingOrderId = null;
            editQuantities = {};
        }

        function downloadExcel() {
            const selectedDate = document.getElementById('adminDateFilter').value;
            
            if (!selectedDate) {
                alert('ë‚ ì§œë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (filteredOrders.length === 0) {
                alert(`${selectedDate} ë‚ ì§œì— ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.`);
                return;
            }
            
            let excelContent = `
                <table border="1">
                    <tr style="background-color: #ff6b35; color: #ffffff; font-weight: bold;">
                        <th>ì£¼ë¬¸ì¼</th>
                        <th>ì£¼ë¬¸ì‹œê°„</th>
                        <th>ì—…ì²´ëª…</th>
                        <th>ëŒ€í‘œë²ˆí˜¸</th>
                        <th>ë‹´ë‹¹ìì—°ë½ì²˜</th>
                        <th>ì£¼ì†Œ</th>
                        <th>ë³´ì˜¨ë„ì‹œë½</th>
                        <th>ìƒëŸ¬ë“œë„ì‹œë½</th>
                        <th>ì¼í’ˆë„ì‹œë½</th>
                        <th>ë°œì—´ë„ì‹œë½</th>
                        <th>ì´ê¸ˆì•¡</th>
                        <th>ë©”ëª¨</th>
                    </tr>
            `;
            
            filteredOrders.forEach(order => {
                const warmQty = order.items.find(item => item.type === 'warm')?.quantity || "";
                const saladQty = order.items.find(item => item.type === 'salad')?.quantity || "";
                const ilpoomQty = order.items.find(item => item.type === 'ilpoom')?.quantity || "";
                const heatingQty = order.items.find(item => item.type === 'heating')?.quantity || "";
                
                excelContent += `
                    <tr>
                        <td>${order.date}</td>
                        <td>${order.time}</td>
                        <td>${order.customer.company || ""}</td>
                        <td>${order.customer.phone}</td>
                        <td>${order.customer.contactPhone || ""}</td>
                        <td>${order.customer.address}</td>
                        <td style="text-align: center;">${warmQty}</td>
                        <td style="text-align: center;">${saladQty}</td>
                        <td style="text-align: center;">${ilpoomQty}</td>
                        <td style="text-align: center;">${heatingQty}</td>
                        <td style="text-align: right;">${order.total.toLocaleString()}</td>
                        <td>${order.customer.memo || ""}</td>
                    </tr>
                `;
            });
            
            excelContent += '</table>';
            
            const htmlContent = `<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <meta name="ProgId" content="Excel.Sheet">
                    <meta name="Generator" content="Microsoft Excel 15">
                    <style>
                        table { border-collapse: collapse; }
                        th, td { border: 1px solid #ccc; padding: 5px; }
                        th { background-color: #ff6b35; color: white; font-weight: bold; }
                    </style>
                    <meta property="og:title" content="ì§„ë‹´ë„ì‹œë½ - ì˜¨ë¼ì¸ ì£¼ë¬¸">
    <meta property="og:description" content="ê±´ê°•í•˜ê³  ë§›ìˆëŠ” í•œì‹ ë„ì‹œë½ì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì£¼ë¬¸í•˜ì„¸ìš”!">
    <meta property="og:type" content="website">
</head>
                <body>${excelContent}</body>
                </html>`;
            
            const blob = new Blob(['\ufeff' + htmlContent], { 
                type: 'application/vnd.ms-excel;charset=utf-8;' 
            });
            
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `ì§„ë‹´ë„ì‹œë½_ì£¼ë¬¸ëª©ë¡_${selectedDate}.xls`);
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function downloadMonthlyStatement() {
            if (!currentCompany) {
                alert('ë¡œê·¸ì¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ìŠ¹ì¸ ì²´í¬
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${String(currentMonth).padStart(2, "0")}`;
            
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            const isApproved = approvedStatements[currentCompany.phone]?.[statementKey]?.approved || false;
            
            if (!isApproved) {
                alert('ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (userOrders.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const monthlyOrders = userOrders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate.getMonth() + 1 === currentMonth && orderDate.getFullYear() === currentYear;
            });

            if (monthlyOrders.length === 0) {
                alert('ì´ë²ˆ ë‹¬ ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            let excelContent = `
                <table border="1">
                    <tr style="background-color: #ff6b35; color: #ffffff; font-weight: bold;">
                        <th>ì£¼ë¬¸ì¼</th>
                        <th>ì£¼ë¬¸ì‹œê°„</th>
                        <th>ë©”ë‰´</th>
                        <th>ìˆ˜ëŸ‰</th>
                        <th>ë‹¨ê°€</th>
                        <th>ê¸ˆì•¡</th>
                        <th>ì—…ì²´ëª…</th>
                        <th>ì—°ë½ì²˜</th>
                        <th>ì£¼ì†Œ</th>
                    </tr>
            `;
            
            monthlyOrders.forEach(order => {
                order.items.forEach(item => {
                    excelContent += `
                        <tr>
                            <td>${order.date}</td>
                            <td>${order.time}</td>
                            <td>${item.name}</td>
                            <td style="text-align: center;">${item.quantity}</td>
                            <td style="text-align: right;">${item.price.toLocaleString()}</td>
                            <td style="text-align: right;">${(item.quantity * item.price).toLocaleString()}</td>
                            <td>${order.customer.company || ""}</td>
                            <td>${order.customer.phone}</td>
                            <td>${order.customer.address}</td>
                        </tr>
                    `;
                });
            });
            
            excelContent += '</table>';

            const htmlContent = `<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <meta name="ProgId" content="Excel.Sheet">
                    <meta name="Generator" content="Microsoft Excel 15">
                    <style>
                        table { border-collapse: collapse; }
                        th, td { border: 1px solid #ccc; padding: 5px; }
                        th { background-color: #ff6b35; color: white; font-weight: bold; }
                    </style>
                    <meta property="og:title" content="ì§„ë‹´ë„ì‹œë½ - ì˜¨ë¼ì¸ ì£¼ë¬¸">
    <meta property="og:description" content="ê±´ê°•í•˜ê³  ë§›ìˆëŠ” í•œì‹ ë„ì‹œë½ì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì£¼ë¬¸í•˜ì„¸ìš”!">
    <meta property="og:type" content="website">
</head>
                <body>${excelContent}</body>
                </html>`;

            const blob = new Blob(['\ufeff' + htmlContent], { 
                type: 'application/vnd.ms-excel;charset=utf-8;' 
            });

            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `ì§„ë‹´ë„ì‹œë½_ì›”ê±°ë˜ëª…ì„¸ì„œ_${currentYear}ë…„${currentMonth}ì›”.xls`);
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function downloadMonthlyReport() {
            if (orders.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            
            const monthlyOrders = orders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate.getMonth() + 1 === currentMonth && orderDate.getFullYear() === currentYear;
            });

            if (monthlyOrders.length === 0) {
                alert('ì´ë²ˆ ë‹¬ ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            let excelContent = `
                <table border="1">
                    <tr style="background-color: #ff6b35; color: #ffffff; font-weight: bold;">
                        <th>ì£¼ë¬¸ì¼</th>
                        <th>ì£¼ë¬¸ì‹œê°„</th>
                        <th>ì—…ì²´ëª…</th>
                        <th>ëŒ€í‘œë²ˆí˜¸</th>
                        <th>ë‹´ë‹¹ìì—°ë½ì²˜</th>
                        <th>ì£¼ì†Œ</th>
                        <th>ë³´ì˜¨ë„ì‹œë½</th>
                        <th>ìƒëŸ¬ë“œë„ì‹œë½</th>
                        <th>ì¼í’ˆë„ì‹œë½</th>
                        <th>ë°œì—´ë„ì‹œë½</th>
                        <th>ì´ê¸ˆì•¡</th>
                        <th>ë©”ëª¨</th>
                    </tr>
            `;
            
            monthlyOrders.forEach(order => {
                const warmQty = order.items.find(item => item.type === 'warm')?.quantity || "";
                const saladQty = order.items.find(item => item.type === 'salad')?.quantity || "";
                const ilpoomQty = order.items.find(item => item.type === 'ilpoom')?.quantity || "";
                const heatingQty = order.items.find(item => item.type === 'heating')?.quantity || "";
                
                excelContent += `
                    <tr>
                        <td>${order.date}</td>
                        <td>${order.time}</td>
                        <td>${order.customer.company || ""}</td>
                        <td>${order.customer.phone}</td>
                        <td>${order.customer.contactPhone || ""}</td>
                        <td>${order.customer.address}</td>
                        <td style="text-align: center;">${warmQty}</td>
                        <td style="text-align: center;">${saladQty}</td>
                        <td style="text-align: center;">${ilpoomQty}</td>
                        <td style="text-align: center;">${heatingQty}</td>
                        <td style="text-align: right;">${order.total.toLocaleString()}</td>
                        <td>${order.customer.memo || ""}</td>
                    </tr>
                `;
            });
            
            excelContent += '</table>';

            const htmlContent = `<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <meta name="ProgId" content="Excel.Sheet">
                    <meta name="Generator" content="Microsoft Excel 15">
                    <style>
                        table { border-collapse: collapse; }
                        th, td { border: 1px solid #ccc; padding: 5px; }
                        th { background-color: #ff6b35; color: white; font-weight: bold; }
                    </style>
                    <meta property="og:title" content="ì§„ë‹´ë„ì‹œë½ - ì˜¨ë¼ì¸ ì£¼ë¬¸">
    <meta property="og:description" content="ê±´ê°•í•˜ê³  ë§›ìˆëŠ” í•œì‹ ë„ì‹œë½ì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì£¼ë¬¸í•˜ì„¸ìš”!">
    <meta property="og:type" content="website">
</head>
                <body>${excelContent}</body>
                </html>`;

            const blob = new Blob(['\ufeff' + htmlContent], { 
                type: 'application/vnd.ms-excel;charset=utf-8;' 
            });
            
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `ì§„ë‹´ë„ì‹œë½_ì›”ë³„ì „ì²´ê±°ë˜ë‚´ì—­_${currentYear}ë…„${currentMonth}ì›”.xls`);
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function checkAdminAccess() {
            if (window.location.hash === '#admin') {
                showAdminPage();
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // ============================================
            // Google Sheets ë°ì´í„° ë™ê¸°í™” (PC-ëª¨ë°”ì¼)
            // ============================================
            async function syncFromGoogleSheets() {
                console.log('ğŸ”„ Google Sheetsì™€ ë™ê¸°í™” ì‹œì‘...');
                
                try {
                    // 1. ì—…ì²´ ë°ì´í„° ë¡œë“œ
                    const companiesResponse = await fetch(WEBAPP_URL + '?action=readCompanies', {
                        method: 'GET'
                    });
                    const companiesResult = await companiesResponse.json();
                    
                    if (companiesResult.success && companiesResult.data) {
                        const approvedCompanies = companiesResult.data.filter(c => c.status === 'ìŠ¹ì¸' || !c.status);
                        
                        // localStorage ì—…ë°ì´íŠ¸
                        localStorage.setItem('jindamCompanies', JSON.stringify(approvedCompanies));
                        registeredCompanies = approvedCompanies;
                        
                        console.log('âœ… ì—…ì²´ ë°ì´í„° ë™ê¸°í™”:', approvedCompanies.length, 'ê°œ');
                    }
                    
                    // 2. ì£¼ë¬¸ ë°ì´í„° ë¡œë“œ ë° ë³‘í•©
                    const ordersResponse = await fetch(WEBAPP_URL + '?action=readOrders', {
                        method: 'GET'
                    });
                    const ordersResult = await ordersResponse.json();
                    
                    if (ordersResult.success && ordersResult.data && ordersResult.data.length > 0) {
                        const existingOrders = JSON.parse(localStorage.getItem('jindamOrders') || '[]');
                        const existingOrderIds = new Set(existingOrders.map(o => o.id));
                        
                        // ì¤‘ë³µë˜ì§€ ì•Šì€ ì£¼ë¬¸ë§Œ ì¶”ê°€
                        const newOrders = ordersResult.data.filter(o => !existingOrderIds.has(o.id));
                        
                        if (newOrders.length > 0) {
                            const mergedOrders = [...existingOrders, ...newOrders];
                            localStorage.setItem('jindamOrders', JSON.stringify(mergedOrders));
                            localStorage.setItem('jindamUserOrders', JSON.stringify(mergedOrders));
                            orders = mergedOrders;
                            userOrders = mergedOrders;
                            
                            console.log('âœ… ì£¼ë¬¸ ë°ì´í„° ë™ê¸°í™”:', newOrders.length, 'ê°œ ìƒˆ ì£¼ë¬¸');
                        }
                    }
                    
                    console.log('ğŸ‰ ë™ê¸°í™” ì™„ë£Œ!');
                } catch (error) {
                    console.error('âš ï¸  ë™ê¸°í™” ì˜¤ë¥˜:', error);
                    console.log('ğŸ’¡ ë¡œì»¬ ë°ì´í„°ë¡œ ê³„ì† ì§„í–‰');
                }
            }
            
            // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ë™ê¸°í™” ì‹¤í–‰
            syncFromGoogleSheets();
            
            // ê²°ì œ ë°©ë²• ë¼ë””ì˜¤ ë²„íŠ¼ ì´ˆê¸°í™”
            const defaultRadio = document.querySelector('input[name="paymentMethod"]:checked');
            if (defaultRadio) {
                defaultRadio.closest('label').style.borderColor = '#ff6b35';
                defaultRadio.closest('label').style.backgroundColor = '#fff3f0';
            }
            
            // ê´€ë¦¬ì í•´ì‹œ ì²´í¬
            checkAdminAccess();
            
            // Enter í‚¤ë¡œ ê´€ë¦¬ì ë¡œê·¸ì¸
            const adminPasswordInput = document.getElementById('adminPassword');
            if (adminPasswordInput) {
                adminPasswordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        adminLogin();
                    }
                });
            }

            // ë‹¬ë ¥ ë° ì£¼ë¬¸ ë²„íŠ¼ ì´ˆê¸°í™”
            generateCalendar();
            updateOrderButton();
        });

        window.addEventListener('hashchange', checkAdminAccess);

        // ê²°ì œ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function showPaymentManagement() {
            document.getElementById('orderManagementSection').style.display = 'none';
            document.getElementById('companyManagementSection').style.display = 'none';
            document.getElementById('statementManagementSection').style.display = 'none';
            document.getElementById('paymentManagementSection').style.display = 'block';
            document.getElementById('paymentSearchInput').value = ''; // ê²€ìƒ‰ ì´ˆê¸°í™”
            displayPaymentMethods();
        }
        
        let allPaymentCompanies = []; // ì „ì²´ ì—…ì²´ ëª©ë¡ ì €ì¥
        
        function displayPaymentMethods(filteredCompanies = null) {
            const paymentList = document.getElementById('paymentMethodList');
            const companiesToShow = filteredCompanies || registeredCompanies;
            
            // ì „ì²´ ì—…ì²´ ëª©ë¡ ì €ì¥
            if (!filteredCompanies) {
                allPaymentCompanies = registeredCompanies;
            }
            
            if (companiesToShow.length === 0) {
                paymentList.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 48px; margin-bottom: 16px;">ğŸ”</div>
                        <div style="font-size: 16px;">${filteredCompanies ? "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤." : "ë“±ë¡ëœ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤."}</div>
                    </div>
                `;
                return;
            }
            
            const paymentMethodNames = {
                'bank': 'ğŸ’° ì…ê¸ˆ (ì„¸ê¸ˆê³„ì‚°ì„œ)',
                'cash_receipt': 'ğŸ§¾ í˜„ê¸ˆì˜ìˆ˜ì¦',
                'visit_card': 'ğŸ’³ ë°©ë¬¸ ì¹´ë“œ ê²°ì œ',
                'online_card': 'ğŸŒ ì˜¨ë¼ì¸ ì¹´ë“œ ê²°ì œ'
            };
            
            paymentList.innerHTML = companiesToShow.map(company => `
                <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 16px; border: 1px solid #e0e0e0;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                        <div style="flex: 1;">
                            <div style="font-size: 18px; font-weight: 700; color: #333; margin-bottom: 8px;">${company.company}</div>
                            <div style="font-size: 14px; color: #666; margin-bottom: 4px;">ğŸ“ ${company.phone}</div>
                            <div style="font-size: 14px; color: #666;">ğŸ“ ${company.address || '-'}</div>
                        </div>
                    </div>
                    
                    <div style="background: #f9f9f9; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
                        <div style="font-size: 13px; color: #999; margin-bottom: 8px;">í˜„ì¬ ê²°ì œ ë°©ë²•</div>
                        <div style="font-size: 16px; font-weight: 600; color: #ff6b35; margin-bottom: 8px;">
                            ${paymentMethodNames[company.paymentMethod] || "ğŸ’° ì…ê¸ˆ (ì„¸ê¸ˆê³„ì‚°ì„œ)"}
                        </div>
                        ${company.businessNumber ? `<div style="font-size: 13px; color: #666;">ì‚¬ì—…ìë²ˆí˜¸: ${company.businessNumber}</div>` : ""}
                        ${company.cashReceiptType && company.cashReceiptNumber ? `<div style="font-size: 13px; color: #666;">${company.cashReceiptType === "personal" ? "ê°œì¸" : "ì‚¬ì—…ì"}: ${company.cashReceiptNumber}</div>` : ""}
                        ${company.visitRequestTime ? `<div style="font-size: 13px; color: #666;">ë°©ë¬¸ì‹œê°„: ${company.visitRequestTime}</div>` : ""}
                        ${company.linkSendNumber ? `<div style="font-size: 13px; color: #666;">ë§í¬ë°œì†¡: ${company.linkSendNumber}</div>` : ""}
                    </div>
                    
                    <div style="background: #fff3f0; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
                        <div style="font-size: 13px; color: #999; margin-bottom: 8px;">ğŸ’µ ê³„ì•½ ë‹¨ê°€</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 13px; color: #666;">
                            <div>ğŸ± ë³´ì˜¨: ${(company.prices?.warm || defaultPrices.warm).toLocaleString()}ì›</div>
                            <div>ğŸ¥— ìƒëŸ¬ë“œ: ${(company.prices?.salad || defaultPrices.salad).toLocaleString()}ì›</div>
                            <div>ğŸ½ï¸ ì¼í’ˆ: ${(company.prices?.ilpoom || defaultPrices.ilpoom).toLocaleString()}ì›</div>
                            <div>ğŸ”¥ ë°œì—´: ${(company.prices?.heating || defaultPrices.heating).toLocaleString()}ì›</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 8px;">
                        <button onclick="editPaymentMethod('${company.phone}')" style="flex: 1; background: #3b82f6; color: #ffffff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            âœï¸ ê²°ì œ ë°©ë²• ìˆ˜ì •
                        </button>
                        <button onclick="editCompanyPrices('${company.phone}')" style="flex: 1; background: #22c55e; color: #ffffff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            ğŸ’µ ë‹¨ê°€ ì„¤ì •
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function searchPaymentMethods() {
            const searchTerm = document.getElementById('paymentSearchInput').value.toLowerCase().trim();
            
            if (!searchTerm) {
                displayPaymentMethods();
                return;
            }
            
            const filtered = allPaymentCompanies.filter(company => 
                company.company.toLowerCase().includes(searchTerm) ||
                company.phone.includes(searchTerm)
            );
            
            displayPaymentMethods(filtered);
        }
        
        function editPaymentMethod(companyPhone) {
            const company = registeredCompanies.find(c => c.phone === companyPhone);
            if (!company) return;
            
            const paymentMethodNames = {
                'bank': 'ğŸ’° ì…ê¸ˆ (ì„¸ê¸ˆê³„ì‚°ì„œ)',
                'cash_receipt': 'ğŸ§¾ í˜„ê¸ˆì˜ìˆ˜ì¦',
                'visit_card': 'ğŸ’³ ë°©ë¬¸ ì¹´ë“œ ê²°ì œ',
                'online_card': 'ğŸŒ ì˜¨ë¼ì¸ ì¹´ë“œ ê²°ì œ'
            };
            
            // ëª¨ë‹¬ ìƒì„±
            const modal = document.createElement('div');
            modal.className = 'payment-method-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = 'background: white; border-radius: 16px; padding: 24px; max-width: 500px; width: 100%; max-height: 90vh; overflow-y: auto;';
            
            modalContent.innerHTML = `
                <h3 style="font-size: 20px; font-weight: 700; color: #333; margin-bottom: 8px;">${company.company}</h3>
                <p style="font-size: 14px; color: #666; margin-bottom: 24px;">ê²°ì œ ë°©ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”</p>
                
                <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px;">
                    <label style="display: flex; align-items: center; padding: 16px; border: 2px solid ${company.paymentMethod === 'bank' || !company.paymentMethod ? "#ff6b35" : "#e0e0e0"}; border-radius: 8px; cursor: pointer; background: ${company.paymentMethod === 'bank' || !company.paymentMethod ? "#fff3f0" : "#ffffff"};">
                        <input type="radio" name="editPaymentMethod" value="bank" style="width: 18px; height: 18px; margin-right: 12px;" ${company.paymentMethod === 'bank' || !company.paymentMethod ? "checked" : ""}>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #333; margin-bottom: 4px;">ğŸ’° ì…ê¸ˆ (ì„¸ê¸ˆê³„ì‚°ì„œ)</div>
                            <div style="font-size: 12px; color: #999;">ì›”ë§ ì²­êµ¬ â†’ ìµì›” ì…ê¸ˆ</div>
                        </div>
                    </label>
                    
                    <label style="display: flex; align-items: center; padding: 16px; border: 2px solid ${company.paymentMethod === 'cash_receipt' ? "#ff6b35" : "#e0e0e0"}; border-radius: 8px; cursor: pointer; background: ${company.paymentMethod === 'cash_receipt' ? "#fff3f0" : "#ffffff"};">
                        <input type="radio" name="editPaymentMethod" value="cash_receipt" style="width: 18px; height: 18px; margin-right: 12px;" ${company.paymentMethod === 'cash_receipt' ? "checked" : ""}>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #333; margin-bottom: 4px;">ğŸ§¾ í˜„ê¸ˆì˜ìˆ˜ì¦</div>
                            <div style="font-size: 12px; color: #999;">ì›”ë§ ì²­êµ¬ â†’ ìµì›” ì…ê¸ˆ</div>
                        </div>
                    </label>
                    
                    <label style="display: flex; align-items: center; padding: 16px; border: 2px solid ${company.paymentMethod === 'visit_card' ? "#ff6b35" : "#e0e0e0"}; border-radius: 8px; cursor: pointer; background: ${company.paymentMethod === 'visit_card' ? "#fff3f0" : "#ffffff"};">
                        <input type="radio" name="editPaymentMethod" value="visit_card" style="width: 18px; height: 18px; margin-right: 12px;" ${company.paymentMethod === 'visit_card' ? "checked" : ""}>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #333; margin-bottom: 4px;">ğŸ’³ ë°©ë¬¸ ì¹´ë“œ ê²°ì œ</div>
                            <div style="font-size: 12px; color: #999;">ì›”ë§ ë°©ë¬¸í•˜ì—¬ ì¹´ë“œ ê²°ì œ</div>
                        </div>
                    </label>
                    
                    <label style="display: flex; align-items: center; padding: 16px; border: 2px solid ${company.paymentMethod === 'online_card' ? "#ff6b35" : "#e0e0e0"}; border-radius: 8px; cursor: pointer; background: ${company.paymentMethod === 'online_card' ? "#fff3f0" : "#ffffff"};">
                        <input type="radio" name="editPaymentMethod" value="online_card" style="width: 18px; height: 18px; margin-right: 12px;" ${company.paymentMethod === 'online_card' ? "checked" : ""}>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #333; margin-bottom: 4px;">ğŸŒ ì˜¨ë¼ì¸ ì¹´ë“œ ê²°ì œ</div>
                            <div style="font-size: 12px; color: #999;">ì›”ë§ ê²°ì œ ë§í¬ ë°œì†¡</div>
                        </div>
                    </label>
                </div>
                
                <!-- ì…ê¸ˆ ê²°ì œ í•„ë“œ -->
                <div id="editBusinessNumberField" style="margin-bottom: 16px; display: ${company.paymentMethod === 'bank' || !company.paymentMethod ? "block" : "none"};">
                    <label style="font-size: 13px; color: #666; margin-bottom: 8px; display: block;">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</label>
                    <input type="text" id="editBusinessNumber" value="${company.businessNumber || ""}" placeholder="123-45-67890" maxlength="12" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                </div>
                
                <!-- í˜„ê¸ˆì˜ìˆ˜ì¦ í•„ë“œ -->
                <div id="editCashReceiptField" style="margin-bottom: 16px; display: ${company.paymentMethod === 'cash_receipt' ? "block" : "none"};">
                    <label style="font-size: 13px; color: #666; margin-bottom: 8px; display: block;">í˜„ê¸ˆì˜ìˆ˜ì¦ ë°œí–‰ ì •ë³´</label>
                    <div style="display: flex; gap: 16px; margin-bottom: 12px;">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="radio" name="editCashReceiptType" value="personal" style="width: 16px; height: 16px; margin-right: 6px;" ${company.cashReceiptType === 'personal' || !company.cashReceiptType ? "checked" : ""}>
                            <span style="font-size: 14px; color: #666;">ê°œì¸ (íœ´ëŒ€í°)</span>
                        </label>
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="radio" name="editCashReceiptType" value="business" style="width: 16px; height: 16px; margin-right: 6px;" ${company.cashReceiptType === 'business' ? "checked" : ""}>
                            <span style="font-size: 14px; color: #666;">ì‚¬ì—…ì</span>
                        </label>
                    </div>
                    <input type="text" id="editCashReceiptNumber" value="${company.cashReceiptNumber || ""}" placeholder="íœ´ëŒ€í°ë²ˆí˜¸ ë˜ëŠ” ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸" maxlength="13" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                </div>
                
                <!-- ë°©ë¬¸ ì¹´ë“œ í•„ë“œ -->
                <div id="editVisitCardField" style="margin-bottom: 16px; display: ${company.paymentMethod === 'visit_card' ? "block" : "none"};">
                    <label style="font-size: 13px; color: #666; margin-bottom: 8px; display: block;">ë°©ë¬¸ ìš”ì²­ ì‹œê°„</label>
                    <input type="text" id="editVisitRequestTime" value="${company.visitRequestTime || ""}" placeholder="ì˜ˆ: ì˜¤ì „ 10ì‹œ ~ 11ì‹œ" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                </div>
                
                <!-- ì˜¨ë¼ì¸ ì¹´ë“œ í•„ë“œ -->
                <div id="editOnlineCardField" style="margin-bottom: 16px; display: ${company.paymentMethod === 'online_card' ? "block" : "none"};">
                    <label style="font-size: 13px; color: #666; margin-bottom: 8px; display: block;">ë§í¬ ë°œì†¡ ë²ˆí˜¸</label>
                    <input type="tel" id="editLinkSendNumber" value="${company.linkSendNumber || ""}" placeholder="010-1234-5678" maxlength="13" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                </div>
                
                <div style="display: flex; gap: 12px;">
                    <button class="cancel-payment-btn" style="flex: 1; background: #f5f5f5; color: #666; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        ì·¨ì†Œ
                    </button>
                    <button class="save-payment-btn" style="flex: 1; background: #ff6b35; color: #ffffff; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        ì €ì¥
                    </button>
                </div>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // ì·¨ì†Œ ë²„íŠ¼ ì´ë²¤íŠ¸
            modalContent.querySelector('.cancel-payment-btn').addEventListener('click', () => {
                modal.remove();
            });
            
            // ì €ì¥ ë²„íŠ¼ ì´ë²¤íŠ¸
            modalContent.querySelector('.save-payment-btn').addEventListener('click', () => {
                savePaymentMethodFromModal(companyPhone, modalContent);
            });
            
            // ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            // ë¼ë””ì˜¤ ë²„íŠ¼ ì´ë²¤íŠ¸
            modalContent.querySelectorAll('input[name="editPaymentMethod"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const businessField = modalContent.querySelector('#editBusinessNumberField');
                    const cashReceiptField = modalContent.querySelector('#editCashReceiptField');
                    const visitCardField = modalContent.querySelector('#editVisitCardField');
                    const onlineCardField = modalContent.querySelector('#editOnlineCardField');
                    
                    // ëª¨ë“  í•„ë“œ ìˆ¨ê¸°ê¸°
                    businessField.style.display = 'none';
                    cashReceiptField.style.display = 'none';
                    visitCardField.style.display = 'none';
                    onlineCardField.style.display = 'none';
                    
                    // ì„ íƒëœ ê²°ì œ ë°©ë²•ì— ë”°ë¼ í‘œì‹œ
                    if (this.value === 'bank') {
                        businessField.style.display = 'block';
                    } else if (this.value === 'cash_receipt') {
                        cashReceiptField.style.display = 'block';
                    } else if (this.value === 'visit_card') {
                        visitCardField.style.display = 'block';
                    } else if (this.value === 'online_card') {
                        onlineCardField.style.display = 'block';
                    }
                    
                    // ë¼ë””ì˜¤ ë²„íŠ¼ ì‹œê°ì  ê°•ì¡°
                    modalContent.querySelectorAll('input[name="editPaymentMethod"]').forEach(r => {
                        r.closest('label').style.borderColor = '#e0e0e0';
                        r.closest('label').style.backgroundColor = '#ffffff';
                    });
                    this.closest('label').style.borderColor = '#ff6b35';
                    this.closest('label').style.backgroundColor = '#fff3f0';
                });
            });
        }
        
        function savePaymentMethodFromModal(companyPhone, modalContent) {
            const company = registeredCompanies.find(c => c.phone === companyPhone);
            if (!company) return;
            
            const selectedMethod = modalContent.querySelector('input[name="editPaymentMethod"]:checked').value;
            
            // ê¸°ë³¸ ì •ë³´ ì €ì¥
            company.paymentMethod = selectedMethod;
            
            // ê° ê²°ì œ ë°©ë²•ë³„ ì¶”ê°€ ì •ë³´ ì €ì¥
            if (selectedMethod === 'bank') {
                company.businessNumber = modalContent.querySelector('#editBusinessNumber').value.trim();
                company.cashReceiptType = '';
                company.cashReceiptNumber = '';
                company.visitRequestTime = '';
                company.linkSendNumber = '';
            } else if (selectedMethod === 'cash_receipt') {
                company.businessNumber = '';
                company.cashReceiptType = modalContent.querySelector('input[name="editCashReceiptType"]:checked').value;
                company.cashReceiptNumber = modalContent.querySelector('#editCashReceiptNumber').value.trim();
                company.visitRequestTime = '';
                company.linkSendNumber = '';
            } else if (selectedMethod === 'visit_card') {
                company.businessNumber = '';
                company.cashReceiptType = '';
                company.cashReceiptNumber = '';
                company.visitRequestTime = modalContent.querySelector('#editVisitRequestTime').value.trim();
                company.linkSendNumber = '';
            } else if (selectedMethod === 'online_card') {
                company.businessNumber = '';
                company.cashReceiptType = '';
                company.cashReceiptNumber = '';
                company.visitRequestTime = '';
                company.linkSendNumber = modalContent.querySelector('#editLinkSendNumber').value.trim();
            }
            
            localStorage.setItem('jindamCompanies', JSON.stringify(registeredCompanies));
            
            // ëª¨ë‹¬ ë‹«ê¸°
            const modal = document.querySelector('.payment-method-modal');
            if (modal) {
                modal.remove();
            }
            
            // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            displayPaymentMethods();
            
            alert('ê²°ì œ ë°©ë²•ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function editCompanyPrices(companyPhone) {
            const company = registeredCompanies.find(c => c.phone === companyPhone);
            if (!company) return;
            
            // í˜„ì¬ ë‹¨ê°€ (ì—†ìœ¼ë©´ ê¸°ë³¸ ë‹¨ê°€)
            const currentPrices = company.prices || { ...defaultPrices };
            
            const modal = document.createElement('div');
            modal.className = 'price-edit-modal';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 10000;';
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = 'background: white; border-radius: 16px; padding: 32px; max-width: 500px; width: 90%;';
            
            modalContent.innerHTML = `
                <h3 style="font-size: 20px; font-weight: 700; color: #333; margin-bottom: 8px;">${company.company}</h3>
                <p style="font-size: 14px; color: #666; margin-bottom: 24px;">ğŸ’µ ë©”ë‰´ë³„ ë‹¨ê°€ ì„¤ì •</p>
                
                <div style="display: flex; flex-direction: column; gap: 16px; margin-bottom: 24px;">
                    <div>
                        <label style="display: block; font-size: 14px; font-weight: 600; color: #333; margin-bottom: 8px;">ğŸ± ë³´ì˜¨ë„ì‹œë½</label>
                        <input type="number" id="price-warm" value="${currentPrices.warm}" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                    </div>
                    
                    <div>
                        <label style="display: block; font-size: 14px; font-weight: 600; color: #333; margin-bottom: 8px;">ğŸ¥— ìƒëŸ¬ë“œë„ì‹œë½</label>
                        <input type="number" id="price-salad" value="${currentPrices.salad}" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                    </div>
                    
                    <div>
                        <label style="display: block; font-size: 14px; font-weight: 600; color: #333; margin-bottom: 8px;">ğŸ½ï¸ ì¼í’ˆë„ì‹œë½</label>
                        <input type="number" id="price-ilpoom" value="${currentPrices.ilpoom}" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                    </div>
                    
                    <div>
                        <label style="display: block; font-size: 14px; font-weight: 600; color: #333; margin-bottom: 8px;">ğŸ”¥ ë°œì—´ë„ì‹œë½</label>
                        <input type="number" id="price-heating" value="${currentPrices.heating}" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                    </div>
                </div>
                
                <div style="display: flex; gap: 12px;">
                    <button class="cancel-price-btn" style="flex: 1; background: #f5f5f5; color: #666; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        ì·¨ì†Œ
                    </button>
                    <button class="save-price-btn" style="flex: 1; background: #22c55e; color: #ffffff; border: none; padding: 14px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        ì €ì¥
                    </button>
                </div>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            modalContent.querySelector('.cancel-price-btn').addEventListener('click', () => {
                modal.remove();
            });
            
            modalContent.querySelector('.save-price-btn').addEventListener('click', () => {
                const newPrices = {
                    warm: parseInt(document.getElementById('price-warm').value) || defaultPrices.warm,
                    salad: parseInt(document.getElementById('price-salad').value) || defaultPrices.salad,
                    ilpoom: parseInt(document.getElementById('price-ilpoom').value) || defaultPrices.ilpoom,
                    heating: parseInt(document.getElementById('price-heating').value) || defaultPrices.heating
                };
                
                company.prices = newPrices;
                localStorage.setItem('jindamCompanies', JSON.stringify(registeredCompanies));
                
                modal.remove();
                displayPaymentMethods();
                
                showValidationError('ë‹¨ê°€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            });
        }
        
        // ============================================
        // ìŠ¹ì¸ ì™„ë£Œ ë‚´ì—­ ê´€ë ¨ í•¨ìˆ˜
        // ============================================
        
        let summaryFilter = 'all'; // all, paid, unpaid
        
        function showApprovedSummary() {
            document.getElementById('orderManagementSection').style.display = 'none';
            document.getElementById('companyManagementSection').style.display = 'none';
            document.getElementById('statementManagementSection').style.display = 'none';
            document.getElementById('paymentManagementSection').style.display = 'none';
            document.getElementById('approvedSummarySection').style.display = 'block';
            
            // í˜„ì¬ ì›” í‘œì‹œ
            const today = new Date();
            document.getElementById('summaryPeriodText').textContent = `${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›”`;
            
            displayApprovedSummary();
        }
        
        function filterSummary(filter) {
            summaryFilter = filter;
            
            document.getElementById('filterAllBtn').style.background = filter === 'all' ? 'linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%)' : '#f5f5f5';
            document.getElementById('filterAllBtn').style.color = filter === 'all' ? 'white' : '#666';
            document.getElementById('filterPaidBtn').style.background = filter === 'paid' ? 'linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%)' : '#f5f5f5';
            document.getElementById('filterPaidBtn').style.color = filter === 'paid' ? 'white' : '#666';
            document.getElementById('filterUnpaidBtn').style.background = filter === 'unpaid' ? 'linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%)' : '#f5f5f5';
            document.getElementById('filterUnpaidBtn').style.color = filter === 'unpaid' ? 'white' : '#666';
            
            displayApprovedSummary();
        }
        
        function searchApprovedSummary() {
            displayApprovedSummary();
        }
        
        function displayApprovedSummary() {
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            const paymentStatus = JSON.parse(localStorage.getItem('paymentStatus') || '{}');
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${String(currentMonth).padStart(2, "0")}`;
            
            // ì´ë²ˆ ë‹¬ ìŠ¹ì¸ëœ ì—…ì²´ë§Œ
            let approvedList = [];
            
            for (const phone in approvedStatements) {
                if (approvedStatements[phone][statementKey]?.approved) {
                    const company = registeredCompanies.find(c => c.phone === phone);
                    if (!company) continue;
                    
                    const amount = calculateCompanyAmount(phone, currentYear, currentMonth);
                    const isPaid = paymentStatus[phone]?.[statementKey]?.paid || false;
                    
                    approvedList.push({
                        company: company.company,
                        phone: phone,
                        statementKey: statementKey,
                        approvedDate: approvedStatements[phone][statementKey].date,
                        amount: amount,
                        isPaid: isPaid
                    });
                }
            }
            
            // ê²€ìƒ‰ í•„í„°ë§
            const searchTerm = document.getElementById('summarySearchInput')?.value.toLowerCase().trim() || "";
            if (searchTerm) {
                approvedList = approvedList.filter(item => 
                    item.company.toLowerCase().includes(searchTerm) || 
                    item.phone.includes(searchTerm)
                );
            }
            
            // ìƒíƒœ í•„í„°ë§
            if (summaryFilter === 'paid') {
                approvedList = approvedList.filter(item => item.isPaid);
            } else if (summaryFilter === 'unpaid') {
                approvedList = approvedList.filter(item => !item.isPaid);
            }
            
            // í•©ê³„ ê³„ì‚°
            const totalAmount = approvedList.reduce((sum, item) => sum + item.amount, 0);
            const paidAmount = approvedList.filter(item => item.isPaid).reduce((sum, item) => sum + item.amount, 0);
            const unpaidAmount = totalAmount - paidAmount;
            
            // í•©ê³„ í‘œì‹œ
            document.getElementById('summaryTotals').innerHTML = `
                <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 20px; border-radius: 12px; border: 2px solid #3b82f6;">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                        <div style="text-align: center;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">ì´ ìŠ¹ì¸ ê¸ˆì•¡</div>
                            <div style="font-size: 20px; font-weight: 700; color: #3b82f6;">${totalAmount.toLocaleString()}ì›</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">ì…ê¸ˆ ì™„ë£Œ</div>
                            <div style="font-size: 20px; font-weight: 700; color: #22c55e;">${paidAmount.toLocaleString()}ì›</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">ë¯¸ìˆ˜ê¸ˆ</div>
                            <div style="font-size: 20px; font-weight: 700; color: #dc2626;">${unpaidAmount.toLocaleString()}ì›</div>
                        </div>
                    </div>
                </div>
            `;
            
            // ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
            if (approvedList.length === 0) {
                document.getElementById('approvedSummaryList').innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“‹</div>
                        <div style="font-size: 16px;">${searchTerm ? "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤." : "ìŠ¹ì¸ëœ ê±°ë˜ëª…ì„¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤."}</div>
                    </div>
                `;
                return;
            }
            
            const listHtml = approvedList.map(item => `
                <div style="background: white; padding: 16px; border-radius: 12px; margin-bottom: 12px; border: 2px solid ${item.isPaid ? '#22c55e' : '#e0e0e0'};">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="flex: 1;">
                            <div style="font-size: 16px; font-weight: 600; color: #333; margin-bottom: 4px;">${item.company}</div>
                            <div style="font-size: 13px; color: #999;">${item.phone}</div>
                            <div style="font-size: 12px; color: #666; margin-top: 4px;">ìŠ¹ì¸ì¼: ${item.approvedDate}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 18px; font-weight: 700; color: #ff6b35; margin-bottom: 8px;">
                                ${item.amount.toLocaleString()}ì›
                            </div>
                            <button onclick="togglePaymentStatus('${item.phone}', '${item.statementKey}')" style="padding: 6px 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; ${item.isPaid ? 'background: #d1fae5; color: #065f46;' : 'background: #fef3c7; color: #92400e;'}">
                                ${item.isPaid ? 'âœ… ì…ê¸ˆ ì™„ë£Œ' : 'â³ ë¯¸ì…ê¸ˆ'}
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('approvedSummaryList').innerHTML = listHtml;
        }
        
        function calculateCompanyAmount(phone, year, month) {
            const companyOrders = orders.filter(order => {
                if (order.customer.phone !== phone) return false;
                const orderDate = new Date(order.date);
                return orderDate.getFullYear() === year && orderDate.getMonth() + 1 === month;
            });
            
            return companyOrders.reduce((sum, order) => sum + order.total, 0);
        }
        
        function togglePaymentStatus(phone, statementKey) {
            const paymentStatus = JSON.parse(localStorage.getItem('paymentStatus') || '{}');
            
            if (!paymentStatus[phone]) {
                paymentStatus[phone] = {};
            }
            
            if (!paymentStatus[phone][statementKey]) {
                paymentStatus[phone][statementKey] = { paid: false };
            }
            
            paymentStatus[phone][statementKey].paid = !paymentStatus[phone][statementKey].paid;
            paymentStatus[phone][statementKey].date = new Date().toLocaleDateString("ko-KR");
            
            localStorage.setItem('paymentStatus', JSON.stringify(paymentStatus));
            
            displayApprovedSummary();
        }
        
        function downloadSummaryExcel() {
            const approvedStatements = JSON.parse(localStorage.getItem('approvedStatements') || '{}');
            const paymentStatus = JSON.parse(localStorage.getItem('paymentStatus') || '{}');
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            const statementKey = `${currentYear}-${String(currentMonth).padStart(2, "0")}`;
            
            let approvedList = [];
            
            for (const phone in approvedStatements) {
                if (approvedStatements[phone][statementKey]?.approved) {
                    const company = registeredCompanies.find(c => c.phone === phone);
                    if (!company) continue;
                    
                    const amount = calculateCompanyAmount(phone, currentYear, currentMonth);
                    const isPaid = paymentStatus[phone]?.[statementKey]?.paid || false;
                    
                    approvedList.push({
                        company: company.company,
                        phone: phone,
                        approvedDate: approvedStatements[phone][statementKey].date,
                        amount: amount,
                        isPaid: isPaid ? 'ì…ê¸ˆì™„ë£Œ' : 'ë¯¸ì…ê¸ˆ'
                    });
                }
            }
            
            // ê²€ìƒ‰ ë° í•„í„° ì ìš©
            const searchTerm = document.getElementById('summarySearchInput')?.value.toLowerCase().trim() || "";
            if (searchTerm) {
                approvedList = approvedList.filter(item => 
                    item.company.toLowerCase().includes(searchTerm) || 
                    item.phone.includes(searchTerm)
                );
            }
            
            if (summaryFilter === 'paid') {
                approvedList = approvedList.filter(item => item.isPaid === 'ì…ê¸ˆì™„ë£Œ');
            } else if (summaryFilter === 'unpaid') {
                approvedList = approvedList.filter(item => item.isPaid === 'ë¯¸ì…ê¸ˆ');
            }
            
            const totalAmount = approvedList.reduce((sum, item) => sum + item.amount, 0);
            const paidAmount = approvedList.filter(item => item.isPaid === 'ì…ê¸ˆì™„ë£Œ').reduce((sum, item) => sum + item.amount, 0);
            const unpaidAmount = totalAmount - paidAmount;
            
            let excelContent = `
                <table border="1">
                    <tr style="background-color: #22c55e; color: #ffffff; font-weight: bold;">
                        <th>ì—…ì²´ëª…</th>
                        <th>ì „í™”ë²ˆí˜¸</th>
                        <th>ìŠ¹ì¸ì¼</th>
                        <th>ê¸ˆì•¡</th>
                        <th>ìƒíƒœ</th>
                    </tr>
                    ${approvedList.map(item => `
                        <tr>
                            <td>${item.company}</td>
                            <td>${item.phone}</td>
                            <td>${item.approvedDate}</td>
                            <td style="text-align: right;">${item.amount.toLocaleString()}</td>
                            <td style="text-align: center;">${item.isPaid}</td>
                        </tr>
                    `).join('')}
                    <tr style="background-color: #f0f9ff; font-weight: bold;">
                        <td colspan="3" style="text-align: center;">í•©ê³„</td>
                        <td style="text-align: right;">${totalAmount.toLocaleString()}</td>
                        <td></td>
                    </tr>
                    <tr style="background-color: #f0fdf4;">
                        <td colspan="3" style="text-align: center;">ì…ê¸ˆ ì™„ë£Œ</td>
                        <td style="text-align: right; color: #22c55e;">${paidAmount.toLocaleString()}</td>
                        <td></td>
                    </tr>
                    <tr style="background-color: #fef2f2;">
                        <td colspan="3" style="text-align: center;">ë¯¸ìˆ˜ê¸ˆ</td>
                        <td style="text-align: right; color: #dc2626;">${unpaidAmount.toLocaleString()}</td>
                        <td></td>
                    </tr>
                </table>
            `;
            
            const blob = new Blob([excelContent], { type: 'application/vnd.ms-excel' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.setAttribute('download', `ìŠ¹ì¸ì™„ë£Œë‚´ì—­_${currentYear}ë…„${currentMonth}ì›”.xls`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        window.addEventListener('beforeunload', function() {
            localStorage.setItem('jindamOrders', JSON.stringify(orders));
            localStorage.setItem('jindamUserOrders', JSON.stringify(userOrders));
        });
    </script>
</body>
</html>
